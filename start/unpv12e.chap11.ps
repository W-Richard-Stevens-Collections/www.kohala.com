%!PS-Adobe-3.0
%%Creator: groff version 1.08
%%DocumentNeededResources: font AvantGarde-BookOblique
%%+ font AvantGarde-DemiOblique
%%+ font Helvetica-Bold
%%+ font Palatino-Roman
%%+ font Courier
%%+ font Courier-Bold
%%+ font Palatino-Bold
%%+ font Palatino-Italic
%%+ font Courier-Oblique
%%+ font Symbol
%%DocumentSuppliedResources: procset grops 1.08 0
%%Pages: 57
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.08 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll 
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
0.1 setlinewidth
 10.8  78   moveto   14.4  0   rlineto   stroke % lower left cut mark
 39.6  42   moveto    0   21.6 rlineto   stroke
588    78   moveto   14.4  0   rlineto   stroke % lower right cut mark
573.6  42   moveto    0   21.6 rlineto   stroke
 10.8 744   moveto   14.4  0   rlineto   stroke % upper left cut mark
 39.6 758.4 moveto    0   21.6 rlineto   stroke
588   744   moveto   14.4  0   rlineto   stroke % upper right cut mark
573.6 758.4 moveto    0   21.6 rlineto   stroke
%
% uncomment following lines to print rules at page# baseline
% 39.6 708 moveto   50.4 0 rlineto   stroke	% to left of upper left page#
%523.2 708 moveto   50.4 0 rlineto   stroke	% to right of upper right page#
%
% uncomment following lines to print bottom trim line(s)
%0 setlinewidth   129.6 132 moveto   390 0 rlineto   stroke
%		 122   138 moveto     6 0 rlineto   stroke
%		 114   144 moveto    14 0 rlineto   stroke
%		 122   150 moveto     6 0 rlineto   stroke
%		 114   156 moveto    14 0 rlineto   stroke
%		 122   162 moveto     6 0 rlineto   stroke
%		 114   168 moveto    14 0 rlineto   stroke
%		 521.2 138 moveto     6 0 rlineto   stroke
%		 521.2 144 moveto    14 0 rlineto   stroke
%		 521.2 150 moveto     6 0 rlineto   stroke
%		 521.2 156 moveto    14 0 rlineto   stroke
%		 521.2 162 moveto     6 0 rlineto   stroke
%		 521.2 168 moveto    14 0 rlineto   stroke
% uncomment following line to print bottom trim line for index
%		 129.6 156 moveto   390 0 rlineto   stroke
%
% uncomment following lines to print PostScript and Courier versions
%/Courier findfont dup 10 scalefont setfont
%100 65 moveto (PostScript Version: ) show
%version show
%100 50 moveto (Courier Version: ) show
%/FontInfo get /version get show
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font AvantGarde-BookOblique
%%IncludeResource: font AvantGarde-DemiOblique
%%IncludeResource: font Helvetica-Bold
%%IncludeResource: font Palatino-Roman
%%IncludeResource: font Courier
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Palatino-Bold
%%IncludeResource: font Palatino-Italic
%%IncludeResource: font Courier-Oblique
%%IncludeResource: font Symbol
grops begin/DEFS 52 dict def DEFS begin/u{.001 mul}bind def end/RES 72 def/PL
792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron/scaron/zcaron
/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/space
/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright/parenleft
/parenright/asterisk/plus/comma/hyphen/period/slash/zero/one/two/three/four
/five/six/seven/eight/nine/colon/semicolon/less/equal/greater/question/at/A/B/C
/D/E/F/G/H/I/J/K/L/M/N/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash
/bracketright/circumflex/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q
/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase
/guillemotleft/guillemotright/bullet/florin/fraction/perthousand/dagger
/daggerdbl/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guilsinglleft/logicalnot/minus
/registered/macron/degree/plusminus/twosuperior/threesuperior/acute/mu
/paragraph/periodcentered/cedilla/onesuperior/ordmasculine/guilsinglright
/onequarter/onehalf/threequarters/questiondown/Agrave/Aacute/Acircumflex/Atilde
/Adieresis/Aring/AE/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute
/Icircumflex/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn/germandbls
/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla/egrave/eacute
/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis/eth/ntilde/ograve
/oacute/ocircumflex/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex
/udieresis/yacute/thorn/ydieresis]def/Courier-Oblique@0 ENC0/Courier-Oblique RE
/Palatino-Italic@0 ENC0/Palatino-Italic RE/Palatino-Bold@0 ENC0/Palatino-Bold
RE/Courier-Bold@0 ENC0/Courier-Bold RE/Courier@0 ENC0/Courier RE
/Palatino-Roman@0 ENC0/Palatino-Roman RE/Helvetica-Bold@0 ENC0/Helvetica-Bold
RE/AvantGarde-DemiOblique@0 ENC0/AvantGarde-DemiOblique RE
/AvantGarde-BookOblique@0 ENC0/AvantGarde-BookOblique RE
%%EndProlog
%%Page: 273 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 30/AvantGarde-BookOblique@0 SF(11)129.6 141.6 Q/F1 24
/AvantGarde-DemiOblique@0 SF(Adv)129.6 246.424 Q 6.72(anced Name)-.72 F(and)
357.84 246.424 Q(Addr)129.6 286.424 Q 13.44(ess Con)-.096 F -.48(ve)-.72 G .48
(rs).48 G(ions)-.48 E/F2 12/Helvetica-Bold@0 SF 9.312(11.1 Intr)93.6 351.6 R
(oduction)-.24 E/F3 10/Palatino-Roman@0 SF .588
(The two functions described in Chapter 9,)129.6 375.6 R/F4 10/Courier@0 SF
(gethostbyname)3.088 E F3(and)3.088 E F4(gethostbyaddr)3.088 E F3 3.088(,a)C
-.18(re)511.04 375.6 S(pr)129.6 387.6 Q 2.202(otocol dependent.)-.18 F 2.202
(When using the former)7.202 F 4.702(,w)-.74 G 4.702(em)352.352 387.6 S 2.201
(ust know which member of the)370.674 387.6 R .11(socket addr)129.6 399.6 R .11
(ess str)-.18 F(uctur)-.08 E 2.61(et)-.18 G 2.61(om)242.39 399.6 S .111
(ove the r)259.29 399.6 R .111(esult into \(e.g., the)-.18 F F4(sin_addr)2.611
E F3 .111(member for IPv4 or)2.611 F(the)129.6 411.6 Q F4(sin6_addr)3.749 E F3
1.249(member for IPv6\), and when calling the latter)3.749 F 3.748(,w)-.74 G
3.748(em)428.696 411.6 S 1.248(ust know which)446.064 411.6 R 3.244
(member contains the binary addr)129.6 423.6 R 5.744(ess. This)-.18 F 3.245
(chapter begins with the new Posix.1g)5.745 F F4(getaddrinfo)129.6 435.6 Q F3
.907(function that pr)3.407 F .907(ovides pr)-.18 F .907
(otocol independence for our applications.)-.18 F -.92(We)5.906 G
(cover its complement,)129.6 447.6 Q F4(getnameinfo)2.5 E F3 2.5(,l)C
(ater in the chapter)303.35 447.6 Q(.)-.74 E 2.016 -.92(We t)147.6 459.6 T .176
(hen use this function and develop six functions of our own that handle the ty\
p-).92 F .414(ical scenarios for TCP and UDP clients and servers.)129.6 471.6 R
2.254 -.92(We u)5.414 H .413(se these functions thr).92 F(oughout)-.18 E(the r)
129.6 483.6 Q(emainder of the text instead of calling)-.18 E F4(getaddrinfo)2.5
E F3(dir)2.5 E(ectly)-.18 E(.)-1.11 E 2.096(The functions)147.6 495.6 R F4
(gethostbyname)4.596 E F3(and)4.596 E F4(gethostbyaddr)4.597 E F3(ar)4.597 E
4.597(ea)-.18 G 2.097(lso nice examples of)424.719 495.6 R .06
(functions that ar)129.6 507.6 R 2.56(en)-.18 G(onr)215.31 507.6 Q 2.56
(eentrant. W)-.18 F 2.56(es)-.92 G .06(how why this is so and describe some r)
295.28 507.6 R(eplacement)-.18 E 1.511(functions that avoid this pr)129.6 519.6
R 4.011(oblem. Reentrancy)-.18 F 1.511(is a pr)4.011 F 1.512
(oblem that we come back to in)-.18 F 1.02(Chapter 23, but we ar)129.6 531.6 R
3.52(ea)-.18 G 1.02(ble to show and explain the pr)242.13 531.6 R 1.02
(oblem now)-.18 F 3.52(,w)-.92 G 1.02(ithout having to)446.34 531.6 R
(understand the details of thr)129.6 543.6 Q(eads.)-.18 E 4.248 -.92(We \214)
147.6 555.6 T 2.409(nish the chapter showing our complete implementation of).92
F F4(getaddrinfo)4.909 E F3(.)A .862(This lets us understand mor)129.6 567.6 R
3.362(ea)-.18 G .861(bout the function: how it operates, what it r)269.96 567.6
R .861(eturns, and)-.18 F(its interaction with IPv4 and IPv6.)129.6 579.6 Q F2
(11.2)93.6 609.6 Q/F5 12/Courier-Bold@0 SF(getaddrinfo)129.6 609.6 Q F2
(Function)6.672 E F3(The)129.6 633.6 Q F4(getaddrinfo)3.34 E F3 .841
(function hides all of the pr)3.34 F .841
(otocol dependencies in the library func-)-.18 F 1.199(tion, which is wher)
129.6 645.6 R 3.699(et)-.18 G 1.199(hey belong.)229.596 645.6 R 1.198
(The application deals only with the socket addr)6.199 F(ess)-.18 E(str)129.6
657.6 Q(uctur)-.08 E(es that ar)-.18 E 2.5<658c>-.18 G(lled in by)217.98 657.6
Q F4(getaddrinfo)2.5 E F3 5(.T)C(his function is de\214ned in Posix.1g.)341.65
657.6 Q/F6 7/Palatino-Roman@0 SF 1.75<a943>215.453 678 S(opyright 1998 by Pr)
-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E/F7 9
/Palatino-Bold@0 SF(273)506.1 678 Q EP
%%Page: 274 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(274)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2 8
/Palatino-Roman@0 SF .395(The Posix.1g de\214nition of this function comes fr)
183.6 121 R .395(om an earlier pr)-.144 F .396(oposal by Keith Sklower for a)
-.144 F .39(function named)183.6 131 R/F3 8/Courier@0 SF(getconninfo)2.39 E F2
4.39(.T)C .389(his function was the r)306.57 131 R .389
(esult of discussions with Eric Allman,)-.144 F -.44(Wi)183.6 141 S .357
(lliam Durst, Michael Kar).44 F .357(els, and Steven W)-.144 F .358(ise and fr)
-.44 F .358(om an early implementation written by)-.144 F .113(Eric Allman.)
183.6 151 R .113
(The observation that specifying a hostname and a service name would suf)4.113
F .112(\214ce for)-.144 F .667(connecting to a service independent of pr)183.6
161 R .668(otocol details was made by Marshall Rose in a pr)-.144 F(o-)-.144 E
(posal to X/Open.)183.6 171 Q/F4 8.15/Courier@0 SF(#include <netdb.h>)147.6
201.4 Q(int getaddrinfo\(const char *)147.6 221.4 Q/F5 8.15/Palatino-Italic@0
SF(hostname)A F4 4.89(,c)C(onst char *)330.429 221.4 Q F5(service)A F4(,)A
(const struct addrinfo *)225.84 231.4 Q F5(hints)A F4 4.89(,s)C
(truct addrinfo **)369.736 231.4 Q F5 -.147(re)C(sult).147 E F4(\);)A/F6 8.15
/Palatino-Roman@0 SF(Returns: 0 if OK, nonzer)319.036 251.4 Q 2.038(oo)-.147 G
2.038(ne)417.01 251.4 S(rr)427.695 251.4 Q(or \(see Figur)-.147 E 2.038(e1)
-.147 G(1.3\))488.698 251.4 Q .326 LW 129.6 189.175 129.6 255.475 DL 519.6
189.175 129.6 189.175 DL 519.6 255.475 519.6 189.175 DL 129.6 255.475 519.6
255.475 DL/F7 10/Palatino-Roman@0 SF .617(This function r)129.6 275.4 R .617
(eturns, thr)-.18 F .617(ough the)-.18 F/F8 10/Palatino-Italic@0 SF -.18(re)
3.117 G(sult).18 E F7(pointer)3.117 E 3.116(,ap)-.74 G .616
(ointer to a linked list of)362.784 275.4 R/F9 10/Courier@0 SF(addrinfo)3.116 E
F7(str)129.6 287.4 Q(uctur)-.08 E(es, which is de\214ned by including)-.18 E F9
(<netdb.h>)2.5 E F7(:)A F4(struct addrinfo {)147.6 304.6 Q 19.56(int ai_flags;)
157.38 314.6 R(/* AI_PASSIVE, AI_CANONNAME */)289.41 314.6 Q 19.56
(int ai_family;)157.38 324.6 R(/* AF_xxx */)289.41 324.6 Q 19.56
(int ai_socktype;)157.38 334.6 R(/* SOCK_xxx */)289.41 334.6 Q 19.56
(int ai_protocol;)157.38 344.6 R(/* 0 or IPPROTO_xxx for IPv4 and IPv6 */)
289.41 344.6 Q 4.89(size_t ai_addrlen;)157.38 354.6 R(/* length of ai_addr */)
289.41 354.6 Q 9.78(char *ai_canonname;)157.38 364.6 R
(/* ptr to canonical name for host */)289.41 364.6 Q(struct sockaddr)157.38
374.6 Q(*ai_addr; /* ptr to socket address structure */)9.78 E(struct addrinfo)
157.38 384.6 Q(*ai_next; /* ptr to next structure in linked list */)9.78 E(};)
147.6 394.6 Q F7(The)147.6 413.8 Q F8(hostname)2.711 E F7 .211
(is either a hostname or an addr)2.711 F .212
(ess string \(dotted-decimal for IPv4 or a)-.18 F 1.987(hex string for IPv6\).)
129.6 425.8 R(The)6.987 E F8(service)4.487 E F7 1.986
(is either a service name or a decimal port number)4.487 F 3.332
(string. \(Recall)129.6 437.8 R .832(our solution to Exer)3.332 F .832
(cise 9.6 wher)-.18 F 3.332(ew)-.18 G 3.332(ea)361.866 437.8 S .832
(llowed an addr)374.988 437.8 R .833(ess string for the)-.18 F
(host or a port number string for the service.\))129.6 449.8 Q F8(hints)147.6
461.8 Q F7 1.157(is either a null pointer or a pointer to an)3.657 F F9
(addrinfo)3.656 E F7(str)3.656 E(uctur)-.08 E 3.656(et)-.18 G 1.156
(hat the caller)460.338 461.8 R 1.634
(\214lls in with hints about the types of information that the caller wants r)
129.6 473.8 R 4.134(eturned. For)-.18 F 1.087
(example, if the speci\214ed service is pr)129.6 485.8 R 1.087
(ovided for both TCP and UDP \(e.g., the)-.18 F F9(domain)3.587 E F7 .75
(service, which r)129.6 497.8 R .751
(efers to a DNS server\), the caller can set the)-.18 F F9(ai_socktype)3.251 E
F7 .751(member of)3.251 F(the)129.6 509.8 Q F8(hints)2.63 E F7(str)2.63 E
(uctur)-.08 E 2.63(et)-.18 G(o)214.87 509.8 Q F9(SOCK_DGRAM)2.63 E F7 5.13(.T)C
.13(he only information r)296.72 509.8 R .13(eturned will be for datagram)-.18
F(sockets.)129.6 521.8 Q(The members of the)147.6 533.8 Q F8(hints)2.5 E F7
(str)2.5 E(uctur)-.08 E 2.5(et)-.18 G(hat can be set by the caller ar)306.47
533.8 Q(e:)-.18 E<83>147.6 551.8 Q F9(ai_flags)7.5 E F7(\()2.5 E F9(AI_PASSIVE)
A F7(,)A F9(AI_CANONNAME)2.5 E F7(\),)A<83>147.6 563.8 Q F9(ai_family)7.5 E F7
(\(an)2.5 E F9(AF_)2.5 E F8(xxx)A F7(value\),)2.5 E<83>147.6 575.8 Q F9
(ai_socktype)7.5 E F7(\(a)2.5 E F9(SOCK_)2.5 E F8(xxx)A F7(value\), and)2.5 E
<83>147.6 587.8 Q F9(ai_protocol)7.5 E F7(.)A(The)129.6 605.8 Q F9(AI_PASSIVE)
2.91 E F7 .411
(\215ag indicates that the socket will be used for a passive open, and the)2.91
F F9(AI_CANONNAME)129.6 617.8 Q F7(\215ag tells the function to r)2.5 E
(eturn the canonical name of the host.)-.18 E 2.821(If the)147.6 629.8 R F8
(hints)5.321 E F7(ar)5.321 E 2.821(gument is a null pointer)-.18 F 5.321(,t)
-.74 G 2.82(he function assumes a value of 0 for)341.398 629.8 R F9(ai_flags)
129.6 641.8 Q F7(,)A F9(ai_socktype)7.081 E F7 7.081(,a)C(nd)267.762 641.8 Q F9
(ai_protocol)7.081 E F7 7.081(,a)C 4.581(nd a value of)367.354 641.8 R F9
(AF_UNSPEC)7.081 E F7(for)7.082 E F9(ai_family)129.6 653.8 Q F7(.)A/F10 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 275 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.2)-.495 E/F1 9/Courier@0 SF
(getaddrinfo)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(275)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF
.708(If the function r)147.6 123 R .707(eturns success)-.18 F(\()3.207 -.4 M(0)
.4 I(\))-.4 I 3.207(,t).4 K .707(he variable pointed to by the)306.184 123 R/F4
10/Palatino-Italic@0 SF -.18(re)3.207 G(sult).18 E F3(ar)3.207 E .707
(gument is)-.18 F 2.137(\214lled in with a pointer to a linked list of)129.6
135 R/F5 10/Courier@0 SF(addrinfo)4.637 E F3(str)4.637 E(uctur)-.08 E 2.137
(es, linked thr)-.18 F 2.138(ough the)-.18 F F5(ai_next)129.6 147 Q F3(pointer)
2.5 E 5(.T)-.74 G(her)219.19 147 Q 2.5(ea)-.18 G .36 -.18(re t)245.86 147 T
(wo ways that multiple str).18 E(uctur)-.08 E(es can be r)-.18 E(eturned.)-.18
E 6.33(1. If)147.6 171 R(ther)4.423 E 4.423(ea)-.18 G 2.283 -.18(re m)206.906
171 T 1.923(ultiple addr).18 F 1.923(esses associated with the)-.18 F F4
(hostname)4.423 E F3 4.422(,o)C 1.922(ne str)453.306 171 R(uctur)-.08 E 4.422
(ei)-.18 G(s)515.36 171 Q -.18(re)163.93 183 S .794(turned for each addr).18 F
.794(ess that is usable with the r)-.18 F .794(equested addr)-.18 F .795
(ess family \(the)-.18 F F5(ai_family)163.93 195 Q F3(hint, if speci\214ed\).)
2.5 E 6.33(2. If)147.6 211 R 3.378(the service is pr)5.878 F 3.377
(ovided for multiple socket types, one str)-.18 F(uctur)-.08 E 5.877(ec)-.18 G
3.377(an be)492.583 211 R -.18(re)163.93 223 S
(turned for each socket type, depending on the).18 E F5(ai_socktype)2.5 E F3
(hint.)2.5 E .517(For example, if no hints ar)129.6 247 R 3.017(ep)-.18 G -.18
(ro)261.802 247 S .517(vided and if the).18 F F5(domain)3.017 E F3 .517
(service is looked up for a host)3.017 F(with two IP addr)129.6 259 Q
(esses, four)-.18 E F5(addrinfo)2.5 E F3(str)2.5 E(uctur)-.08 E(es ar)-.18 E
2.5(er)-.18 G(eturned:)370.22 259 Q 7.5<836f>147.6 277 S
(ne for the \214rst IP addr)166.62 277 Q(ess and a socket type of)-.18 E F5
(SOCK_STREAM)2.5 E F3(,)A 7.5<836f>147.6 289 S(ne for the \214rst IP addr)
166.62 289 Q(ess and a socket type of)-.18 E F5(SOCK_DGRAM)2.5 E F3(,)A 7.5
<836f>147.6 301 S(ne for the second IP addr)166.62 301 Q
(ess and a socket type of)-.18 E F5(SOCK_STREAM)2.5 E F3 2.5(,a)C(nd)459.96 301
Q 7.5<836f>147.6 313 S(ne for the second IP addr)166.62 313 Q
(ess and a socket type of)-.18 E F5(SOCK_DGRAM)2.5 E F3(.)A 2.682 -.92(We s)
129.6 331 T .842(how a pictur).92 F 3.342(eo)-.18 G 3.342(ft)222.368 331 S .842
(his example in Figur)232.3 331 R 3.342(e1)-.18 G 3.342(1.1. Ther)337.928 331 R
3.342(ei)-.18 G 3.342(sn)390.322 331 S 3.342(og)403.724 331 S .842
(uaranteed or)418.086 331 R .841(der of the)-.18 F(str)129.6 343 Q(uctur)-.08 E
1.289(es when multiple items ar)-.18 F 3.789(er)-.18 G 1.289
(eturned; that is, we cannot assume that TCP ser)296.255 343 R(-)-.18 E
(vices ar)129.6 355 Q 2.5(er)-.18 G(eturned befor)173.96 355 Q 2.5(eU)-.18 G
(DP services.)249.16 355 Q/F6 8/Palatino-Roman@0 SF .11
(Although not guaranteed, an implementation should r)183.6 375 R .11
(eturn the IP addr)-.144 F .11(esses in the same or)-.144 F(der)-.144 E .257
(as they ar)183.6 385 R 2.257(er)-.144 G .257(eturned by the DNS.)227.171 385 R
.257(For example, many DNS servers sort the r)4.257 F .258(eturned addr)-.144 F
(esses)-.144 E 1.552
(so that if the host sending the query and the name server ar)183.6 395 R 3.551
(eo)-.144 G 3.551(nt)423.86 395 S 1.551(he same network, then)434.675 395 R
(addr)183.6 405 Q .637(esses on that shar)-.144 F .637(ed network ar)-.144 F
2.637(er)-.144 G .637(eturned \214rst.)324.342 405 R .637
(Also, newer versions of BIND allow the)4.637 F -.144(re)183.6 415 S
(solver to specify an addr).144 E(ess sorting or)-.144 E(der in the)-.144 E/F7
8/Courier@0 SF(/etc/resolv.conf)2 E F6(\214le.)2 E F3 .528(The information r)
147.6 433 R .528(eturned in the)-.18 F F5(addrinfo)3.028 E F3(str)3.028 E
(uctur)-.08 E .528(es is r)-.18 F .527(eady for a call to)-.18 F F5(socket)
3.027 E F3 .648(and then either a call to)129.6 445 R F5(connect)3.148 E F3
3.148(,o)C(r)292.716 445 Q F5(sendto)3.148 E F3 .648(\(for a client\) or)3.148
F F5(bind)3.148 E F3 .649(\(for a server\).)3.149 F(The)5.649 E(ar)129.6 457 Q
8.458(guments to)-.18 F F5(socket)207.536 457 Q F3(ar)254.494 457 Q 10.958(et)
-.18 G 8.457(he members)282.272 457 R F5(ai_family)355.756 457 Q F3(,)A F5
(ai_socktype)423.213 457 Q F3 10.957(,a)C(nd)507.67 457 Q F5(ai_protocol)129.6
469 Q F3 8.144(.T)C 3.144(he second and thir)212.374 469 R 5.644(da)-.18 G -.18
(rg)320.22 469 S 3.145(uments to either).18 F F5(connect)5.645 E F3(or)5.645 E
F5(bind)5.645 E F3(ar)5.645 E(e)-.18 E F5(ai_addr)129.6 481 Q F3 1.251
(\(a pointer to a socket addr)3.751 F 1.251(ess str)-.18 F(uctur)-.08 E 3.751
(eo)-.18 G 3.751(ft)363.018 481 S 1.251(he appr)373.359 481 R 1.25
(opriate type, \214lled in by)-.18 F F5(getaddrinfo)129.6 493 Q F3 2.5(\)a)C
(nd)206.43 493 Q F5(ai_addrlen)2.5 E F3(\(the length of this socket addr)2.5 E
(ess str)-.18 E(uctur)-.08 E(e\).)-.18 E .45(If the)147.6 505 R F5
(AI_CANONNAME)2.95 E F3 .451(\215ag is set in the)2.951 F F4(hints)2.951 E F3
(str)2.951 E(uctur)-.08 E .451(e, the)-.18 F F5(ai_canonname)2.951 E F3(member)
2.951 E .734(of the \214rst r)129.6 517 R .734(eturned str)-.18 F(uctur)-.08 E
3.234(ep)-.18 G .734(oints to the canonical name of the host.)270.15 517 R .733
(In terms of the)5.733 F(DNS this is normally the FQDN.)129.6 529 Q(Figur)147.6
541 Q 2.5(e1)-.18 G(1.1 shows the r)183.17 541 Q
(eturned information if we execute)-.18 E/F8 8.15/Courier@0 SF(struct addrinfo)
147.6 557 Q(hints, *res;)245.4 557 Q(bzero\(&hints, sizeof\(hints\)\);)147.6
574 Q(hints.ai_flags = AI_CANONNAME;)147.6 584 Q(hints.ai_family = AF_INET;)
147.6 594 Q(getaddrinfo\("bsdi", "domain", &hints, &res\);)147.6 611 Q F3 .831
(In this \214gur)129.6 629 R 3.331(ee)-.18 G .832(verything other than the)
196.003 629 R F5(res)3.332 E F3 .832(variable is dynamically allocated memory)
3.332 F 4.12(\(e.g., fr)129.6 641 R(om)-.18 E F5(malloc)6.62 E F3 6.62(\). W)B
6.62(ea)-.92 G 4.12(ssume that the canonical name of the host)261.85 641 R F5
(bsdi)6.62 E F3(is)6.62 E F5(bsdi.kohala.com)129.6 653 Q F3 .274
(and that this host has two IPv4 addr)2.774 F .275(esses in the DNS \(Figur)
-.18 F 2.775(e1)-.18 G(.16\).)501.27 653 Q/F9 7/Palatino-Roman@0 SF 1.75<a943>
233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 276 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(276)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL 303
149.8 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST/F2 8/Courier@0 SF(ai_flags)241.8
146.16 Q 303 160.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_family)241.8
156.96 Q 303 171.4 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_socktype)241.8
167.76 Q 303 182.2 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_protocol)241.8
178.56 Q 303 193 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addrlen)241.8
189.36 Q 303 203.8 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_canonname)241.8
200.16 Q 303 214.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addr)241.8
210.96 Q 303 225.4 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_next)241.8
221.76 Q/F3 8/Courier-Bold@0 SF(addrinfo{})246.6 135.76 Q 303 272.2 MT 0 -10.8
RL -64.8 0 RL 0 10.8 RL CL ST F2(ai_flags)241.8 268.56 Q 303 283 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_family)241.8 279.36 Q 303 293.8 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_socktype)241.8 290.16 Q 303 304.6 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_protocol)241.8 300.96 Q 303 315.4 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_addrlen)241.8 311.76 Q 303 326.2 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_canonname)241.8 322.56 Q 303 337 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST(ai_addr)241.8 333.36 Q 303 347.8 MT 0 -10.8 RL -64.8
0 RL 0 10.8 RL CL ST(ai_next)241.8 344.16 Q F3(addrinfo{})246.6 258.16 Q 303
394.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST F2(ai_flags)241.8 390.96 Q 303
405.4 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_family)241.8 401.76 Q 303
416.2 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_socktype)241.8 412.56 Q 303
427 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_protocol)241.8 423.36 Q 303
437.8 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addrlen)241.8 434.16 Q 303
448.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_canonname)241.8 444.96 Q 303
459.4 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addr)241.8 455.76 Q 303 470.2
MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_next)241.8 466.56 Q F3(addrinfo{})
246.6 380.56 Q 303 517 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST F2(ai_flags)
241.8 513.36 Q 303 527.8 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_family)
241.8 524.16 Q 303 538.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_socktype)
241.8 534.96 Q 303 549.4 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_protocol)
241.8 545.76 Q 303 560.2 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addrlen)
241.8 556.56 Q 303 571 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_canonname)
241.8 567.36 Q 303 581.8 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_addr)241.8
578.16 Q 303 592.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST(ai_next)241.8
588.96 Q F3(addrinfo{})246.6 502.96 Q 202.2 149.8 MT 0 -10.8 RL -64.8 0 RL 0
10.8 RL CL ST 238.2 144.4 196.8 144.4 DL 238.2 144.4 MT -5.04 1.656 RL 0 -3.384
RL CL BL 238.2 144.4 MT -5.04 1.656 RL 0 -3.384 RL CL ST F2(res:)116.2 146.16 Q
239.064 220 238.2 220 DL 238.2 220 MT -9 0 RL -6 0 -9 3 -9 9 RC 0 6 0 10.8 0
14.4 RC 0 3.6 0 8.4 0 14.4 RC 0 6 3 9 9 9 RC 9 0 RL ST 238.2 266.8 MT -5.04
1.656 RL 0 -3.384 RL CL BL 238.2 266.8 MT -5.04 1.656 RL 0 -3.384 RL CL ST
239.064 342.4 238.2 342.4 DL 238.2 342.4 MT -9 0 RL -6 0 -9 3 -9 9 RC 0 6 0
10.8 0 14.4 RC 0 3.6 0 8.4 0 14.4 RC 0 6 3 9 9 9 RC 9 0 RL ST 238.2 389.2 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 238.2 389.2 MT -5.04 1.656 RL 0 -3.384 RL CL
ST 239.064 464.8 238.2 464.8 DL 238.2 464.8 MT -9 0 RL -6 0 -9 3 -9 9 RC 0 6 0
10.8 0 14.4 RC 0 3.6 0 8.4 0 14.4 RC 0 6 3 9 9 9 RC 9 0 RL ST 238.2 511.6 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 238.2 511.6 MT -5.04 1.656 RL 0 -3.384 RL CL
ST/F4 8/Courier-Oblique@0 SF(AF_INET)305 156.96 Q(SOCK_STREAM)305 167.76 Q(0)
305 178.56 Q(16)305 189.36 Q(AF_INET)305 279.36 Q(SOCK_DGRAM)305 290.16 Q(0)305
300.96 Q(16)305 311.76 Q(NULL)305 322.56 Q(AF_INET)305 401.76 Q(SOCK_STREAM)305
412.56 Q(0)305 423.36 Q(16)305 434.16 Q(NULL)305 444.96 Q(AF_INET)305 524.16 Q
(SOCK_DGRAM)305 534.96 Q(0)305 545.76 Q(16)305 556.56 Q(NULL)305 567.36 Q(NULL)
305 588.96 Q 432.6 214.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST 432.6 225.4
MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST 432.6 247 MT 0 -21.6 RL -64.8 0 RL 0
21.6 RL CL 0.9000 FL 432.6 247 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL ST F3
(sockaddr_in{})369 200.56 Q 384 214.6 384 203.8 DL 400.2 214.6 400.2 203.8 DL
432.6 337 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST 432.6 347.8 MT 0 -10.8 RL
-64.8 0 RL 0 10.8 RL CL ST 432.6 369.4 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL
0.9000 FL 432.6 369.4 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL ST(sockaddr_in{})
369 322.96 Q 384 337 384 326.2 DL 400.2 337 400.2 326.2 DL 432.6 459.4 MT 0
-10.8 RL -64.8 0 RL 0 10.8 RL CL ST 432.6 470.2 MT 0 -10.8 RL -64.8 0 RL 0 10.8
RL CL ST 432.6 491.8 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL 0.9000 FL 432.6
491.8 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL ST(sockaddr_in{})369 445.36 Q 384
459.4 384 448.6 DL 400.2 459.4 400.2 448.6 DL 432.6 581.8 MT 0 -10.8 RL -64.8 0
RL 0 10.8 RL CL ST 432.6 592.6 MT 0 -10.8 RL -64.8 0 RL 0 10.8 RL CL ST 432.6
614.2 MT 0 -21.6 RL -64.8 0 RL 0 21.6 RL CL 0.9000 FL 432.6 614.2 MT 0 -21.6 RL
-64.8 0 RL 0 21.6 RL CL ST(sockaddr_in{})369 567.76 Q 384 581.8 384 571 DL
400.2 581.8 400.2 571 DL 367.872 209.2 300.336 209.2 DL 367.8 209.2 MT -5.04
1.656 RL 0 -3.384 RL CL BL 367.8 209.2 MT -5.04 1.656 RL 0 -3.384 RL CL ST
367.872 331.6 300.336 331.6 DL 367.8 331.6 MT -5.04 1.656 RL 0 -3.384 RL CL BL
367.8 331.6 MT -5.04 1.656 RL 0 -3.384 RL CL ST 367.872 454 300.336 454 DL
367.8 454 MT -5.04 1.656 RL 0 -3.384 RL CL BL 367.8 454 MT -5.04 1.656 RL 0
-3.384 RL CL ST 367.872 576.4 300.336 576.4 DL 367.8 576.4 MT -5.04 1.656 RL 0
-3.384 RL CL BL 367.8 576.4 MT -5.04 1.656 RL 0 -3.384 RL CL ST F4(16)434.6
210.96 Q/F5 8/Palatino-Roman@0 SF(,)A F4(AF_INET)2 E F5(,)A F4(53)2 E
(206.62.226.35)434.6 221.76 Q(16)434.6 333.36 Q F5(,)A F4(AF_INET)2 E F5(,)A F4
(53)2 E(206.62.226.35)434.6 344.16 Q(16)434.6 455.76 Q F5(,)A F4(AF_INET)2 E F5
(,)A F4(53)2 E(206.62.226.66)434.6 466.56 Q(16)434.6 578.16 Q F5(,)A F4
(AF_INET)2 E F5(,)A F4(53)2 E(206.62.226.66)434.6 588.96 Q 475.8 182.2 MT 0
-10.8 RL -108 0 RL 0 10.8 RL CL ST F2(bsdi.kohala.com\\0)381 178.56 Q 367.8
176.8 300.336 198.4 DL 367.8 176.8 MT -4.32 3.168 RL -1.008 -3.24 RL CL BL
367.8 176.8 MT -4.32 3.168 RL -1.008 -3.24 RL CL ST 209.4 625 209.4 628.6 DL
209.4 617.8 209.4 621.4 DL 209.4 610.6 209.4 614.2 DL 209.4 603.4 209.4 607 DL
209.4 596.2 209.4 599.8 DL 209.4 589 209.4 592.6 DL 209.4 581.8 209.4 585.4 DL
209.4 574.6 209.4 578.2 DL 209.4 567.4 209.4 571 DL 209.4 560.2 209.4 563.8 DL
209.4 553 209.4 556.6 DL 209.4 545.8 209.4 549.4 DL 209.4 538.6 209.4 542.2 DL
209.4 531.4 209.4 535 DL 209.4 524.2 209.4 527.8 DL 209.4 517 209.4 520.6 DL
209.4 509.8 209.4 513.4 DL 209.4 502.6 209.4 506.2 DL 209.4 495.4 209.4 499 DL
209.4 488.2 209.4 491.8 DL 209.4 481 209.4 484.6 DL 209.4 473.8 209.4 477.4 DL
209.4 466.6 209.4 470.2 DL 209.4 459.4 209.4 463 DL 209.4 452.2 209.4 455.8 DL
209.4 445 209.4 448.6 DL 209.4 437.8 209.4 441.4 DL 209.4 430.6 209.4 434.2 DL
209.4 423.4 209.4 427 DL 209.4 416.2 209.4 419.8 DL 209.4 409 209.4 412.6 DL
209.4 401.8 209.4 405.4 DL 209.4 394.6 209.4 398.2 DL 209.4 387.4 209.4 391 DL
209.4 380.2 209.4 383.8 DL 209.4 373 209.4 376.6 DL 209.4 365.8 209.4 369.4 DL
209.4 358.6 209.4 362.2 DL 209.4 351.4 209.4 355 DL 209.4 344.2 209.4 347.8 DL
209.4 337 209.4 340.6 DL 209.4 329.8 209.4 333.4 DL 209.4 322.6 209.4 326.2 DL
209.4 315.4 209.4 319 DL 209.4 308.2 209.4 311.8 DL 209.4 301 209.4 304.6 DL
209.4 293.8 209.4 297.4 DL 209.4 286.6 209.4 290.2 DL 209.4 279.4 209.4 283 DL
209.4 272.2 209.4 275.8 DL 209.4 265 209.4 268.6 DL 209.4 257.8 209.4 261.4 DL
209.4 250.6 209.4 254.2 DL 209.4 243.4 209.4 247 DL 209.4 236.2 209.4 239.8 DL
209.4 229 209.4 232.6 DL 209.4 221.8 209.4 225.4 DL 209.4 214.6 209.4 218.2 DL
209.4 207.4 209.4 211 DL 209.4 200.2 209.4 203.8 DL 209.4 193 209.4 196.6 DL
209.4 185.8 209.4 189.4 DL 209.4 178.6 209.4 182.2 DL 209.4 171.4 209.4 175 DL
209.4 164.2 209.4 167.8 DL 209.4 157 209.4 160.6 DL 209.4 149.8 209.4 153.4 DL
209.4 142.6 209.4 146.2 DL 209.4 135.4 209.4 139 DL 209.4 128.2 209.4 131.8 DL
209.4 121 209.4 124.6 DL 213 121 209.4 121 DL 220.128 121 216.528 121 DL
227.256 121 223.656 121 DL 234.312 121 230.712 121 DL 241.44 121 237.84 121 DL
248.568 121 244.968 121 DL 255.696 121 252.096 121 DL 262.824 121 259.224 121
DL 269.88 121 266.28 121 DL 277.008 121 273.408 121 DL 284.136 121 280.536 121
DL 291.264 121 287.664 121 DL 298.392 121 294.792 121 DL 305.52 121 301.92 121
DL 312.576 121 308.976 121 DL 319.704 121 316.104 121 DL 326.832 121 323.232
121 DL 333.96 121 330.36 121 DL 341.088 121 337.488 121 DL 348.144 121 344.544
121 DL 355.272 121 351.672 121 DL 362.4 121 358.8 121 DL 369.528 121 365.928
121 DL 376.656 121 373.056 121 DL 383.712 121 380.112 121 DL 390.84 121 387.24
121 DL 397.968 121 394.368 121 DL 405.096 121 401.496 121 DL 412.224 121
408.624 121 DL 419.28 121 415.68 121 DL 426.408 121 422.808 121 DL 433.536 121
429.936 121 DL 440.664 121 437.064 121 DL 447.792 121 444.192 121 DL 454.92 121
451.32 121 DL 461.976 121 458.376 121 DL 469.104 121 465.504 121 DL 476.232 121
472.632 121 DL 483.36 121 479.76 121 DL 490.488 121 486.888 121 DL 497.544 121
493.944 121 DL 504.672 121 501.072 121 DL 511.8 121 508.2 121 DL 511.8 124.6
511.8 121 DL 511.8 131.8 511.8 128.2 DL 511.8 139 511.8 135.4 DL 511.8 146.2
511.8 142.6 DL 511.8 153.4 511.8 149.8 DL 511.8 160.6 511.8 157 DL 511.8 167.8
511.8 164.2 DL 511.8 175 511.8 171.4 DL 511.8 182.2 511.8 178.6 DL 511.8 189.4
511.8 185.8 DL 511.8 196.6 511.8 193 DL 511.8 203.8 511.8 200.2 DL 511.8 211
511.8 207.4 DL 511.8 218.2 511.8 214.6 DL 511.8 225.4 511.8 221.8 DL 511.8
232.6 511.8 229 DL 511.8 239.8 511.8 236.2 DL 511.8 247 511.8 243.4 DL 511.8
254.2 511.8 250.6 DL 511.8 261.4 511.8 257.8 DL 511.8 268.6 511.8 265 DL 511.8
275.8 511.8 272.2 DL 511.8 283 511.8 279.4 DL 511.8 290.2 511.8 286.6 DL 511.8
297.4 511.8 293.8 DL 511.8 304.6 511.8 301 DL 511.8 311.8 511.8 308.2 DL 511.8
319 511.8 315.4 DL 511.8 326.2 511.8 322.6 DL 511.8 333.4 511.8 329.8 DL 511.8
340.6 511.8 337 DL 511.8 347.8 511.8 344.2 DL 511.8 355 511.8 351.4 DL 511.8
362.2 511.8 358.6 DL 511.8 369.4 511.8 365.8 DL 511.8 376.6 511.8 373 DL 511.8
383.8 511.8 380.2 DL 511.8 391 511.8 387.4 DL 511.8 398.2 511.8 394.6 DL 511.8
405.4 511.8 401.8 DL 511.8 412.6 511.8 409 DL 511.8 419.8 511.8 416.2 DL 511.8
427 511.8 423.4 DL 511.8 434.2 511.8 430.6 DL 511.8 441.4 511.8 437.8 DL 511.8
448.6 511.8 445 DL 511.8 455.8 511.8 452.2 DL 511.8 463 511.8 459.4 DL 511.8
470.2 511.8 466.6 DL 511.8 477.4 511.8 473.8 DL 511.8 484.6 511.8 481 DL 511.8
491.8 511.8 488.2 DL 511.8 499 511.8 495.4 DL 511.8 506.2 511.8 502.6 DL 511.8
513.4 511.8 509.8 DL 511.8 520.6 511.8 517 DL 511.8 527.8 511.8 524.2 DL 511.8
535 511.8 531.4 DL 511.8 542.2 511.8 538.6 DL 511.8 549.4 511.8 545.8 DL 511.8
556.6 511.8 553 DL 511.8 563.8 511.8 560.2 DL 511.8 571 511.8 567.4 DL 511.8
578.2 511.8 574.6 DL 511.8 585.4 511.8 581.8 DL 511.8 592.6 511.8 589 DL 511.8
599.8 511.8 596.2 DL 511.8 607 511.8 603.4 DL 511.8 614.2 511.8 610.6 DL 511.8
621.4 511.8 617.8 DL 511.8 628.6 511.8 625 DL 508.2 628.6 511.8 628.6 DL
501.072 628.6 504.672 628.6 DL 493.944 628.6 497.544 628.6 DL 486.888 628.6
490.488 628.6 DL 479.76 628.6 483.36 628.6 DL 472.632 628.6 476.232 628.6 DL
465.504 628.6 469.104 628.6 DL 458.376 628.6 461.976 628.6 DL 451.32 628.6
454.92 628.6 DL 444.192 628.6 447.792 628.6 DL 437.064 628.6 440.664 628.6 DL
429.936 628.6 433.536 628.6 DL 422.808 628.6 426.408 628.6 DL 415.68 628.6
419.28 628.6 DL 408.624 628.6 412.224 628.6 DL 401.496 628.6 405.096 628.6 DL
394.368 628.6 397.968 628.6 DL 387.24 628.6 390.84 628.6 DL 380.112 628.6
383.712 628.6 DL 373.056 628.6 376.656 628.6 DL 365.928 628.6 369.528 628.6 DL
358.8 628.6 362.4 628.6 DL 351.672 628.6 355.272 628.6 DL 344.544 628.6 348.144
628.6 DL 337.488 628.6 341.088 628.6 DL 330.36 628.6 333.96 628.6 DL 323.232
628.6 326.832 628.6 DL 316.104 628.6 319.704 628.6 DL 308.976 628.6 312.576
628.6 DL 301.92 628.6 305.52 628.6 DL 294.792 628.6 298.392 628.6 DL 287.664
628.6 291.264 628.6 DL 280.536 628.6 284.136 628.6 DL 273.408 628.6 277.008
628.6 DL 266.28 628.6 269.88 628.6 DL 259.224 628.6 262.824 628.6 DL 252.096
628.6 255.696 628.6 DL 244.968 628.6 248.568 628.6 DL 237.84 628.6 241.44 628.6
DL 230.712 628.6 234.312 628.6 DL 223.656 628.6 227.256 628.6 DL 216.528 628.6
220.128 628.6 DL 209.4 628.6 213 628.6 DL F5(dynamically allocated by)211.4
625.36 Q F2(getaddrinfo)2 E/F6 8/Palatino-Bold@0 SF(Figure 1)209.584 646.6 Q
(1.1)-.296 E F5(Example of information r)6 E(eturned by)-.144 E F2(getaddrinfo)
2 E F5(.)A/F7 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 277 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.2)-.495 E/F1 9/Courier@0 SF
(getaddrinfo)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(277)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF
.729(Port 53 is for the)129.6 123 R/F4 10/Courier@0 SF(domain)3.229 E F3 .729
(service, and r)3.229 F .729(ealize that this port number will be in network)
-.18 F .792(byte or)129.6 135 R .792(der in the socket addr)-.18 F .792
(ess str)-.18 F(uctur)-.08 E 3.293(es. W)-.18 F 3.293(ea)-.92 G .793
(lso show the r)351.568 135 R(eturned)-.18 E F4(ai_protocol)3.293 E F3 1.78
(values as 0 since the combination of the)129.6 147 R F4(ai_family)4.28 E F3
(and)4.28 E F4(ai_socktype)4.28 E F3(completely)4.28 E 1.907
(speci\214es the pr)129.6 159 R 1.907(otocol for TCP and UDP)-.18 F 6.907(.I)
-1.29 G 4.407(tw)326.129 159 S 1.907(ould also be OK for)342.136 159 R F4
(getaddrinfo)4.408 E F3(to)4.408 E -.18(re)129.6 171 S 1.274(turn an).18 F F4
(ai_protocol)3.774 E F3(of)3.774 E F4(IPPROTO_TCP)3.774 E F3 1.274(for the two)
3.774 F F4(SOCK_STREAM)3.774 E F3(str)3.774 E(uctur)-.08 E 1.274(es, and)-.18 F
(an)129.6 183 Q F4(ai_protocol)2.5 E F3(of)2.5 E F4(IPPROTO_UDP)2.5 E F3
(for the two)2.5 E F4(SOCK_DGRAM)2.5 E F3(str)2.5 E(uctur)-.08 E(es.)-.18 E
(Figur)147.6 195 Q 5.176(e1)-.18 G 2.676(1.2 summarizes the number of)185.846
195 R F4(addrinfo)5.176 E F3(str)5.176 E(uctur)-.08 E 2.676(es r)-.18 F 2.676
(eturned for each)-.18 F(addr)129.6 207 Q .19(ess that is being r)-.18 F .189
(eturned, based on the speci\214ed service name \(which can be a dec-)-.18 F
(imal port number\) and any)129.6 219 Q F4(ai_socktype)2.5 E F3(hint.)2.5 E
479.4 233 169.8 233 DL/F5 8/Palatino-Roman@0 SF(Service is a name, service pr)
257.484 241 Q(ovided by:)-.144 E 419.2 245 232.6 245 DL(TCP only)247.096 253 Q
(UDP only)308.376 253 Q(TCP and UDP)363 253 Q/F6 8/Courier@0 SF(ai_socktype)
173.8 242 Q F5(hint)190.128 252 Q(Service is a)431.848 242 Q(port number)
427.848 252 Q 479.4 257 169.8 257 DL 479.4 259 169.8 259 DL 83.9(01)173.8 267 S
58.2(122)323.9 267 S F6(SOCK_STREAM)173.8 277 Q F5 51.432(1e)261.7 277 S(rr)
320.964 277 Q 49.432(or 1)-.144 F(1)448.3 277 Q F6(SOCK_DGRAM)173.8 287 Q F5
(err)254.932 287 Q 49.432(or 1)-.144 F 58.2(11)386.1 287 S 479.4 291 169.8 291
DL 419.2 233 419.2 291 DL 357 245 357 291 DL 294.8 245 294.8 291 DL 232.6 233
232.6 291 DL 479.4 233 479.4 291 DL 169.8 233 169.8 291 DL/F7 8/Palatino-Bold@0
SF(Figure 1)199.928 309 Q(1.2)-.296 E F5(Number of)6 E F6(addrinfo)2 E F5(str)2
E(uctur)-.064 E(es r)-.144 E(eturned per IP addr)-.144 E(ess.)-.144 E F3
(Multiple)129.6 333 Q F4(addrinfo)6.859 E F3(str)6.859 E(uctur)-.08 E 4.359
(es ar)-.18 F 6.859(er)-.18 G 4.359(eturned for each IP addr)304.576 333 R
4.359(ess only when no)-.18 F F4(ai_socktype)129.6 345 Q F3 1.07(hint is pr)
3.57 F 1.07(ovided and either the service name is supported by TCP and)-.18 F
(UDP \(as indicated in the)129.6 357 Q F4(/etc/services)2.5 E F3
(\214le\) or a port number is speci\214ed.)2.5 E .761
(If we enumerated all 64 possible inputs to)147.6 369 R F4(getaddrinfo)3.262 E
F3(\(ther)3.262 E 3.262(ea)-.18 G 1.122 -.18(re s)444.074 369 T .762
(ix input vari-).18 F .724
(ables\), many would be invalid and some make little sense.)129.6 381 R .723
(Instead we will look at the)5.723 F(common cases.)129.6 393 Q 8.83<8353>147.6
417 S 1.377(pecify the)167.74 417 R/F8 10/Palatino-Italic@0 SF(hostname)3.877 E
F3(and)3.877 E F8(service)3.877 E F3 6.377(.T)C 1.377
(his is normal for a TCP or UDP client.)321.835 417 R(On)6.378 E -.18(re)162.49
429 S .357(turn a TCP client loops thr).18 F .357(ough all r)-.18 F .357
(eturned IP addr)-.18 F .356(esses, calling)-.18 F F4(socket)2.856 E F3(and)
2.856 E F4(connect)162.49 441 Q F3 .495
(for each one, until the connection succeeds or until all addr)2.995 F .495
(esses have)-.18 F .129(been tried.)162.49 453 R 1.969 -.92(We s)5.129 H .129
(how an example of this with our).92 F F4(tcp_connect)2.628 E F3 .128
(function in Fig-)2.628 F(ur)162.49 465 Q 2.5(e1)-.18 G(1.6.)184.03 465 Q .495
(For a UDP client, the socket addr)162.49 483 R .495(ess str)-.18 F(uctur)-.08
E 2.995<658c>-.18 G .495(lled in by)376.23 483 R F4(getaddrinfo)2.995 E F3
(would)2.995 E 2.06(be used in a call to)162.49 495 R F4(sendto)4.56 E F3(or)
4.56 E F4(connect)4.56 E F3 7.06(.I)C 4.56(ft)368.51 495 S 2.06
(he client can tell that the \214rst)379.66 495 R(addr)162.49 507 Q .434
(ess doesn't appear to work \(either an err)-.18 F .435
(or on a connected UDP socket or a)-.18 F
(timeout on an unconnected socket\), additional addr)162.49 519 Q
(esses can be tried.)-.18 E .111
(If the client knows it handles only one type of socket \(e.g., T)162.49 537 R
.11(elnet and FTP clients)-.92 F .343(handle only TCP)162.49 549 R 2.843(,T)
-1.29 G .344(FTP clients handle only UDP\), then the)247.819 549 R F4
(ai_socktype)2.844 E F3(mem-)2.844 E 3.821(ber of the)162.49 561 R F8(hints)
6.321 E F3(str)6.321 E(uctur)-.08 E 6.321(es)-.18 G 3.821
(hould be speci\214ed as either)295.515 561 R F4(SOCK_STREAM)6.321 E F3(or)6.32
E F4(SOCK_DGRAM)162.49 573 Q F3(.)A 8.83<8341>147.6 589 S 4.287
(typical server speci\214es)177.057 589 R F8(service)6.787 E F3 4.287
(but not the)6.787 F F8(hostname)6.787 E F3 6.788(,a)C 4.288
(nd speci\214es the)442.754 589 R F4(AI_PASSIVE)162.49 601 Q F3 .642
(\215ag in the)3.142 F F8(hints)3.142 E F3(str)3.142 E(uctur)-.08 E 3.142
(e. The)-.18 F .642(socket addr)3.142 F .642(ess str)-.18 F(uctur)-.08 E .642
(es r)-.18 F(eturned)-.18 E .068(should contain an IP addr)162.49 613 R .068
(ess of)-.18 F F4(INADDR_ANY)2.568 E F3 .068(\(for IPv4\) or)2.568 F F4
(IN6ADDR_ANY_INIT)2.568 E F3 1.207(\(for IPv6\).)162.49 625 R 3.706(AT)6.207 G
1.206(CP server then calls)231.98 625 R F4(socket)3.706 E F3(,)A F4(bind)3.706
E F3 3.706(,a)C(nd)403.906 625 Q F4(listen)3.706 E F3 6.206(.I)C 3.706(ft)
467.618 625 S 1.206(he server)477.914 625 R .586(wants to)162.49 637 R F4
(malloc)3.086 E F3 .586(another socket addr)3.086 F .586(ess str)-.18 F(uctur)
-.08 E 3.086(et)-.18 G 3.087(oo)394.532 637 S .587(btain the client's addr)
408.539 637 R(ess)-.18 E(fr)162.49 649 Q(om)-.18 E F4(accept)2.5 E F3 2.5(,t)C
(he r)230.64 649 Q(eturned)-.18 E F4(ai_addrlen)2.5 E F3
(value speci\214es this size.)2.5 E/F9 7/Palatino-Roman@0 SF 1.75<a943>233.453
678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 278 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(278)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF 4.478(AU)162.49 123 S 1.978(DP server would call)182.528
123 R/F3 10/Courier@0 SF(socket)4.478 E F2(,)A F3(bind)4.478 E F2 4.477(,a)C
1.977(nd then)364.655 123 R F3(recvfrom)4.477 E F2 6.977(.I)C 4.477(ft)466.076
123 S 1.977(he server)477.143 123 R .586(wants to)162.49 135 R F3(malloc)3.086
E F2 .586(another socket addr)3.086 F .586(ess str)-.18 F(uctur)-.08 E 3.086
(et)-.18 G 3.087(oo)394.532 135 S .587(btain the client's addr)408.539 135 R
(ess)-.18 E(fr)162.49 147 Q(om)-.18 E F3(recvfrom)2.5 E F2 2.5(,t)C(he r)242.64
147 Q(eturned)-.18 E F3(ai_addrlen)2.5 E F2(value speci\214es this size.)2.5 E
.925(As with the typical client code, if the server knows it only handles one \
type of)162.49 165 R .828(socket, the)162.49 177 R F3(ai_socktype)3.328 E F2
.828(member of the)3.328 F/F4 10/Palatino-Italic@0 SF(hints)3.328 E F2(str)
3.328 E(uctur)-.08 E 3.328(es)-.18 G .829(hould be set to either)423.104 177 R
F3(SOCK_STREAM)162.49 189 Q F2(or)7.985 E F3(SOCK_DGRAM)7.985 E F2 10.484(.T)C
5.484(his avoids having multiple str)332.984 189 R(uctur)-.08 E(es)-.18 E -.18
(re)162.49 201 S(turned, possibly with the wr).18 E(ong)-.18 E F3(ai_socktype)
2.5 E F2(value.)2.5 E 8.83<8354>147.6 217 S .694
(he TCP servers that we have shown so far cr)168.62 217 R .695
(eate one listening socket, and the)-.18 F .674(UDP servers cr)162.49 229 R
.674(eate one datagram socket.)-.18 F .674(That is what we assume in the pr)
5.674 F(evi-)-.18 E .382(ous item.)162.49 241 R .382
(An alternate server design is for the server to handle multiple sockets)5.382
F(using)162.49 253 Q F3(select)3.952 E F2 6.452(.I)C 3.952(nt)239.324 253 S
1.452(his scenario the server would go thr)252.356 253 R 1.451(ough the entir)
-.18 F 3.951(el)-.18 G 1.451(ist of)496.449 253 R(str)162.49 265 Q(uctur)-.08 E
1.127(es r)-.18 F 1.127(eturned by)-.18 F F3(getaddrinfo)3.627 E F2 3.627(,c)C
-.18(re)343.478 265 S 1.127(ate one socket per str).18 F(uctur)-.08 E 1.127
(e, and use)-.18 F F3(select)162.49 277 Q F2(.)A/F5 8/Palatino-Roman@0 SF .367
(The pr)201.6 297 R .367(oblem with this technique is that one r)-.144 F .366
(eason for)-.144 F/F6 8/Courier@0 SF(getaddrinfo)2.366 E F5 -.144(re)2.366 G
.366(turning multiple).144 F(str)201.6 307 Q(uctur)-.064 E .15
(es is when a service can be handled by IPv4 and IPv6 \(Figur)-.144 F 2.151(e1)
-.144 G 2.151(1.4\). But)452.195 307 R .151(these two)2.151 F(pr)201.6 317 Q
.257(otocols ar)-.144 F 2.257(en)-.144 G .257
(ot completely independent, as we saw in Section 10.2.)254.426 317 R .256
(That is, if we cr)4.256 F(eate)-.144 E 3.048(al)201.6 327 S 1.049
(istening IPv6 socket for a given port, ther)210.976 327 R 3.049(ei)-.144 G
3.049(sn)373.056 327 S 3.049(on)384.153 327 S 1.049(eed to also cr)396.226 327
R 1.049(eate a listening IPv4)-.144 F 1.076
(socket for that same port, because connections arriving fr)201.6 337 R 1.076
(om IPv4 clients ar)-.144 F 3.076(ea)-.144 G(utomati-)489.136 337 Q
(cally handled by the pr)201.6 347 Q
(otocol stack and by the IPv6 listening socket.)-.144 E F2 2.747
(Despite the fact that)147.6 365 R F3(getaddrinfo)5.247 E F2 2.747(is `)5.247 F
-1.76(`better ')-.37 F 5.247('t)-.37 G 2.747(han the)378.419 365 R F3
(gethostbyname)5.247 E F2(and)5.247 E F3(getservbyname)129.6 377 Q F2 .825
(functions \(it makes it easier to write pr)3.325 F .825
(otocol-independent code, one)-.18 F .344
(function handles both the hostname and the service, and all the r)129.6 389 R
.344(eturned information is)-.18 F .184(dynamically allocated, not statically \
allocated\), it is still not as easy to use as it could be.)129.6 401 R .232
(The pr)129.6 413 R .233(oblem is that we must allocate a)-.18 F F4(hints)2.733
E F2(str)2.733 E(uctur)-.08 E .233(e, initialize it to 0, \214ll in the desir)
-.18 F(ed)-.18 E 1.122(\214elds, call)129.6 425 R F3(getaddrinfo)3.622 E F2
3.622(,a)C 1.121(nd then traverse a linked list trying each one.)255.826 425 R
1.121(In the next)6.121 F 1.174(sections we pr)129.6 437 R 1.175
(ovide some simpler interfaces for the typical TCP and UDP clients and)-.18 F
(servers that we write in the r)129.6 449 Q(emainder of this text.)-.18 E F3
(getaddrinfo)147.6 461 Q F2 .48(solves the pr)2.98 F .48
(oblem of converting hostnames and service names into)-.18 F 5.568(socket addr)
129.6 473 R 5.568(ess str)-.18 F(uctur)-.08 E 8.068(es. In)-.18 F 5.568
(Section 1)8.068 F 5.568(1.13 we describe the r)-.55 F 5.568(everse function,)
-.18 F F3(getnameinfo)129.6 485 Q F2 4.224(,w)C 1.724
(hich converts socket addr)210.664 485 R 1.723(ess str)-.18 F(uctur)-.08 E
1.723(es into hostnames and service)-.18 F 9.634(names. In)129.6 497 R 7.134
(Section 1)9.634 F 7.134(1.16 we pr)-.55 F 7.135(ovide an implementation of)
-.18 F F3(getaddrinfo)9.635 E F2(,)A F3(getnameinfo)129.6 509 Q F2 2.5(,a)C(nd)
205.6 509 Q F3(freeaddrinfo)2.5 E F2(.)A/F7 12/Helvetica-Bold@0 SF(11.3)93.6
537.8 Q/F8 12/Courier-Bold@0 SF(gai_strerror)129.6 537.8 Q F7(Function)6.672 E
F2 1.853(The nonzer)129.6 561.8 R 4.353(oe)-.18 G(rr)195.956 561.8 Q 1.853
(or r)-.18 F 1.853(eturn values fr)-.18 F(om)-.18 E F3(getaddrinfo)4.353 E F2
1.852(have the names and meanings)4.353 F 1.801(shown in Figur)129.6 573.8 R
4.301(e1)-.18 G 4.301(1.3. The)213.983 573.8 R(function)4.301 E F3
(gai_strerror)4.301 E F2 1.802(takes one of these values as an)4.302 F(ar)129.6
585.8 Q(gument and r)-.18 E(eturns a pointer to the corr)-.18 E(esponding err)
-.18 E(or string.)-.18 E/F9 8.15/Courier@0 SF(#include <netdb.h>)147.6 607.8 Q
(char *gai_strerror\(int)147.6 627.8 Q/F10 8.15/Palatino-Italic@0 SF(err)4.89 E
(or)-.147 E F9(\);)A/F11 8.15/Palatino-Roman@0 SF
(Returns: pointer to string describing err)318.58 647.8 Q(or message)-.147 E
.326 LW 129.6 595.575 129.6 651.875 DL 519.6 595.575 129.6 595.575 DL 519.6
651.875 519.6 595.575 DL 129.6 651.875 519.6 651.875 DL/F12 7/Palatino-Roman@0
SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 279 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.5)-.495 E/F1 9/Courier@0 SF
(getaddrinfo)283.602 82 Q F0 2.25(Function: IPv6 and Unix Domain)4.5 F/F2 9
/Palatino-Bold@0 SF(279)506.1 82 Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL
445.892 115 203.308 115 DL/F3 8/Palatino-Roman@0 SF 84.7(Constant Description)
224.928 123 R 445.892 127 203.308 127 DL 445.892 129 203.308 129 DL/F4 8
/Courier@0 SF(EAI_ADDRFAMILY)207.308 137 Q F3(addr)286.508 137 Q
(ess family for)-.144 E/F5 8/Palatino-Italic@0 SF(hostname)2 E F3
(not supported)2 E F4(EAI_AGAIN)207.308 147 Q F3(temporary failur)286.508 147 Q
2(ei)-.144 G 2(nn)353.276 147 S(ame r)364.588 147 Q(esolution)-.144 E F4
(EAI_BADFLAGS)207.308 157 Q F3(invalid value for)286.508 157 Q F4(ai_flags)2 E
(EAI_FAIL)207.308 167 Q F3(nonr)286.508 167 Q(ecoverable failur)-.144 E 2(ei)
-.144 G 2(nn)370.372 167 S(ame r)381.684 167 Q(esolution)-.144 E F4 26.4
(EAI_FAMILY ai_family)207.308 177 R F3(not supported)2 E F4(EAI_MEMORY)207.308
187 Q F3(memory allocation failur)286.508 187 Q(e)-.144 E F4(EAI_NODATA)207.308
197 Q F3(no addr)286.508 197 Q(ess associated with)-.144 E F5(hostname)2 E F4
(EAI_NONAME)207.308 207 Q F5(hostname)286.508 207 Q F3(nor)2 E F5(service)2 E
F3(pr)2 E(ovided, or not known)-.144 E F4(EAI_SERVICE)207.308 217 Q F5(service)
286.508 217 Q F3(not supported for)2 E F4(ai_socktype)2 E 16.8
(EAI_SOCKTYPE ai_socktype)207.308 227 R F3(not supported)2 E F4(EAI_SYSTEM)
207.308 237 Q F3(system err)286.508 237 Q(or r)-.144 E(eturned in)-.144 E F4
(errno)2 E 445.892 241 203.308 241 DL 280.508 115 280.508 241 DL 445.892 115
445.892 241 DL 203.308 115 203.308 241 DL/F6 8/Palatino-Bold@0 SF(Figure 1)
209.136 259 Q(1.3)-.296 E F3(Nonzer)6 E 2(oe)-.144 G(rr)291.12 259 Q(or r)-.144
E(eturn constants fr)-.144 E(om)-.144 E F4(getaddrinfo)2 E F3(.)A/F7 12
/Helvetica-Bold@0 SF(11.4)93.6 299.8 Q/F8 12/Courier-Bold@0 SF(freeaddrinfo)
129.6 299.8 Q F7(Function)6.672 E/F9 10/Palatino-Roman@0 SF 1.064
(All of the storage r)129.6 323.8 R 1.064(eturned by)-.18 F/F10 10/Courier@0 SF
(getaddrinfo)3.564 E F9 3.564(,t)C(he)344.438 323.8 Q F10(addrinfo)3.563 E F9
(str)3.563 E(uctur)-.08 E 1.063(es, the)-.18 F F10(ai_addr)3.563 E F9(str)129.6
335.8 Q(uctur)-.08 E .105(es, and the)-.18 F F10(ai_canonname)2.605 E F9 .105
(string ar)2.605 F 2.605(eo)-.18 G .105(btained dynamically fr)339.22 335.8 R
(om)-.18 E F10(malloc)2.605 E F9 5.105(.T)C(his)506.63 335.8 Q(storage is r)
129.6 347.8 Q(eturned by calling)-.18 E F10(freeaddrinfo)2.5 E F9(.)A/F11 8.15
/Courier@0 SF(#include <netdb.h>)147.6 369.8 Q
(void freeaddrinfo\(struct addrinfo *)147.6 389.8 Q/F12 8.15/Palatino-Italic@0
SF(ai)A F11(\);)A .326 LW 129.6 357.575 129.6 393.875 DL 519.6 357.575 129.6
357.575 DL 519.6 393.875 519.6 357.575 DL 129.6 393.875 519.6 393.875 DL/F13 10
/Palatino-Italic@0 SF(ai)129.6 413.8 Q F9 .566
(should point to the \214rst of the)3.067 F F10(addrinfo)3.066 E F9(str)3.066 E
(uctur)-.08 E .566(es r)-.18 F .566(eturned by)-.18 F F10(getaddrinfo)3.066 E
F9 5.566(.A)C(ll)513.78 413.8 Q .351(the str)129.6 425.8 R(uctur)-.08 E .351
(es in the linked list ar)-.18 F 2.851(ef)-.18 G -.18(re)288.267 425.8 S .352
(ed, along with any dynamic storage pointed to by).18 F(those str)129.6 437.8 Q
(uctur)-.08 E(es \(e.g., socket addr)-.18 E(ess str)-.18 E(uctur)-.08 E
(es and canonical hostnames\).)-.18 E .058(Assume we call)147.6 449.8 R F10
(getaddrinfo)2.558 E F9 2.557(,t)C .057(raverse the linked list of)293.891
449.8 R F10(addrinfo)2.557 E F9(str)2.557 E(uctur)-.08 E .057(es, and)-.18 F
.707(\214nd the desir)129.6 461.8 R .707(ed str)-.18 F(uctur)-.08 E 3.207
(e. If)-.18 F .708(we then try to save a copy of the information by copying)
3.207 F .208(just the)129.6 473.8 R F10(addrinfo)2.708 E F9(str)2.708 E(uctur)
-.08 E 2.708(ea)-.18 G .208(nd then call)262.862 473.8 R F10(freeaddrinfo)2.708
E F9 2.708(,w)C 2.708(eh)403.414 473.8 S .207(ave a lurking bug.)416.732 473.8
R(The)5.207 E -.18(re)129.6 485.8 S 1.56(ason is that the).18 F F10(addrinfo)
4.06 E F9(str)4.06 E(uctur)-.08 E 4.06(ei)-.18 G 1.56
(tself points to dynamically allocated memory)312 485.8 R .202
(\(for the socket addr)129.6 497.8 R .202(ess str)-.18 F(uctur)-.08 E 2.702(ea)
-.18 G .201(nd possibly the canonical name\) and memory pointed)279.75 497.8 R
.577(to by our saved str)129.6 509.8 R(uctur)-.08 E 3.077(ei)-.18 G 3.077(sr)
248.625 509.8 S .577(eturned to the system when)259.712 509.8 R F10
(freeaddrinfo)3.077 E F9 .578(is called and)3.077 F
(can be used for something else.)129.6 521.8 Q F3 .172
(Making a copy of just the)183.6 541.8 R F4(addrinfo)2.172 E F3(str)2.172 E
(uctur)-.064 E 2.172(ea)-.144 G .172(nd not the str)354.576 541.8 R(uctur)-.064
E .171(es that it in turn points to is)-.144 F .109(called a)183.6 551.8 R F5
.109(shallow copy)2.109 F F3 4.109(.C)C .109(opying the)265.884 551.8 R F4
(addrinfo)2.109 E F3(str)2.109 E(uctur)-.064 E 2.109(ea)-.144 G .109
(nd all the str)384.624 551.8 R(uctur)-.064 E .109(es that it points to is)
-.144 F(called a)183.6 561.8 Q F5(deep copy)2 E F3(.)A F7(11.5)93.6 597.8 Q F8
(getaddrinfo)129.6 597.8 Q F7 3.336(Function: IPv6 and Unix Domain)6.672 F F9
.206(Although Posix.1g de\214nes the)129.6 621.8 R F10(getaddrinfo)2.706 E F9
.206(function, it says nothing about IPv6 at all.)2.706 F 2.425
(The interaction between this function, the r)129.6 633.8 R 2.426
(esolver \(especially the)-.18 F F10(RES_USE_INET6)4.926 E F9 1.334(option; r)
129.6 645.8 R 1.334(ecall Figur)-.18 F 3.834(e9)-.18 G 1.334
(.5\), and IPv6 is nontrivial.)229.962 645.8 R 3.174 -.92(We n)6.334 H 1.334
(ote the following points befor).92 F(e)-.18 E
(summarizing these interactions in Figur)129.6 657.8 Q 2.5(e1)-.18 G(1.4.)
317.74 657.8 Q/F14 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 280 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(280)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF<83>147.6 123 Q/F3 10/Courier@0 SF(getaddrinfo)8.83 E F2
.402(is dealing with two dif)2.902 F(fer)-.18 E .403
(ent inputs: what type of socket addr)-.18 F(ess)-.18 E(str)162.49 135 Q(uctur)
-.08 E 2.755(ed)-.18 G .255(oes the caller want back and what type of r)211.045
135 R(ecor)-.18 E .254(ds should be sear)-.18 F(ched)-.18 E(for in the DNS.)
162.49 147 Q 8.83<8354>147.6 163 S(he addr)168.62 163 Q
(ess family in the hints str)-.18 E(uctur)-.08 E 2.5(ep)-.18 G -.18(ro)349.88
163 S(vided by the caller speci\214es the type).18 E 1.469(of socket addr)
162.49 175 R 1.469(ess str)-.18 F(uctur)-.08 E 3.969(et)-.18 G 1.468
(hat the caller expects to be r)292.116 175 R 3.968(eturned. If)-.18 F 1.468
(the caller)3.968 F(speci\214es)162.49 187 Q F3(AF_INET)3.041 E F2 3.041(,t)C
.541(he function must not r)253.802 187 R .541(eturn any)-.18 F F3
(sockaddr_in6)3.041 E F2(str)3.042 E(uctur)-.08 E(es)-.18 E 4.433
(and if the caller speci\214es)162.49 199 R F3(AF_INET6)6.933 E F2 6.933(,t)C
4.433(he function must not r)356.358 199 R 4.432(eturn any)-.18 F F3
(sockaddr_in)162.49 211 Q F2(str)2.5 E(uctur)-.08 E(es.)-.18 E 8.83<8350>147.6
227 S .082(osix.1g says that specifying)168.53 227 R F3(AF_UNSPEC)2.583 E F2
.083(shall r)2.583 F .083(eturn addr)-.18 F .083(esses that can be used)-.18 F
(with)162.49 239 Q/F4 10/Palatino-Italic@0 SF(any)3.102 E F2(pr)3.102 E .601
(otocol family that can be used with the hostname and service name.)-.18 F
1.388(This implies that if a host has both AAAA r)162.49 251 R(ecor)-.18 E
1.389(ds and A r)-.18 F(ecor)-.18 E 1.389(ds, the AAAA)-.18 F -.18(re)162.49
263 S(cor).18 E .828(ds ar)-.18 F 3.328(er)-.18 G(eturned)219.056 263 Q F3
(sockaddr_in6)3.328 E F2(str)3.328 E(uctur)-.08 E .828(es and the A r)-.18 F
(ecor)-.18 E .828(ds ar)-.18 F 3.328(er)-.18 G(eturned)484.85 263 Q(as)162.49
275 Q F3(sockaddr_in)3.485 E F2(str)3.485 E(uctur)-.08 E 3.485(es. It)-.18 F
.985(makes no sense to also r)3.485 F .986(eturn the A r)-.18 F(ecor)-.18 E
.986(ds as)-.18 F 2.869(IPv4-mapped IPv6 addr)162.49 287 R 2.869(esses in)-.18
F F3(sockaddr_in6)5.369 E F2(str)5.369 E(uctur)-.08 E 2.868
(es as no additional)-.18 F 2.183(information is being r)162.49 299 R 2.183
(eturned: these addr)-.18 F 2.183(esses ar)-.18 F 4.683(ea)-.18 G(lr)405.551
299 Q 2.183(eady being r)-.18 F 2.183(eturned in)-.18 F F3(sockaddr_in)162.49
311 Q F2(str)2.5 E(uctur)-.08 E(es.)-.18 E 8.83<8354>147.6 327 S .698
(his statement in Posix.1g also implies that if the)168.62 327 R F3(AI_PASSIVE)
3.197 E F2 .697(\215ag is speci\214ed)3.197 F 1.4
(without a hostname, then the IPv6 wildcar)162.49 339 R 3.9(da)-.18 G(ddr)373.8
339 Q 1.4(ess \()-.18 F F3(IN6ADDR_ANY_INIT)A F2(or)3.9 E .833(0::0)162.49 351
S 4.721(\)s)-.833 G 2.221(hould be r)192.28 351 R 2.221(eturned as a)-.18 F F3
(sockaddr_in6)4.721 E F2(str)4.721 E(uctur)-.08 E 4.721(ea)-.18 G 2.221
(long with the IPv4)431.427 351 R(wildcar)162.49 363 Q 3.695(da)-.18 G(ddr)
210.775 363 Q 1.195(ess \()-.18 F F3(INADDR_ANY)A F2 1.195(or 0.0.0.0\), r)
3.695 F 1.196(eturned as a)-.18 F F3(sockaddr_in)3.696 E F2(str)3.696 E(uc-)
-.08 E(tur)162.49 375 Q 3.704(e. It)-.18 F 1.204(also makes sense to r)3.704 F
1.204(eturn the IPv6 wildcar)-.18 F 3.704(da)-.18 G(ddr)413.78 375 Q 1.203
(ess \214rst because we)-.18 F 1.443
(saw in Section 10.2 that an IPv6 server socket can handle both IPv6 and IPv4)
162.49 387 R(clients on a dual-stack host.)162.49 399 Q 8.83<8354>147.6 415 S
2.76(he r)168.62 415 R -1.76(esolver 's)-.18 F F3(RES_USE_INET6)5.26 E F2 2.76
(option along with which function is called)5.26 F(\()162.49 427 Q F3
(gethostbyname)A F2(or)4.363 E F3(gethostbyname2)4.363 E F2 4.363(\)d)C 1.863
(ictates the type of r)359.759 427 R(ecor)-.18 E 1.864(ds that ar)-.18 F(e)-.18
E(sear)162.49 439 Q .601(ched for in the DNS)-.18 F(\()3.101 -.4 M 3.101(Ao).4
K 3.101(rA)293.266 439 S(AAA)308.097 439 Q(\))-.4 I .601(and what type of addr)
3.101 .4 N .6(esses ar)-.18 F 3.1(er)-.18 G(eturned)484.85 439 Q
(\(IPv4, IPv6, or IPv4-mapped IPv6\).)162.49 451 Q 1.84 -.92(We s)5 H
(ummarized this in Figur).92 E 2.5(e9)-.18 G(.5.)462.02 451 Q 8.83<8354>147.6
467 S 1.227
(he hostname can also be either an IPv6 hex string or an IPv4 dotted-decimal)
168.62 467 R 2.65(string. The)162.49 479 R .149
(validity of this string depends on the addr)2.65 F .149
(ess family speci\214ed by the)-.18 F(caller)162.49 491 Q 5.412(.A)-.74 G 2.912
(nI)201.442 491 S .413(Pv6 hex string is not acceptable if)213.544 491 R F3
(AF_INET)2.913 E F2 .413(is speci\214ed, and an IPv4)2.913 F 1.355
(dotted-decimal string is not acceptable if)162.49 503 R F3(AF_INET6)3.855 E F2
1.354(is speci\214ed.)3.854 F 1.354(But either is)6.354 F .074(acceptable if)
162.49 515 R F3(AF_UNSPEC)2.574 E F2 .074(is speci\214ed, and the appr)2.574 F
.075(opriate type of socket addr)-.18 F(ess)-.18 E(str)162.49 527 Q(uctur)-.08
E 2.5(er)-.18 G(eturned.)208.45 527 Q/F5 8/Palatino-Roman@0 SF 1.061
(One could ar)201.6 547 R 1.061(gue that if)-.144 F/F6 8/Courier@0 SF(AF_INET6)
3.06 E F5 1.06(is speci\214ed, then a dotted-decimal string should be)3.06 F
-.144(re)201.6 557 S 1.239(turned as an IPv4-mapped IPv6 addr).144 F 1.239
(ess in a)-.144 F F6(sockaddr_in6)3.239 E F5(str)3.24 E(uctur)-.064 E 3.24
(e. But)-.144 F(another)3.24 E(way to obtain this r)201.6 567 Q(esult is to pr)
-.144 E(e\214x the dotted-decimal string with)-.144 E F6(0::ffff:)2 E F5(.)A F2
(Figur)129.6 585 Q 6.109(e1)-.18 G 3.608(1.4 summarizes how we expect)168.779
585 R F3(getaddrinfo)6.108 E F2 3.608(to handle IPv4 and IPv6)6.108 F(addr)
129.6 597 Q 3.19(esses. The)-.18 F -.37(``)3.19 G -.18(re).37 G(sult').18 E
3.19('c)-.37 G .691(olumn is what we want r)244.02 597 R .691
(eturned to the caller)-.18 F 3.191(,g)-.74 G .691(iven the vari-)459.338 597 R
.749(ables in the \214rst thr)129.6 609 R .749(ee columns.)-.18 F .749(The `)
5.749 F(`action')-.37 E 3.249('c)-.37 G .748(olumn is how we obtain this r)
341.772 609 R .748(esult and)-.18 F .502
(we show the code that performs this action in our implementation of)129.6 621
R F3(getaddrinfo)3.003 E F2(in)3.003 E(Section 1)129.6 633 Q(1.16.)-.55 E/F7 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 281 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.5)-.495 E/F1 9/Courier@0 SF
(getaddrinfo)283.602 82 Q F0 2.25(Function: IPv6 and Unix Domain)4.5 F/F2 9
/Palatino-Bold@0 SF(281)506.1 82 Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL
520.216 115 100.8 115 DL/F3 8/Palatino-Roman@0 SF 10(Hostname Addr)104.8 123 R
(ess family)-.144 E(Hostname)231.34 123 Q 24.048(speci\214ed speci\214ed)
107.352 133 R 67.128(string Result)239.332 133 R(Action)446.748 133 Q
(by caller)108.052 143 Q(by caller)165.572 143 Q(contains)234.848 143 Q 520.216
147 100.8 147 DL 520.216 149 100.8 149 DL(two DNS sear)401.016 157 Q
(ches \(note 1\):)-.144 E(all AAAA r)291.416 167 Q(ecor)-.144 E(ds r)-.144 E
(eturned)-.144 E/F4 8/Courier@0 SF(gethostbyname2\(AF_INET6\))401.016 167 Q F3
(as)299.416 177 Q F4(sockaddr_in6{})2 E F3 29.616(sw)C(ith)415.688 177 Q F4
(RES_USE_INET6)2 E F3(of)2 E(f)-.144 E/F5 8/Palatino-Italic@0 SF(and)291.416
187 Q F3(all A r)2 E(ecor)-.144 E(ds r)-.144 E(eturned)-.144 E F4
(gethostbyname2\(AF_INET\))401.016 187 Q F3(as)299.416 197 Q F4(sockaddr_in{})2
E F3 34.416(sw)C(ith)415.688 197 Q F4(RES_USE_INET6)2 E F3(of)2 E(f)-.144 E
(hostname)219.84 177 Q 520.216 201 213.84 201 DL(hex string)219.84 209 Q(one)
291.416 209 Q F4 22.744(sockaddr_in6{} inet_pton\(AF_INET6\))2 F 520.216 213
213.84 213 DL F3(dotted decimal)219.84 221 Q(one)291.416 221 Q F4 27.544
(sockaddr_in{} inet_pton\(AF_INET\))2 F(AF_UNSPEC)153.376 189 Q 520.216 225
147.376 225 DL F3(all AAAA r)291.416 233 Q(ecor)-.144 E(ds r)-.144 E(eturned)
-.144 E F4(gethostbyname\(\))401.016 233 Q F3(as)299.416 243 Q F4
(sockaddr_in6{})2 E F3 25.616(s, with)B F4(RES_USE_INET6)2 E F3(on)2 E F5(else)
291.416 253 Q F3(all A r)2 E(ecor)-.144 E(ds r)-.144 E 24.28(eturned \(note)
-.144 F(2\))2 E(as IPv4-mapped IPv6)299.416 263 Q(as)299.416 273 Q F4
(sockaddr_in6{})2 E F3(s)A(hostname)219.84 253 Q 520.216 277 213.84 277 DL
(hex string)219.84 285 Q(one)291.416 285 Q F4 22.744
(sockaddr_in6{} inet_pton\(AF_INET6\))2 F 520.216 289 213.84 289 DL F3
(dotted decimal)219.84 297 Q(err)291.416 297 Q(or:)-.144 E F4(EAI_ADDRFAMILY)2
E(AF_INET6)153.376 265 Q 520.216 301 147.376 301 DL F3(all A r)291.416 309 Q
(ecor)-.144 E(ds r)-.144 E(eturned)-.144 E F4(gethostbyname\(\))401.016 309 Q
F3(as)299.416 319 Q F4(sockaddr_in{})2 E F3 34.416(sw)C(ith)415.688 319 Q F4
(RES_USE_INET6)2 E F3(of)2 E(f)-.144 E(hostname)219.84 314 Q 520.216 323 213.84
323 DL(hex string)219.84 331 Q(err)291.416 331 Q(or:)-.144 E F4(EAI_ADDRFAMILY)
2 E 520.216 335 213.84 335 DL F3(dotted decimal)219.84 343 Q(one)291.416 343 Q
F4 27.544(sockaddr_in{} inet_pton\(AF_INET\))2 F(AF_INET)153.376 326 Q F3
(nonnull)105.8 230 Q(hostname)105.8 240 Q(string;)105.8 250 Q(active or)105.8
260 Q(passive)105.8 270 Q 520.216 347 100.8 347 DL 520.216 349 100.8 349 DL
(implied 0)219.84 357 Q 24.67 .666(::0 o).666 H(ne)-.666 E F4(sockaddr_in6{})2
E F3(and)2 E F4(inet_pton\(AF_INET6\))401.016 357 Q F3(implied 0.0.0.0)219.84
367 Q(one)291.416 367 Q F4 27.544(sockaddr_in{} inet_pton\(AF_INET\))2 F
(AF_UNSPEC)153.376 362 Q 520.216 371 147.376 371 DL(AF_INET6)153.376 379 Q F3
(implied 0)219.84 379 Q 24.67 .666(::0 o).666 H(ne)-.666 E F4 22.744
(sockaddr_in6{} inet_pton\(AF_INET6\))2 F 520.216 383 147.376 383 DL(AF_INET)
153.376 391 Q F3(implied 0.0.0.0)219.84 391 Q(one)291.416 391 Q F4 27.544
(sockaddr_in{} inet_pton\(AF_INET\))2 F F3(null)105.8 359 Q(hostname)105.8 369
Q(string;)105.8 379 Q(passive)105.8 389 Q 520.216 395 100.8 395 DL 520.216 397
100.8 397 DL(implied 0)219.84 405 Q 24.67 .666(::1 o).666 H(ne)-.666 E F4
(sockaddr_in6{})2 E F3(and)2 E F4(inet_pton\(AF_INET6\))401.016 405 Q F3
(implied 127.0.0.1)219.84 415 Q(one)291.416 415 Q F4 27.544
(sockaddr_in{} inet_pton\(AF_INET\))2 F(AF_UNSPEC)153.376 410 Q 520.216 419
147.376 419 DL(AF_INET6)153.376 427 Q F3(implied 0)219.84 427 Q 24.67 .666
(::1 o).666 H(ne)-.666 E F4 22.744(sockaddr_in6{} inet_pton\(AF_INET6\))2 F
520.216 431 147.376 431 DL(AF_INET)153.376 439 Q F3(implied 127.0.0.1)219.84
439 Q(one)291.416 439 Q F4 27.544(sockaddr_in{} inet_pton\(AF_INET\))2 F F3
(null)105.8 407 Q(hostname)105.8 417 Q(string;)105.8 427 Q(active)105.8 437 Q
520.216 443 100.8 443 DL 395.016 115 395.016 443 DL 285.416 115 285.416 443 DL
213.84 115 213.84 443 DL 147.376 115 147.376 443 DL 520.216 115 520.216 443 DL
100.8 115 100.8 443 DL/F6 8/Palatino-Bold@0 SF(Figure 1)204.816 461 Q(1.4)-.296
E F3(Summary of)6 E F4(getaddrinfo)2 E F3(and its actions and r)2 E(esults.)
-.144 E/F7 10/Palatino-Roman@0 SF .038(Note 1 is that when the two DNS sear)
147.6 487.4 R .037(ches ar)-.18 F 2.537(ep)-.18 G .037
(erformed, either can fail \(i.e., \214nd no)357.948 487.4 R -.18(re)129.6
499.4 S(cor).18 E .375(ds of the desir)-.18 F .375
(ed type for the hostname\) but at least one must succeed.)-.18 F .375
(But if both)5.375 F(sear)129.6 511.4 Q 1.798
(ches succeed \(the hostname has both AAAA and A r)-.18 F(ecor)-.18 E 1.797
(ds\), then both types of)-.18 F(socket addr)129.6 523.4 Q(ess str)-.18 E
(uctur)-.08 E(es ar)-.18 E 2.5(er)-.18 G(eturned.)262.87 523.4 Q .694
(Note 2 is that this DNS sear)147.6 535.4 R .694(ch must succeed, or an err)
-.18 F .695(or is r)-.18 F 3.195(eturned. But)-.18 F .695(since the)3.195 F/F8
10/Courier@0 SF(RES_USE_INET6)129.6 547.4 Q F7 .154(option is enabled,)2.654 F
F8(gethostbyname)2.654 E F7 .154(\214rst looks for the AAAA r)2.654 F(ecor)-.18
E(ds,)-.18 E(and if nothing is found, then looks for A r)129.6 559.4 Q(ecor)
-.18 E(ds \(Figur)-.18 E 2.5(e9)-.18 G(.6\).)384.69 559.4 Q .647
(The setting and clearing of the r)147.6 571.4 R -1.76(esolver 's)-.18 F F8
(RES_USE_INET6)3.147 E F7 .648(option with the scenar)3.147 F(-)-.18 E
(ios in notes 1 and 2 is to for)129.6 583.4 Q(ce the desir)-.18 E(ed DNS sear)
-.18 E(ch, given the r)-.18 E(ules in Figur)-.08 E 2.5(e9)-.18 G(.5.)485.34
583.4 Q 2.575 -.92(We n)147.6 595.4 T .735(ote that Figur).92 F 3.234(e1)-.18 G
.734(1.4 speci\214es only how)244.148 595.4 R F8(getaddrinfo)3.234 E F7 .734
(handles IPv4 and IPv6;)3.234 F .187(that is, the number of addr)129.6 607.4 R
.187(esses r)-.18 F .187(eturned to the caller)-.18 F 5.187(.T)-.74 G .187
(he actual number of)379.86 607.4 R F8(addrinfo)2.688 E F7(str)129.6 619.4 Q
(uctur)-.08 E .835(es r)-.18 F .835
(eturned to the caller also depends on the socket type speci\214ed and the ser)
-.18 F(-)-.18 E(vice name, as summarized earlier in Figur)129.6 631.4 Q 2.5(e1)
-.18 G(1.2.)326.86 631.4 Q/F9 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 282 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(282)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF 3.34(Posix.1g says nothing speci\214c about)147.6 123 R
/F3 10/Courier@0 SF(getaddrinfo)5.84 E F2 3.34(and Unix domain sockets)5.84 F
1.82(\(which we describe in detail in Chapter 14\).)129.6 135 R 1.82
(Nevertheless, adding support for Unix)6.82 F .826
(domain sockets to our implementation of)129.6 147 R F3(getaddrinfo)3.326 E F2
.826(and testing applications with)3.326 F(these pr)129.6 159 Q
(otocols is a good test for pr)-.18 E(otocol independence.)-.18 E .014
(Our implementation makes the following assumption: if the hostname ar)147.6
171 R .014(gument for)-.18 F F3(getaddrinfo)129.6 183 Q F2 .986(is either)3.486
F F3(/local)3.486 E F2(or)3.486 E F3(/unix)3.486 E F2 .986
(and the service name ar)3.486 F .987(gument is an abso-)-.18 F 3.207
(lute pathname \(one that begins with a slash\), Unix domain socket str)129.6
195 R(uctur)-.08 E 3.206(es ar)-.18 F(e)-.18 E -.18(re)129.6 207 S 3.658
(turned. V).18 F 1.158
(alid DNS hostnames cannot contain a slash and no existing IANA service)-.92 F
.037(names begin with a slash \(Exer)129.6 219 R .037(cise 1)-.18 F 2.537
(1.5\). The)-.55 F .036(socket addr)2.537 F .036(ess str)-.18 F(uctur)-.08 E
.036(es r)-.18 F .036(eturned contain)-.18 F .59(this absolute pathname, r)
129.6 231 R .59(eady for a call to either)-.18 F F3(bind)3.09 E F2(or)3.09 E F3
(connect)3.09 E F2 5.59(.I)C 3.09(ft)443.41 231 S .59(he caller speci-)453.09
231 R .895(\214es the)129.6 243 R F3(AI_CANONNAME)3.395 E F2 .895
(\215ag, the host's name \(Section 9.7\) is r)3.395 F .894
(eturned as the canonical)-.18 F(name.)129.6 255 Q/F4 12/Helvetica-Bold@0 SF
(11.6)93.6 291 Q/F5 12/Courier-Bold@0 SF(getaddrinfo)129.6 291 Q F4 3.336
(Function: Examples)6.672 F F2 2.857 -.92(We w)129.6 315 T 1.017
(ill now show some examples of).92 F F3(getaddrinfo)3.517 E F2 1.017
(using a test pr)3.517 F 1.018(ogram that lets us)-.18 F 1.008
(enter all the parameters: the hostname, service name, addr)129.6 327 R 1.007
(ess family)-.18 F 3.507(,s)-1.11 G 1.007(ocket type, and)450.026 327 R(the)
129.6 339 Q F3(AI_CANONNAME)2.766 E F2(and)2.766 E F3(AI_PASSIVE)2.766 E F2
2.766(\215ags. \(W)2.766 F 2.766(ed)-.92 G 2.766(on)358.186 339 S .267
(ot show this test pr)372.232 339 R .267(ogram, as it is)-.18 F .57
(about 350 lines of uninter)129.6 351 R .57(esting code.)-.18 F .569(It is pr)
5.569 F .569(ovided with the sour)-.18 F .569(ce code for the book,)-.18 F
2.166(as described in the Pr)129.6 363 R 4.667(eface.\) The)-.18 F 2.167
(test pr)4.667 F 2.167(ogram outputs information on the variable)-.18 F .683
(number of)129.6 375 R F3(addrinfo)3.183 E F2(str)3.183 E(uctur)-.08 E .683
(es that ar)-.18 F 3.182(er)-.18 G .682(eturned, showing the ar)319.036 375 R
.682(guments for a call to)-.18 F F3(socket)129.6 387 Q F2(and the addr)2.5 E
(ess in each socket addr)-.18 E(ess str)-.18 E(uctur)-.08 E(e.)-.18 E 1.84 -.92
(We \214)147.6 399 T(rst show the same example as in Figur).92 E 2.5(e1)-.18 G
(1.1.)350.59 399 Q/F6 8.15/Courier@0 SF(solaris %)147.6 415 Q/F7 8.15
/Courier-Bold@0 SF 4.89(testga -f)4.89 F 4.89(inet -c -h)4.89 F 4.89(bsdi -s)
4.89 F(domain)4.89 E F6
(socket\(AF_INET, SOCK_STREAM, 0\), ai_canonname = bsdi.kohala.com)147.6 432 Q
(address: 206.62.226.35.53)186.72 442 Q(socket\(AF_INET, SOCK_DGRAM, 0\))147.6
459 Q(address: 206.62.226.35.53)186.72 469 Q(socket\(AF_INET, SOCK_STREAM, 0\))
147.6 486 Q(address: 206.62.226.66.53)186.72 496 Q
(socket\(AF_INET, SOCK_DGRAM, 0\))147.6 513 Q(address: 206.62.226.66.53)186.72
523 Q F2(The)129.6 541 Q F3 -2.942(-f inet)3.058 F F2 .558
(option speci\214es the addr)3.058 F .559(ess family)-.18 F(,)-1.11 E F3(-c)
3.059 E F2 .559(says to r)3.059 F .559(eturn the canonical name,)-.18 F F3 -3.5
(-h bsdi)129.6 553 R F2(speci\214es the hostname, and)2.5 E F3 -3.5(-s domain)
2.5 F F2(speci\214es the service name.)2.5 E .36
(The common client scenario is to specify the addr)147.6 565 R .359(ess family)
-.18 F 2.859(,t)-1.11 G .359(he socket type \(the)420.984 565 R F3(-t)2.859 E
F2 .819(option\), the hostname, and the service name.)129.6 577 R .819
(The following example shows this, for a)5.819 F
(multihomed host with six IPv4 addr)129.6 589 Q(esses.)-.18 E F6(solaris %)
147.6 605 Q F7 4.89(testga -f)4.89 F 4.89(inet -t)4.89 F 4.89(stream -h)4.89 F
4.89(gateway.tuc.noao.edu -s)4.89 F(daytime)4.89 E F6
(socket\(AF_INET, SOCK_STREAM, 0\))147.6 621 Q(address: 140.252.101.4.13)186.72
631 Q(socket\(AF_INET, SOCK_STREAM, 0\))147.6 647 Q(address: 140.252.102.1.13)
186.72 657 Q/F8 7/Palatino-Roman@0 SF 1.75<a943>233.453 676 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 283 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.6)-.495 E/F1 9/Courier@0 SF
(getaddrinfo)343.335 82 Q F0 2.25(Function: Examples)4.5 F/F2 9/Palatino-Bold@0
SF(283)506.1 82 Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6
89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2
111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2
123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2
135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2
147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2
159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2
171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2
183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2
195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2
207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2
219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2
231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2
243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2
255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2
267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2
279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2
291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2
303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2
315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2
327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2
339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2
351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2
363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2
375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2
387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2
399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2
411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2
423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2
435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2
447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2
459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2
471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2
483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2
495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2
507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 8.15
/Courier@0 SF(socket\(AF_INET, SOCK_STREAM, 0\))147.6 121 Q
(address: 140.252.104.1.13)186.72 131 Q(socket\(AF_INET, SOCK_STREAM, 0\))147.6
148 Q(address: 140.252.3.6.13)186.72 158 Q(socket\(AF_INET, SOCK_STREAM, 0\))
147.6 175 Q(address: 140.252.4.100.13)186.72 185 Q
(socket\(AF_INET, SOCK_STREAM, 0\))147.6 202 Q(address: 140.252.1.4.13)186.72
212 Q/F4 10/Palatino-Roman@0 SF .571(Next we specify our host)147.6 230 R/F5 10
/Courier@0 SF(alpha)3.071 E F4 3.071(,w)C .571(hich has both a AAAA r)307.016
230 R(ecor)-.18 E 3.07(da)-.18 G .57(nd an A r)449.02 230 R(ecor)-.18 E(d,)-.18
E .248(without specifying the addr)129.6 242 R .248(ess family)-.18 F 2.748(,a)
-1.11 G .249(nd a service name of)307.05 242 R F5(ftp)2.749 E F4 2.749(,w)C
.249(hich is pr)433.313 242 R .249(ovided by)-.18 F(TCP only)129.6 254 Q(.)
-1.11 E F3(solaris %)147.6 270 Q/F6 8.15/Courier-Bold@0 SF 4.89(testga -h)4.89
F 4.89(alpha -s)4.89 F(ftp)4.89 E F3(socket\(AF_INET6, SOCK_STREAM, 0\))147.6
287 Q(address: 5f1b:df00:ce3e:e200:20:800:2b37:6426.21)186.72 297 Q
(socket\(AF_INET, SOCK_STREAM, 0\))147.6 314 Q(address: 206.62.226.42.21)186.72
324 Q F4 1.178(Since we did not specify the addr)129.6 342 R 1.178(ess family)
-.18 F 3.678(,a)-1.11 G 1.177(nd since we ran this example on a host)339.374
342 R .41(that supports both IPv4 and IPv6, two str)129.6 354 R(uctur)-.08 E
.411(es ar)-.18 F 2.911(er)-.18 G .411(eturned: one for IPv6 and one for)
370.274 354 R(IPv4.)129.6 366 Q 1.28(Next we specify the)147.6 378 R F5
(AI_PASSIVE)3.78 E F4 1.28(\215ag \(the)3.78 F F5(-p)3.78 E F4 1.28
(option\), do not specify an addr)3.78 F(ess)-.18 E(family)129.6 390 Q 2.93(,d)
-1.11 G 2.93(on)168.57 390 S .431(ot specify a hostname \(implying the wildcar)
182.78 390 R 2.931(da)-.18 G(ddr)393.816 390 Q .431(ess\), specify a port num-)
-.18 F(ber of 8888, and do not specify a socket type.)129.6 402 Q F3(solaris %)
147.6 418 Q F6 4.89(testga -p -s)4.89 F(8888)4.89 E F3
(socket\(AF_INET6, SOCK_STREAM, 0\))147.6 436 Q(address: ::.8888)186.72 446 Q
(socket\(AF_INET6, SOCK_DGRAM, 0\))147.6 464 Q(address: ::.8888)186.72 474 Q
(socket\(AF_INET, SOCK_STREAM, 0\))147.6 492 Q(address: 0.0.0.0.8888)186.72 502
Q(socket\(AF_INET, SOCK_DGRAM, 0\))147.6 520 Q(address: 0.0.0.0.8888)186.72 530
Q F4 .8(Four str)129.6 548 R(uctur)-.08 E .8(es ar)-.18 F 3.3(er)-.18 G 3.3
(eturned. Since)221.76 548 R .8
(we ran this on a host that supports IPv6 and IPv4,)3.3 F .37
(without specifying an addr)129.6 560 R .37(ess family)-.18 F(,)-1.11 E F5
(getaddrinfo)2.87 E F4 -.18(re)2.87 G .37(turns the IPv6 wildcar).18 F 2.87(da)
-.18 G(ddr)490.34 560 Q(ess)-.18 E .074(and the IPv4 wildcar)129.6 572 R 2.574
(da)-.18 G(ddr)235.346 572 Q 2.574(ess. Since)-.18 F .073
(we speci\214ed a port number without a socket type,)2.574 F F5(getaddrinfo)
129.6 584 Q F4 -.18(re)2.572 G .072(turns one str).18 F(uctur)-.08 E 2.573(ef)
-.18 G .073(or each addr)296.839 584 R .073(ess specifying TCP and another str)
-.18 F(uc-)-.08 E(tur)129.6 596 Q 3.297(ef)-.18 G .797(or each addr)154.077 596
R .796(ess specifying UDP)-.18 F 5.796(.T)-1.29 G .796(he two IPv6 str)311.248
596 R(uctur)-.08 E .796(es ar)-.18 F 3.296(er)-.18 G .796(eturned befor)436.718
596 R 3.296(et)-.18 G(he)508.99 596 Q 1.303(two IPv4 str)129.6 608 R(uctur)-.08
E 1.304(es, because we saw in Chapter 10 that an IPv6 client or server on a)
-.18 F(dual-stack host can communicate with either IPv6 or IPv4 peers.)129.6
620 Q 1.263(As an example of Unix domain sockets, we specify)147.6 644 R F5
(/local)3.763 E F4 1.263(as the hostname and)3.763 F F5(/tmp/test.1)129.6 656 Q
F4(as the service name.)2.5 E/F7 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 284 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(284)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
8.15/Courier@0 SF(solaris %)147.6 121 Q/F3 8.15/Courier-Bold@0 SF 4.89
(testga -c -p -h)4.89 F 4.89(/local -s)4.89 F(/tmp/test.1)4.89 E F2
(socket\(AF_LOCAL, SOCK_STREAM, 0\), ai_canonname = solaris.kohala.com)147.6
138 Q(address: /tmp/test.1)186.72 148 Q(socket\(AF_LOCAL, SOCK_DGRAM, 0\))147.6
165 Q(address: /tmp/test.1)186.72 175 Q/F4 10/Palatino-Roman@0 SF 2.023
(Since we do not specify the socket type, two str)129.6 193 R(uctur)-.08 E
2.023(es ar)-.18 F 4.524(er)-.18 G 2.024(eturned: the \214rst for a)415.144 193
R(str)129.6 205 Q(eam socket and the second for a datagram socket.)-.18 E/F5 12
/Helvetica-Bold@0 SF(11.7)93.6 249.4 Q/F6 12/Courier-Bold@0 SF(host_serv)129.6
249.4 Q F5(Function)6.672 E F4 .52(Our \214rst interface to)129.6 273.4 R/F7 10
/Courier@0 SF(getaddrinfo)3.02 E F4 .519(does not r)3.019 F(equir)-.18 E 3.019
(et)-.18 G .519(he caller to allocate a hints str)372.166 273.4 R(uc-)-.08 E
(tur)129.6 285.4 Q 3.373(ea)-.18 G .873(nd \214ll it in.)155.823 285.4 R .874
(Instead, the two \214elds of inter)5.874 F .874(est, the addr)-.18 F .874
(ess family and the socket)-.18 F(type, ar)129.6 297.4 Q 2.5(ea)-.18 G -.18(rg)
175.28 297.4 S(uments to our).18 E F7(host_serv)2.5 E F4(function.)2.5 E F2
(#include "unp.h")147.6 319.4 Q(struct addrinfo *host_serv\(const char *)147.6
339.4 Q/F8 8.15/Palatino-Italic@0 SF(hostname)A F2 4.89(,c)C(onst char *)
384.219 339.4 Q F8(service)A F2(,)A(int)279.63 349.4 Q F8(family)4.89 E F2 4.89
(,i)C(nt)334.693 349.4 Q F8(socktype)4.89 E F2(\);)A/F9 8.15/Palatino-Roman@0
SF(Returns: pointer to)282.002 369.4 Q F2(addrinfo)2.038 E F9(str)2.038 E
(uctur)-.065 E 2.038(ei)-.147 G 2.038(fO)429.756 369.4 S(K,)440.914 369.4 Q F2
(NULL)2.038 E F9(on err)2.038 E(or)-.147 E 129.6 373.475 EBEGIN
0 66300 u neg rlineto 390000 u 0 rlineto 0 66300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 373.475 EBEGIN
0 -3.6 rlineto 0 59100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 59100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 10/Palatino-Roman@0 SF(Figur)129.6 393.4 Q 2.5(e1)-.18 G
(1.5 shows the sour)165.17 393.4 Q(ce code for this function.)-.18 E .4 LW
134.6 406.6 129.6 406.6 DL 135.6 406.6 130.6 406.6 DL 140.6 406.6 135.6 406.6
DL 145.6 406.6 140.6 406.6 DL 150.6 406.6 145.6 406.6 DL 155.6 406.6 150.6
406.6 DL 160.6 406.6 155.6 406.6 DL 165.6 406.6 160.6 406.6 DL 170.6 406.6
165.6 406.6 DL 175.6 406.6 170.6 406.6 DL 180.6 406.6 175.6 406.6 DL 185.6
406.6 180.6 406.6 DL 190.6 406.6 185.6 406.6 DL 195.6 406.6 190.6 406.6 DL
200.6 406.6 195.6 406.6 DL 205.6 406.6 200.6 406.6 DL 210.6 406.6 205.6 406.6
DL 215.6 406.6 210.6 406.6 DL 220.6 406.6 215.6 406.6 DL 225.6 406.6 220.6
406.6 DL 230.6 406.6 225.6 406.6 DL 235.6 406.6 230.6 406.6 DL 240.6 406.6
235.6 406.6 DL 245.6 406.6 240.6 406.6 DL 250.6 406.6 245.6 406.6 DL 255.6
406.6 250.6 406.6 DL 260.6 406.6 255.6 406.6 DL 265.6 406.6 260.6 406.6 DL
270.6 406.6 265.6 406.6 DL 275.6 406.6 270.6 406.6 DL 280.6 406.6 275.6 406.6
DL 285.6 406.6 280.6 406.6 DL 290.6 406.6 285.6 406.6 DL 295.6 406.6 290.6
406.6 DL 300.6 406.6 295.6 406.6 DL 305.6 406.6 300.6 406.6 DL 310.6 406.6
305.6 406.6 DL 315.6 406.6 310.6 406.6 DL 320.6 406.6 315.6 406.6 DL 325.6
406.6 320.6 406.6 DL 330.6 406.6 325.6 406.6 DL 335.6 406.6 330.6 406.6 DL
340.6 406.6 335.6 406.6 DL 345.6 406.6 340.6 406.6 DL 350.6 406.6 345.6 406.6
DL 355.6 406.6 350.6 406.6 DL 360.6 406.6 355.6 406.6 DL 365.6 406.6 360.6
406.6 DL 370.6 406.6 365.6 406.6 DL 375.6 406.6 370.6 406.6 DL 380.6 406.6
375.6 406.6 DL 385.6 406.6 380.6 406.6 DL 390.6 406.6 385.6 406.6 DL 395.6
406.6 390.6 406.6 DL 400.6 406.6 395.6 406.6 DL 405.6 406.6 400.6 406.6 DL
410.6 406.6 405.6 406.6 DL 415.6 406.6 410.6 406.6 DL 420.6 406.6 415.6 406.6
DL 425.6 406.6 420.6 406.6 DL 430.6 406.6 425.6 406.6 DL 435.6 406.6 430.6
406.6 DL 440.6 406.6 435.6 406.6 DL 445.6 406.6 440.6 406.6 DL 450.6 406.6
445.6 406.6 DL 455.6 406.6 450.6 406.6 DL 460.6 406.6 455.6 406.6 DL 465.6
406.6 460.6 406.6 DL/F1 9/Palatino-Italic@0 SF(lib/host_serv)467.85 409.1 Q(.c)
-.495 E/F2 8.15/Courier@0 SF 4.89(1#)139.38 415.401 S 14.67(include "unp.h")
154.05 415.401 R 4.89(2s)139.38 433.401 S(truct addrinfo *)154.05 433.401 Q
4.89(3h)139.38 443.401 S
(ost_serv\(const char *host, const char *serv, int family, int socktype\))
154.05 443.401 Q 4.89(4{)139.38 453.401 S 24.45(5i)139.38 463.401 S 19.56
(nt n;)173.61 463.401 R 24.45(6s)139.38 473.401 S(truct addrinfo hints, *res;)
173.61 473.401 Q 24.45(7b)139.38 491.401 S
(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 491.401 Q 24.45(8h)139.38
501.401 S(ints.ai_flags = AI_CANONNAME;)173.61 501.401 Q
(/* always return canonical name */)9.78 E 24.45(9h)139.38 511.401 S
(ints.ai_family = family;)173.61 511.401 Q
(/* AF_UNSPEC, AF_INET, AF_INET6, etc. */)305.64 511.401 Q 19.56
(10 hints.ai_socktype)134.49 521.401 R 4.89(=s)4.89 G 9.78(ocktype; /*)271.41
521.401 R(0, SOCK_STREAM, SOCK_DGRAM, etc. */)4.89 E 19.56(11 if)134.49 539.401
R 4.89(\(\()4.89 G 4.89(n=g)198.06 539.401 S
(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 539.401 Q 39.12
(12 return)134.49 549.401 R(\(NULL\);)4.89 E 19.56(13 return)134.49 567.401 R
68.46(\(res\); /*)4.89 F(return pointer to first on linked list */)4.89 E(14 })
134.49 577.401 Q 134.6 582.202 129.6 582.202 DL 135.6 582.202 130.6 582.202 DL
140.6 582.202 135.6 582.202 DL 145.6 582.202 140.6 582.202 DL 150.6 582.202
145.6 582.202 DL 155.6 582.202 150.6 582.202 DL 160.6 582.202 155.6 582.202 DL
165.6 582.202 160.6 582.202 DL 170.6 582.202 165.6 582.202 DL 175.6 582.202
170.6 582.202 DL 180.6 582.202 175.6 582.202 DL 185.6 582.202 180.6 582.202 DL
190.6 582.202 185.6 582.202 DL 195.6 582.202 190.6 582.202 DL 200.6 582.202
195.6 582.202 DL 205.6 582.202 200.6 582.202 DL 210.6 582.202 205.6 582.202 DL
215.6 582.202 210.6 582.202 DL 220.6 582.202 215.6 582.202 DL 225.6 582.202
220.6 582.202 DL 230.6 582.202 225.6 582.202 DL 235.6 582.202 230.6 582.202 DL
240.6 582.202 235.6 582.202 DL 245.6 582.202 240.6 582.202 DL 250.6 582.202
245.6 582.202 DL 255.6 582.202 250.6 582.202 DL 260.6 582.202 255.6 582.202 DL
265.6 582.202 260.6 582.202 DL 270.6 582.202 265.6 582.202 DL 275.6 582.202
270.6 582.202 DL 280.6 582.202 275.6 582.202 DL 285.6 582.202 280.6 582.202 DL
290.6 582.202 285.6 582.202 DL 295.6 582.202 290.6 582.202 DL 300.6 582.202
295.6 582.202 DL 305.6 582.202 300.6 582.202 DL 310.6 582.202 305.6 582.202 DL
315.6 582.202 310.6 582.202 DL 320.6 582.202 315.6 582.202 DL 325.6 582.202
320.6 582.202 DL 330.6 582.202 325.6 582.202 DL 335.6 582.202 330.6 582.202 DL
340.6 582.202 335.6 582.202 DL 345.6 582.202 340.6 582.202 DL 350.6 582.202
345.6 582.202 DL 355.6 582.202 350.6 582.202 DL 360.6 582.202 355.6 582.202 DL
365.6 582.202 360.6 582.202 DL 370.6 582.202 365.6 582.202 DL 375.6 582.202
370.6 582.202 DL 380.6 582.202 375.6 582.202 DL 385.6 582.202 380.6 582.202 DL
390.6 582.202 385.6 582.202 DL 395.6 582.202 390.6 582.202 DL 400.6 582.202
395.6 582.202 DL 405.6 582.202 400.6 582.202 DL 410.6 582.202 405.6 582.202 DL
415.6 582.202 410.6 582.202 DL 420.6 582.202 415.6 582.202 DL 425.6 582.202
420.6 582.202 DL 430.6 582.202 425.6 582.202 DL 435.6 582.202 430.6 582.202 DL
440.6 582.202 435.6 582.202 DL 445.6 582.202 440.6 582.202 DL 450.6 582.202
445.6 582.202 DL 455.6 582.202 450.6 582.202 DL 460.6 582.202 455.6 582.202 DL
465.6 582.202 460.6 582.202 DL F1(lib/host_serv)467.85 584.702 Q(.c)-.495 E/F3
8/Palatino-Bold@0 SF(Figure 1)263.54 598.202 Q(1.5)-.296 E/F4 8/Courier@0 SF
(host_serv)6 E/F5 8/Palatino-Roman@0 SF(function.)2 E/F6 7/Courier-Oblique@0 SF
(7\21113)108.48 622.202 Q F0 1.758(The function initializes a hints str)147.6
622.202 R(uctur)-.08 E 1.757(e, calls)-.18 F/F7 10/Courier@0 SF(getaddrinfo)
4.257 E F0 4.257(,a)C 1.757(nd r)440.369 622.202 R 1.757(eturns a null)-.18 F
(pointer if an err)129.6 634.202 Q(or occurs.)-.18 E 3.82 -.92(We c)147.6
646.202 T 1.98(all this function fr).92 F 1.98(om Figur)-.18 F 4.48(e1)-.18 G
1.98(5.17 when we want to use)311.92 646.202 R F7(getaddrinfo)4.48 E F0(to)4.48
E .064(obtain the host and service information, but we want to establish the c\
onnection ourself.)129.6 658.202 R/F8 7/Palatino-Roman@0 SF 1.75<a943>233.453
678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 285 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.8)-.495 E/F1 9/Courier@0 SF
(tcp_connect)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(285)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 12/Helvetica-Bold@0 SF
(11.8)93.6 123 Q/F4 12/Courier-Bold@0 SF(tcp_connect)129.6 123 Q F3(Function)
6.672 E/F5 10/Palatino-Roman@0 SF 3.037 -.92(We n)129.6 147 T 1.197
(ow write two functions that use).92 F/F6 10/Courier@0 SF(getaddrinfo)3.698 E
F5 1.198(to handle most scenarios for the)3.698 F .698
(TCP clients and servers that we write.)129.6 159 R .697(The \214rst function,)
5.697 F F6(tcp_connect)3.197 E F5 3.197(,p)C .697(erforms the)467.983 159 R
(normal client steps: cr)129.6 171 Q(eate a TCP socket and connect to a server)
-.18 E(.)-.74 E/F7 8.15/Courier@0 SF(#include "unp.h")147.6 193 Q
(int tcp_connect\(const char *)147.6 213 Q/F8 8.15/Palatino-Italic@0 SF
(hostname)A F7 4.89(,c)C(onst char *)330.429 213 Q F8(service)A F7(\);)A/F9
8.15/Palatino-Roman@0 SF(Returns: connected socket descriptor if OK, no r)
278.667 233 Q(eturn on err)-.147 E(or)-.147 E 129.6 237.075 EBEGIN
0 56300 u neg rlineto 390000 u 0 rlineto 0 56300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 237.075 EBEGIN
0 -3.6 rlineto 0 49100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 49100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 10/Palatino-Roman@0 SF(Figur)129.6 257 Q 2.5(e1)-.18 G
(1.6 shows the sour)165.17 257 Q(ce code.)-.18 E .4 LW 134.6 270.2 129.6 270.2
DL 136.114 270.2 131.114 270.2 DL 141.114 270.2 136.114 270.2 DL 146.114 270.2
141.114 270.2 DL 151.114 270.2 146.114 270.2 DL 156.114 270.2 151.114 270.2 DL
161.114 270.2 156.114 270.2 DL 166.114 270.2 161.114 270.2 DL 171.114 270.2
166.114 270.2 DL 176.114 270.2 171.114 270.2 DL 181.114 270.2 176.114 270.2 DL
186.114 270.2 181.114 270.2 DL 191.114 270.2 186.114 270.2 DL 196.114 270.2
191.114 270.2 DL 201.114 270.2 196.114 270.2 DL 206.114 270.2 201.114 270.2 DL
211.114 270.2 206.114 270.2 DL 216.114 270.2 211.114 270.2 DL 221.114 270.2
216.114 270.2 DL 226.114 270.2 221.114 270.2 DL 231.114 270.2 226.114 270.2 DL
236.114 270.2 231.114 270.2 DL 241.114 270.2 236.114 270.2 DL 246.114 270.2
241.114 270.2 DL 251.114 270.2 246.114 270.2 DL 256.114 270.2 251.114 270.2 DL
261.114 270.2 256.114 270.2 DL 266.114 270.2 261.114 270.2 DL 271.114 270.2
266.114 270.2 DL 276.114 270.2 271.114 270.2 DL 281.114 270.2 276.114 270.2 DL
286.114 270.2 281.114 270.2 DL 291.114 270.2 286.114 270.2 DL 296.114 270.2
291.114 270.2 DL 301.114 270.2 296.114 270.2 DL 306.114 270.2 301.114 270.2 DL
311.114 270.2 306.114 270.2 DL 316.114 270.2 311.114 270.2 DL 321.114 270.2
316.114 270.2 DL 326.114 270.2 321.114 270.2 DL 331.114 270.2 326.114 270.2 DL
336.114 270.2 331.114 270.2 DL 341.114 270.2 336.114 270.2 DL 346.114 270.2
341.114 270.2 DL 351.114 270.2 346.114 270.2 DL 356.114 270.2 351.114 270.2 DL
361.114 270.2 356.114 270.2 DL 366.114 270.2 361.114 270.2 DL 371.114 270.2
366.114 270.2 DL 376.114 270.2 371.114 270.2 DL 381.114 270.2 376.114 270.2 DL
386.114 270.2 381.114 270.2 DL 391.114 270.2 386.114 270.2 DL 396.114 270.2
391.114 270.2 DL 401.114 270.2 396.114 270.2 DL 406.114 270.2 401.114 270.2 DL
411.114 270.2 406.114 270.2 DL 416.114 270.2 411.114 270.2 DL 421.114 270.2
416.114 270.2 DL 426.114 270.2 421.114 270.2 DL 431.114 270.2 426.114 270.2 DL
436.114 270.2 431.114 270.2 DL 441.114 270.2 436.114 270.2 DL 446.114 270.2
441.114 270.2 DL 451.114 270.2 446.114 270.2 DL 456.114 270.2 451.114 270.2 DL
/F1 9/Palatino-Italic@0 SF(lib/tcp_connect.c)458.364 272.7 Q/F2 8.15/Courier@0
SF 4.89(1#)139.38 279.001 S 14.67(include "unp.h")154.05 279.001 R 4.89(2i)
139.38 295.001 S(nt)154.05 295.001 Q 4.89(3t)139.38 305.001 S
(cp_connect\(const char *host, const char *serv\))154.05 305.001 Q 4.89(4{)
139.38 315.001 S 24.45(5i)139.38 325.001 S 19.56(nt sockfd,)173.61 325.001 R
(n;)4.89 E 24.45(6s)139.38 335.001 S(truct addrinfo hints, *res, *ressave;)
173.61 335.001 Q 24.45(7b)139.38 351.001 S
(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 351.001 Q 24.45(8h)139.38
361.001 S(ints.ai_family = AF_UNSPEC;)173.61 361.001 Q 24.45(9h)139.38 371.001
S(ints.ai_socktype = SOCK_STREAM;)173.61 371.001 Q 19.56(10 if)134.49 387.001 R
4.89(\(\()4.89 G 4.89(n=g)198.06 387.001 S
(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 387.001 Q 39.12
(11 err_quit\("tcp_connect)134.49 397.001 R(error for %s, %s: %s",)4.89 E 83.13
(12 host,)134.49 407.001 R(serv, gai_strerror\(n\)\);)4.89 E 19.56(13 ressave)
134.49 417.001 R 4.89(=r)4.89 G(es;)222.51 417.001 Q 19.56(14 do)134.49 433.001
R({)4.89 E 39.12(15 sockfd)134.49 443.001 R 4.89(=s)4.89 G
(ocket\(res->ai_family, res->ai_socktype, res->ai_protocol\);)237.18 443.001 Q
39.12(16 if)134.49 453.001 R(\(sockfd < 0\))4.89 E 58.68(17 continue;)134.49
463.001 R(/* ignore this one */)305.64 463.001 Q 39.12(18 if)134.49 479.001 R
(\(connect\(sockfd, res->ai_addr, res->ai_addrlen\) == 0\))4.89 E 58.68
(19 break;)134.49 489.001 R(/* success */)305.64 489.001 Q 39.12
(20 Close\(sockfd\);)134.49 505.001 R(/* ignore this one */)305.64 505.001 Q
19.56(21 })134.49 515.001 R(while \( \(res = res->ai_next\) != NULL\);)4.89 E
19.56(22 if)134.49 531.001 R(\(res == NULL\))4.89 E
(/* errno set from final connect\(\) */)305.64 531.001 Q 39.12
(23 err_sys\("tcp_connect)134.49 541.001 R(error for %s, %s", host, serv\);)
4.89 E 19.56(24 freeaddrinfo\(ressave\);)134.49 557.001 R 19.56(25 return)
134.49 573.001 R(\(sockfd\);)4.89 E(26 })134.49 583.001 Q 134.6 587.802 129.6
587.802 DL 136.114 587.802 131.114 587.802 DL 141.114 587.802 136.114 587.802
DL 146.114 587.802 141.114 587.802 DL 151.114 587.802 146.114 587.802 DL
156.114 587.802 151.114 587.802 DL 161.114 587.802 156.114 587.802 DL 166.114
587.802 161.114 587.802 DL 171.114 587.802 166.114 587.802 DL 176.114 587.802
171.114 587.802 DL 181.114 587.802 176.114 587.802 DL 186.114 587.802 181.114
587.802 DL 191.114 587.802 186.114 587.802 DL 196.114 587.802 191.114 587.802
DL 201.114 587.802 196.114 587.802 DL 206.114 587.802 201.114 587.802 DL
211.114 587.802 206.114 587.802 DL 216.114 587.802 211.114 587.802 DL 221.114
587.802 216.114 587.802 DL 226.114 587.802 221.114 587.802 DL 231.114 587.802
226.114 587.802 DL 236.114 587.802 231.114 587.802 DL 241.114 587.802 236.114
587.802 DL 246.114 587.802 241.114 587.802 DL 251.114 587.802 246.114 587.802
DL 256.114 587.802 251.114 587.802 DL 261.114 587.802 256.114 587.802 DL
266.114 587.802 261.114 587.802 DL 271.114 587.802 266.114 587.802 DL 276.114
587.802 271.114 587.802 DL 281.114 587.802 276.114 587.802 DL 286.114 587.802
281.114 587.802 DL 291.114 587.802 286.114 587.802 DL 296.114 587.802 291.114
587.802 DL 301.114 587.802 296.114 587.802 DL 306.114 587.802 301.114 587.802
DL 311.114 587.802 306.114 587.802 DL 316.114 587.802 311.114 587.802 DL
321.114 587.802 316.114 587.802 DL 326.114 587.802 321.114 587.802 DL 331.114
587.802 326.114 587.802 DL 336.114 587.802 331.114 587.802 DL 341.114 587.802
336.114 587.802 DL 346.114 587.802 341.114 587.802 DL 351.114 587.802 346.114
587.802 DL 356.114 587.802 351.114 587.802 DL 361.114 587.802 356.114 587.802
DL 366.114 587.802 361.114 587.802 DL 371.114 587.802 366.114 587.802 DL
376.114 587.802 371.114 587.802 DL 381.114 587.802 376.114 587.802 DL 386.114
587.802 381.114 587.802 DL 391.114 587.802 386.114 587.802 DL 396.114 587.802
391.114 587.802 DL 401.114 587.802 396.114 587.802 DL 406.114 587.802 401.114
587.802 DL 411.114 587.802 406.114 587.802 DL 416.114 587.802 411.114 587.802
DL 421.114 587.802 416.114 587.802 DL 426.114 587.802 421.114 587.802 DL
431.114 587.802 426.114 587.802 DL 436.114 587.802 431.114 587.802 DL 441.114
587.802 436.114 587.802 DL 446.114 587.802 441.114 587.802 DL 451.114 587.802
446.114 587.802 DL 456.114 587.802 451.114 587.802 DL F1(lib/tcp_connect.c)
458.364 590.302 Q/F3 8/Palatino-Bold@0 SF(Figure 1)207.756 603.802 Q(1.6)-.296
E/F4 8/Courier@0 SF(tcp_connect)6 E/F5 8/Palatino-Roman@0 SF
(function: perform normal client steps.)2 E/F6 9/Helvetica-Bold@0 SF(Call)129.6
631.802 Q/F7 9/Courier-Bold@0 SF(getaddrinfo)2.502 E/F8 7/Courier-Oblique@0 SF
(7\21113)108.48 646.802 Q/F9 10/Courier@0 SF(getaddrinfo)147.6 646.802 Q F0
.333(is called once and we specify the addr)2.833 F .334(ess family as)-.18 F
F9(AF_UNSPEC)2.834 E F0(and)2.834 E(the socket type as)129.6 658.802 Q F9
(SOCK_STREAM)2.5 E F0(.)A/F10 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 286 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(286)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2 9
/Helvetica-Bold@0 SF -.972 -.72(Tr y)129.6 123 T(eac)3.222 E(h)-.09 E/F3 9
/Courier-Bold@0 SF(addrinfo)2.502 E F2(structure until success or end of list)
2.502 E/F4 7/Courier-Oblique@0 SF(14\21125)104.28 138 Q/F5 10/Palatino-Roman@0
SF .508(Each r)147.6 138 R .508(eturned IP addr)-.18 F .508(ess is then tried:)
-.18 F/F6 10/Courier@0 SF(socket)3.007 E F5(and)3.007 E F6(connect)3.007 E F5
(ar)3.007 E 3.007(ec)-.18 G 3.007(alled. It)447.532 138 R .507(is not a)3.007 F
.261(fatal err)129.6 150 R .261(or for)-.18 F F6(socket)2.762 E F5 .262
(to fail, as this could happen if an IPv6 addr)2.762 F .262(ess wer)-.18 F
2.762(er)-.18 G .262(eturned but)467.268 150 R 1.078
(the host kernel does not support IPv6.)129.6 162 R(If)6.078 E F6(connect)3.578
E F5 1.078(succeeds, a)3.578 F F6(break)3.578 E F5 1.078(is made out of)3.578 F
.861(the loop.)129.6 174 R .861(Otherwise, when all the addr)5.861 F .862
(esses have been tried, the loop also terminates.)-.18 F F6(freeaddrinfo)129.6
186 Q F5 -.18(re)2.5 G(turns all the dynamic memory).18 E(.)-1.11 E 4.577
(This function \(and our other functions that pr)147.6 198 R 4.577
(ovide a simpler interface to)-.18 F F6(getaddrinfo)129.6 210 Q F5 1.051
(in the following sections\) terminates if either)3.55 F F6(getaddrinfo)3.551 E
F5 1.051(fails, or if)3.551 F 1.596(no call to)129.6 222 R F6(connect)4.096 E
F5 4.096(succeeds. The)4.096 F 1.596(only r)4.096 F 1.596
(eturn is upon success.)-.18 F 1.596(It would be har)6.596 F 4.096(dt)-.18 G(o)
514.14 222 Q -.18(re)129.6 234 S .555(turn an err).18 F .555
(or code \(one of the)-.18 F F6(EAI_)3.055 E/F7 10/Palatino-Italic@0 SF(xxx)A
F5 .555(constants\) without adding another ar)3.055 F(gument.)-.18 E
(This means that our wrapper function is trivial:)129.6 246 Q/F8 8.15/Courier@0
SF(int)147.6 262 Q(Tcp_connect\(const char *host, const char *serv\))147.6 272
Q({)147.6 282 Q(return\(tcp_connect\(host, serv\)\);)167.16 292 Q(})147.6 302 Q
F5 .645(Nevertheless, we still call our wrapper function, instead of)129.6 320
R F6(tcp_connect)3.144 E F5 3.144(,t)C 3.144(om)471.446 320 S(aintain)488.88
320 Q(consistency with the r)129.6 332 Q(emainder of the text.)-.18 E/F9 8
/Palatino-Roman@0 SF 1.105(The pr)183.6 352 R 1.105(oblem with the r)-.144 F
1.106(eturn value is that descriptors ar)-.144 F 3.106(en)-.144 G 1.106
(onnegative but we do not know)401.43 352 R .574(whether the)183.6 362 R/F10 8
/Courier@0 SF(EAI_)2.574 E/F11 8/Palatino-Italic@0 SF(xxx)A F9 .574(values ar)
2.574 F 2.574(ep)-.144 G .574(ositive or negative.)306.734 362 R .574
(If these values wer)4.574 F 2.573(ep)-.144 G .573(ositive, we could)458.614
362 R -.144(re)183.6 372 S 1.243(turn the negative of these values if).144 F
F10(getaddrinfo)3.243 E F9 1.243(fails, but we also have to r)3.243 F 1.244
(eturn some)-.144 F(other negative value to indicate that all the str)183.6 382
Q(uctur)-.064 E(es wer)-.144 E 2(et)-.144 G(ried without success.)395.848 382 Q
/F12 10/Helvetica-Bold@0 SF(Example: Da)93.6 411 Q(ytime Client)-.2 E F5(Figur)
129.6 435 Q 2.5(e1)-.18 G(1.7 shows our daytime client fr)165.17 435 Q
(om Figur)-.18 E 2.5(e1)-.18 G(.5 r)354.31 435 Q(ecoded to use)-.18 E F6
(tcp_connect)2.5 E F5(.)A F2(Command)129.6 451 Q(-)-.81 I(line ar).81 I
(guments)-.135 E F4(9\21110)108.48 466 Q F5 4.206 -.92(We n)147.6 466 T 2.366
(ow r).92 F(equir)-.18 E 4.866(eas)-.18 G 2.366(econd command)241.454 466 R(-)
-.9 I 2.365(line ar).9 J 2.365(gument to specify either the service)-.18 F
(name or the port number)129.6 478 Q 2.5(,w)-.74 G(hich allows our pr)253.55
478 Q(ogram to connect to other ports.)-.18 E F2(Connect to ser)129.6 494 Q
(ver).09 E F4(11)104.28 509 Q F5
(All of the socket code for this client is now performed by)147.6 509 Q F6
(tcp_connect)2.5 E F5(.)A F2(Print ser)129.6 525 Q(ver').09 E 2.502(sa)-.54 G
-.09(dd)194.184 525 S(ress).09 E F4(12\21115)104.28 540 Q F5 3.262 -.92(We c)
147.6 540 T(all).92 E F6(getpeername)3.922 E F5 1.422(to fetch the server)3.922
F 1.422('s pr).74 F 1.422(otocol addr)-.18 F 1.423(ess and print it.)-.18 F
3.263 -.92(We d)6.423 H(o).92 E(this to verify the pr)129.6 552 Q
(otocol being used in the examples we ar)-.18 E 2.5(ea)-.18 G(bout to show)
403.18 552 Q(.)-.92 E 1.576(Note that)147.6 564 R F6(tcp_connect)4.076 E F5
1.576(does not r)4.076 F 1.576(eturn the size of the socket addr)-.18 F 1.575
(ess str)-.18 F(uctur)-.08 E(e)-.18 E .118(that was used for the)129.6 576 R F6
(connect)2.618 E F5 5.118(.W)C 2.618(ec)284.088 576 S .118
(ould have added a pointer ar)295.936 576 R .118(gument to r)-.18 F .118
(eturn this)-.18 F 1.371(value, but one design goal for this function was to r)
129.6 588 R 1.37(educe the number of ar)-.18 F(guments,)-.18 E(compar)129.6 600
Q .507(ed to)-.18 F F6(getaddrinfo)3.007 E F5 5.507(.W)C .507
(hat we do instead is de\214ne the constant)272.751 600 R F6(MAXSOCKADDR)3.008
E F5 .75(in our)129.6 612 R F6(unp.h)3.25 E F5 .75
(header to be the size of the lar)3.25 F .75(gest socket addr)-.18 F .75
(ess str)-.18 F(uctur)-.08 E 3.25(e. This)-.18 F .75(is nor)3.25 F(-)-.18 E
1.313(mally the size of a Unix domain socket addr)129.6 624 R 1.313(ess str)
-.18 F(uctur)-.08 E 3.813(e\()-.18 G 1.313(Section 14.2\), just over 100)
398.368 624 R 3.082(bytes. W)129.6 636 R 3.082(ea)-.92 G .582(llocate r)183.014
636 R .582(oom for a str)-.18 F(uctur)-.08 E 3.082(eo)-.18 G 3.082(ft)313.604
636 S .582(his size and this is what)323.276 636 R F6(getpeername)3.082 E F5
(\214lls)3.082 E(in.)129.6 648 Q/F13 7/Palatino-Roman@0 SF 1.75<a943>233.453
678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 287 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.8)-.495 E/F1 9/Courier@0 SF
(tcp_connect)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(287)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4 LW 134.6 124.2 129.6 124.2
DL 136.944 124.2 131.944 124.2 DL 141.944 124.2 136.944 124.2 DL 146.944 124.2
141.944 124.2 DL 151.944 124.2 146.944 124.2 DL 156.944 124.2 151.944 124.2 DL
161.944 124.2 156.944 124.2 DL 166.944 124.2 161.944 124.2 DL 171.944 124.2
166.944 124.2 DL 176.944 124.2 171.944 124.2 DL 181.944 124.2 176.944 124.2 DL
186.944 124.2 181.944 124.2 DL 191.944 124.2 186.944 124.2 DL 196.944 124.2
191.944 124.2 DL 201.944 124.2 196.944 124.2 DL 206.944 124.2 201.944 124.2 DL
211.944 124.2 206.944 124.2 DL 216.944 124.2 211.944 124.2 DL 221.944 124.2
216.944 124.2 DL 226.944 124.2 221.944 124.2 DL 231.944 124.2 226.944 124.2 DL
236.944 124.2 231.944 124.2 DL 241.944 124.2 236.944 124.2 DL 246.944 124.2
241.944 124.2 DL 251.944 124.2 246.944 124.2 DL 256.944 124.2 251.944 124.2 DL
261.944 124.2 256.944 124.2 DL 266.944 124.2 261.944 124.2 DL 271.944 124.2
266.944 124.2 DL 276.944 124.2 271.944 124.2 DL 281.944 124.2 276.944 124.2 DL
286.944 124.2 281.944 124.2 DL 291.944 124.2 286.944 124.2 DL 296.944 124.2
291.944 124.2 DL 301.944 124.2 296.944 124.2 DL 306.944 124.2 301.944 124.2 DL
311.944 124.2 306.944 124.2 DL 316.944 124.2 311.944 124.2 DL 321.944 124.2
316.944 124.2 DL 326.944 124.2 321.944 124.2 DL 331.944 124.2 326.944 124.2 DL
336.944 124.2 331.944 124.2 DL 341.944 124.2 336.944 124.2 DL 346.944 124.2
341.944 124.2 DL 351.944 124.2 346.944 124.2 DL 356.944 124.2 351.944 124.2 DL
361.944 124.2 356.944 124.2 DL 366.944 124.2 361.944 124.2 DL 371.944 124.2
366.944 124.2 DL 376.944 124.2 371.944 124.2 DL 381.944 124.2 376.944 124.2 DL
386.944 124.2 381.944 124.2 DL 391.944 124.2 386.944 124.2 DL 396.944 124.2
391.944 124.2 DL 401.944 124.2 396.944 124.2 DL 406.944 124.2 401.944 124.2 DL
411.944 124.2 406.944 124.2 DL 416.944 124.2 411.944 124.2 DL 421.944 124.2
416.944 124.2 DL 426.944 124.2 421.944 124.2 DL 431.944 124.2 426.944 124.2 DL
436.944 124.2 431.944 124.2 DL/F3 9/Palatino-Italic@0 SF(names/daytimetcpcli.c)
439.194 126.7 Q/F4 8.15/Courier@0 SF 4.89(1#)139.38 133.001 S 14.67
(include "unp.h")154.05 133.001 R 4.89(2i)139.38 150.001 S(nt)154.05 150.001 Q
4.89(3m)139.38 160.001 S(ain\(int argc, char **argv\))154.05 160.001 Q 4.89(4{)
139.38 170.001 S 24.45(5i)139.38 180.001 S 19.56(nt sockfd,)173.61 180.001 R
(n;)4.89 E 24.45(6c)139.38 190.001 S 14.67(har recvline[MAXLINE)173.61 190.001
R 4.89(+1)4.89 G(];)305.64 190.001 Q 24.45(7s)139.38 200.001 S(ocklen_t len;)
173.61 200.001 Q 24.45(8s)139.38 210.001 S(truct sockaddr *sa;)173.61 210.001 Q
24.45(9i)139.38 227.001 S 4.89(f\()173.61 227.001 S(argc != 3\))188.28 227.001
Q 39.12(10 err_quit\("usage:)134.49 237.001 R
(daytimetcpcli <hostname/IPaddress> <service/port#>"\);)4.89 E 19.56(11 sockfd)
134.49 254.001 R 4.89(=T)4.89 G(cp_connect\(argv[1], argv[2]\);)217.62 254.001
Q 19.56(12 sa)134.49 271.001 R 4.89(=M)4.89 G(alloc\(MAXSOCKADDR\);)198.06
271.001 Q 19.56(13 len)134.49 281.001 R 4.89(=M)4.89 G(AXSOCKADDR;)202.95
281.001 Q 19.56(14 Getpeername\(sockfd,)134.49 291.001 R(sa, &len\);)4.89 E
19.56(15 printf\("connected)134.49 301.001 R
(to %s\\n", Sock_ntop_host\(sa, len\)\);)4.89 E 19.56(16 while)134.49 318.001 R
4.89(\(\()4.89 G 4.89(n=R)212.73 318.001 S
(ead\(sockfd, recvline, MAXLINE\)\) > 0\) {)237.18 318.001 Q 39.12
(17 recvline[n])134.49 328.001 R 4.89(=0)4.89 G 39.12(;/)261.63 328.001 S 4.89
(*n)310.53 328.001 S(ull terminate */)325.2 328.001 Q 39.12
(18 Fputs\(recvline,)134.49 338.001 R(stdout\);)4.89 E 19.56(19 })134.49
348.001 R 19.56(20 exit\(0\);)134.49 358.001 R(21 })134.49 368.001 Q 134.6
372.802 129.6 372.802 DL 136.944 372.802 131.944 372.802 DL 141.944 372.802
136.944 372.802 DL 146.944 372.802 141.944 372.802 DL 151.944 372.802 146.944
372.802 DL 156.944 372.802 151.944 372.802 DL 161.944 372.802 156.944 372.802
DL 166.944 372.802 161.944 372.802 DL 171.944 372.802 166.944 372.802 DL
176.944 372.802 171.944 372.802 DL 181.944 372.802 176.944 372.802 DL 186.944
372.802 181.944 372.802 DL 191.944 372.802 186.944 372.802 DL 196.944 372.802
191.944 372.802 DL 201.944 372.802 196.944 372.802 DL 206.944 372.802 201.944
372.802 DL 211.944 372.802 206.944 372.802 DL 216.944 372.802 211.944 372.802
DL 221.944 372.802 216.944 372.802 DL 226.944 372.802 221.944 372.802 DL
231.944 372.802 226.944 372.802 DL 236.944 372.802 231.944 372.802 DL 241.944
372.802 236.944 372.802 DL 246.944 372.802 241.944 372.802 DL 251.944 372.802
246.944 372.802 DL 256.944 372.802 251.944 372.802 DL 261.944 372.802 256.944
372.802 DL 266.944 372.802 261.944 372.802 DL 271.944 372.802 266.944 372.802
DL 276.944 372.802 271.944 372.802 DL 281.944 372.802 276.944 372.802 DL
286.944 372.802 281.944 372.802 DL 291.944 372.802 286.944 372.802 DL 296.944
372.802 291.944 372.802 DL 301.944 372.802 296.944 372.802 DL 306.944 372.802
301.944 372.802 DL 311.944 372.802 306.944 372.802 DL 316.944 372.802 311.944
372.802 DL 321.944 372.802 316.944 372.802 DL 326.944 372.802 321.944 372.802
DL 331.944 372.802 326.944 372.802 DL 336.944 372.802 331.944 372.802 DL
341.944 372.802 336.944 372.802 DL 346.944 372.802 341.944 372.802 DL 351.944
372.802 346.944 372.802 DL 356.944 372.802 351.944 372.802 DL 361.944 372.802
356.944 372.802 DL 366.944 372.802 361.944 372.802 DL 371.944 372.802 366.944
372.802 DL 376.944 372.802 371.944 372.802 DL 381.944 372.802 376.944 372.802
DL 386.944 372.802 381.944 372.802 DL 391.944 372.802 386.944 372.802 DL
396.944 372.802 391.944 372.802 DL 401.944 372.802 396.944 372.802 DL 406.944
372.802 401.944 372.802 DL 411.944 372.802 406.944 372.802 DL 416.944 372.802
411.944 372.802 DL 421.944 372.802 416.944 372.802 DL 426.944 372.802 421.944
372.802 DL 431.944 372.802 426.944 372.802 DL 436.944 372.802 431.944 372.802
DL F3(names/daytimetcpcli.c)439.194 375.302 Q/F5 8/Palatino-Bold@0 SF(Figure 1)
220.98 388.802 Q(1.7)-.296 E/F6 8/Palatino-Roman@0 SF(Daytime client r)6 E
(ecoded to use)-.144 E/F7 8/Courier@0 SF(getaddrinfo)2 E F6(.)A 1.472 -.736
(We c)183.6 422.802 T(all).736 E F7(malloc)2 E F6(for this str)2 E(uctur)-.064
E(e, instead of allocating it as)-.144 E/F8 7.15/Courier@0 SF 4.29
(char sockaddr[MAXSOCKADDR];)201.6 436.302 R F6 .447(for alignment r)183.6
450.802 R(easons.)-.144 E F7(malloc)4.447 E F6 .447(always r)2.447 F .448
(eturns a pointer with the strictest alignment r)-.144 F(equir)-.144 E(ed)-.144
E .66(by the system, while a)183.6 460.802 R F7(char)2.659 E F6 .659
(array could be allocated on an odd-byte boundary)2.659 F 2.659(,w)-.888 G .659
(hich could)481.789 460.802 R .189(be a pr)183.6 470.802 R .189
(oblem for the IP addr)-.144 F .189
(ess or port number \214elds in the socket addr)-.144 F .189(ess str)-.144 F
(uctur)-.064 E 2.189(e. Another)-.144 F
(way to handle this potential alignment pr)183.6 480.802 Q
(oblem was shown in Figur)-.144 E 2(e4)-.144 G(.19 using a)434.024 480.802 Q F7
(union)2 E F6(.)A/F9 10/Palatino-Roman@0 SF .611(This version of our client wo\
rks with both IPv4 and IPv6, while the version in Fig-)147.6 508.802 R(ur)129.6
520.802 Q 3.882(e1)-.18 G 1.383
(.5 worked only with IPv4 and the version in Figur)153.072 520.802 R 3.883(e1)
-.18 G 1.383(.6 worked only with IPv6.)399.718 520.802 R -.92(Yo)129.6 532.802
S 4.133(us).92 G 1.633(hould also compar)155.213 532.802 R 4.133(eo)-.18 G
1.633(ur new version with Figur)255.312 532.802 R 4.133(eE)-.18 G 1.633
(.14, which we coded to use)392.787 532.802 R/F10 10/Courier@0 SF
(gethostbyname)129.6 544.802 Q F9(and)2.5 E F10(getservbyname)2.5 E F9
(to support both IPv4 and IPv6.)2.5 E 1.84 -.92(We \214)147.6 556.802 T
(rst specify the name of a host that supports only IPv4.).92 E F4(solaris %)
147.6 572.802 Q/F11 8.15/Courier-Bold@0 SF(daytimetcpcli bsdi daytime)4.89 E F4
(connected to 206.62.226.35)147.6 582.802 Q(Fri May 30 12:33:32 1997)147.6
592.802 Q F9
(Next we specify the name of a host that supports both IPv4 and IPv6.)129.6
610.802 Q F4(solaris %)147.6 626.802 Q F11(daytimetcpcli aix daytime)4.89 E F4
(connected to 5f1b:df00:ce3e:e200:20:800:5afc:2b36)147.6 636.802 Q
(Fri May 30 12:43:43 1997)147.6 646.802 Q/F12 7/Palatino-Roman@0 SF 1.75<a943>
233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 288 16
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(288)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF 1.074(The IPv6 addr)129.6 123 R 1.074
(ess is used because the host has both a AAAA r)-.18 F(ecor)-.18 E 3.575(da)
-.18 G 1.075(nd an A r)447.505 123 R(ecor)-.18 E(d,)-.18 E .19
(and as noted in Figur)129.6 135 R 2.69(e1)-.18 G .19(1.4, since)236.46 135 R
/F3 10/Courier@0 SF(tcp_connect)2.69 E F2 .19(sets the addr)2.69 F .19
(ess family to)-.18 F F3(AF_UNSPEC)2.69 E F2(,)A 1.454(AAAA r)129.6 147 R(ecor)
-.18 E 1.454(ds ar)-.18 F 3.954(es)-.18 G(ear)222.962 147 Q 1.454
(ched for \214rst, and only if this fails is a sear)-.18 F 1.454
(ch made for an A)-.18 F -.18(re)129.6 159 S(cor).18 E(d.)-.18 E .023
(In the next example we for)147.6 171 R .023(ce the use of the IPv4 addr)-.18 F
.022(ess by specifying the hostname)-.18 F 1.112(with our)129.6 183 R F3(-4)
3.612 E F2(suf)3.612 E 1.113
(\214x, which we noted in Section 9.2 is our convention for the hostname)-.18 F
(with only A r)129.6 195 Q(ecor)-.18 E(ds.)-.18 E/F4 8.15/Courier@0 SF
(solaris %)147.6 211 Q/F5 8.15/Courier-Bold@0 SF(daytimetcpcli aix-4 daytime)
4.89 E F4(connected to 206.62.226.43)147.6 221 Q(Fri May 30 12:43:48 1997)147.6
231 Q/F6 12/Helvetica-Bold@0 SF(11.9)93.6 268.2 Q/F7 12/Courier-Bold@0 SF
(tcp_listen)129.6 268.2 Q F6(Function)6.672 E F2 1.057(Our next function,)129.6
292.2 R F3(tcp_listen)3.557 E F2 3.557(,p)C 1.057
(erforms the normal TCP server steps: cr)288.778 292.2 R 1.056(eate a TCP)-.18
F(socket,)129.6 304.2 Q F3(bind)3.211 E F2 .712(the server)3.211 F .712
('s well-known port, and allow incoming connection r).74 F .712(equests to)-.18
F(be accepted.)129.6 316.2 Q(Figur)5 E 2.5(e1)-.18 G(1.8 shows the sour)224.33
316.2 Q(ce code.)-.18 E F4(#include "unp.h")147.6 338.2 Q
(int tcp_listen\(const char *)147.6 358.2 Q/F8 8.15/Palatino-Italic@0 SF
(hostname)A F4 4.89(,c)C(onst char *)325.539 358.2 Q F8(service)A F4 4.89(,s)C
(ocklen_t *)416.337 358.2 Q F8(lenptr)A F4(\);)A/F9 8.15/Palatino-Roman@0 SF
(Returns: connected socket descriptor if OK, no r)278.667 378.2 Q(eturn on err)
-.147 E(or)-.147 E 129.6 382.275 EBEGIN
0 56300 u neg rlineto 390000 u 0 rlineto 0 56300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 382.275 EBEGIN
0 -3.6 rlineto 0 49100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 49100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 9/Helvetica-Bold@0 SF(Call)129.6 406.2 Q/F1 9/Courier-Bold@0 SF
(getaddrinfo)2.502 E/F2 7/Courier-Oblique@0 SF(8\21115)108.48 421.2 Q/F3 10
/Palatino-Roman@0 SF 2.704 -.92(We i)147.6 421.2 T .864(nitialize an).92 F/F4
10/Courier@0 SF(addrinfo)3.364 E F3(str)3.364 E(uctur)-.08 E 3.364(ew)-.18 G
.864(ith our hints:)323.56 421.2 R F4(AI_PASSIVE)3.363 E F3 3.363(,s)C .863
(ince this func-)455.734 421.2 R .398(tion is for a server)129.6 433.2 R(,)-.74
E F4(AF_UNSPEC)2.898 E F3 .398(for the addr)2.898 F .399(ess family)-.18 F
2.899(,a)-1.11 G(nd)379.853 433.2 Q F4(SOCK_STREAM)2.899 E F3 5.399(.R)C .399
(ecall fr)475.261 433.2 R(om)-.18 E(Figur)129.6 445.2 Q 2.865(e1)-.18 G .365(1\
.4 that if a hostname is not speci\214ed \(which is common for a server that w\
ants)165.535 445.2 R .99(to bind the wildcar)129.6 457.2 R 3.49(da)-.18 G(ddr)
231.11 457.2 Q .99(ess\), the)-.18 F F4(AI_PASSIVE)3.49 E F3(and)3.49 E F4
(AF_UNSPEC)3.49 E F3 .99(hints will cause two)3.49 F .314(socket addr)129.6
469.2 R .314(ess str)-.18 F(uctur)-.08 E .314(es to be r)-.18 F .313
(eturned: the \214rst for IPv6 and the next for IPv4 \(assum-)-.18 F
(ing a dual-stack host\).)129.6 481.2 Q F0(Create soc)129.6 497.2 Q
(ket and bind ad)-.18 E(dress)-.09 E F2(16\21124)104.28 512.2 Q F3(The)147.6
512.2 Q F4(socket)3.777 E F3(and)3.777 E F4(bind)3.778 E F3 1.278(functions ar)
3.778 F 3.778(ec)-.18 G 3.778(alled. If)323.246 512.2 R 1.278
(either call fails we just ignor)3.778 F 3.778(et)-.18 G(his)506.63 512.2 Q F4
(addrinfo)129.6 524.2 Q F3(str)3.211 E(uctur)-.08 E 3.211(ea)-.18 G .711
(nd move on to the next one.)228.712 524.2 R .71
(As stated in Section 7.5, we always)5.711 F(set the)129.6 536.2 Q F4
(SO_REUSEADDR)2.5 E F3(socket option for a TCP server)2.5 E(.)-.74 E F0(Chec)
129.6 552.2 Q 2.502(kf)-.18 G(or failure)161.748 552.2 Q F2(25\21126)104.28
567.2 Q F3 .2(If all the calls to)147.6 567.2 R F4(socked)2.7 E F3(and)2.7 E F4
(bind)2.7 E F3 .2(failed, we print an err)2.7 F .2(or and terminate.)-.18 F .2
(As with)5.2 F(our)129.6 579.2 Q F4(tcp_connect)3.966 E F3 1.466
(function in the pr)3.966 F 1.466(evious section, we do not try to r)-.18 F
1.465(eturn an err)-.18 F(or)-.18 E(fr)129.6 591.2 Q(om this function.)-.18 E
F2(27)104.28 603.2 Q F3(The socket is turned into a listening socket by)147.6
603.2 Q F4(listen)2.5 E F3(.)A F0(Return siz)129.6 619.2 Q 2.502(eo).09 G 2.502
(fs)186.201 619.2 S(oc)196.704 619.2 Q(ket ad)-.18 E(dress structure)-.09 E F2
(28\21131)104.28 634.2 Q F3 1.662(If the)147.6 634.2 R/F5 10/Palatino-Italic@0
SF(addrlenp)4.162 E F3(ar)4.162 E 1.662(gument is nonnull, we r)-.18 F 1.663
(eturn the size of the pr)-.18 F 1.663(otocol addr)-.18 F(esses)-.18 E(thr)
129.6 646.2 Q 1.816(ough this pointer)-.18 F 6.816(.T)-.74 G 1.815
(his allows the caller to allocate memory for a socket addr)237.088 646.2 R
(ess)-.18 E(str)129.6 658.2 Q(uctur)-.08 E 2.5(et)-.18 G 2.5(oo)175.05 658.2 S
(btain the client's pr)188.47 658.2 Q(otocol addr)-.18 E(ess fr)-.18 E(om)-.18
E F4(accept)2.5 E F3 5(.\()C(See Exer)410.26 658.2 Q(cise 1)-.18 E(1.1 also.\))
-.55 E/F6 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)
-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 289 17
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.9)-.495 E/F1 9/Courier@0 SF
(tcp_listen)394.23 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(289)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4 LW 134.6 124.2 129.6 124.2
DL 138.935 124.2 133.935 124.2 DL 143.935 124.2 138.935 124.2 DL 148.935 124.2
143.935 124.2 DL 153.935 124.2 148.935 124.2 DL 158.935 124.2 153.935 124.2 DL
163.935 124.2 158.935 124.2 DL 168.935 124.2 163.935 124.2 DL 173.935 124.2
168.935 124.2 DL 178.935 124.2 173.935 124.2 DL 183.935 124.2 178.935 124.2 DL
188.935 124.2 183.935 124.2 DL 193.935 124.2 188.935 124.2 DL 198.935 124.2
193.935 124.2 DL 203.935 124.2 198.935 124.2 DL 208.935 124.2 203.935 124.2 DL
213.935 124.2 208.935 124.2 DL 218.935 124.2 213.935 124.2 DL 223.935 124.2
218.935 124.2 DL 228.935 124.2 223.935 124.2 DL 233.935 124.2 228.935 124.2 DL
238.935 124.2 233.935 124.2 DL 243.935 124.2 238.935 124.2 DL 248.935 124.2
243.935 124.2 DL 253.935 124.2 248.935 124.2 DL 258.935 124.2 253.935 124.2 DL
263.935 124.2 258.935 124.2 DL 268.935 124.2 263.935 124.2 DL 273.935 124.2
268.935 124.2 DL 278.935 124.2 273.935 124.2 DL 283.935 124.2 278.935 124.2 DL
288.935 124.2 283.935 124.2 DL 293.935 124.2 288.935 124.2 DL 298.935 124.2
293.935 124.2 DL 303.935 124.2 298.935 124.2 DL 308.935 124.2 303.935 124.2 DL
313.935 124.2 308.935 124.2 DL 318.935 124.2 313.935 124.2 DL 323.935 124.2
318.935 124.2 DL 328.935 124.2 323.935 124.2 DL 333.935 124.2 328.935 124.2 DL
338.935 124.2 333.935 124.2 DL 343.935 124.2 338.935 124.2 DL 348.935 124.2
343.935 124.2 DL 353.935 124.2 348.935 124.2 DL 358.935 124.2 353.935 124.2 DL
363.935 124.2 358.935 124.2 DL 368.935 124.2 363.935 124.2 DL 373.935 124.2
368.935 124.2 DL 378.935 124.2 373.935 124.2 DL 383.935 124.2 378.935 124.2 DL
388.935 124.2 383.935 124.2 DL 393.935 124.2 388.935 124.2 DL 398.935 124.2
393.935 124.2 DL 403.935 124.2 398.935 124.2 DL 408.935 124.2 403.935 124.2 DL
413.935 124.2 408.935 124.2 DL 418.935 124.2 413.935 124.2 DL 423.935 124.2
418.935 124.2 DL 428.935 124.2 423.935 124.2 DL 433.935 124.2 428.935 124.2 DL
438.935 124.2 433.935 124.2 DL 443.935 124.2 438.935 124.2 DL 448.935 124.2
443.935 124.2 DL 453.935 124.2 448.935 124.2 DL 458.935 124.2 453.935 124.2 DL
463.935 124.2 458.935 124.2 DL/F3 9/Palatino-Italic@0 SF(lib/tcp_listen.c)
466.185 126.7 Q/F4 8.15/Courier@0 SF 4.89(1#)139.38 133.001 S 14.67
(include "unp.h")154.05 133.001 R 4.89(2i)139.38 150.001 S(nt)154.05 150.001 Q
4.89(3t)139.38 160.001 S
(cp_listen\(const char *host, const char *serv, socklen_t *addrlenp\))154.05
160.001 Q 4.89(4{)139.38 170.001 S 24.45(5i)139.38 180.001 S 19.56
(nt listenfd,)173.61 180.001 R(n;)4.89 E 24.45(6c)139.38 190.001 S
(onst int on = 1;)173.61 190.001 Q 24.45(7s)139.38 200.001 S
(truct addrinfo hints, *res, *ressave;)173.61 200.001 Q 24.45(8b)139.38 217.001
S(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 217.001 Q 24.45(9h)139.38
227.001 S(ints.ai_flags = AI_PASSIVE;)173.61 227.001 Q 19.56
(10 hints.ai_family)134.49 237.001 R 4.89(=A)4.89 G(F_UNSPEC;)261.63 237.001 Q
19.56(11 hints.ai_socktype)134.49 247.001 R 4.89(=S)4.89 G(OCK_STREAM;)271.41
247.001 Q 19.56(12 if)134.49 264.001 R 4.89(\(\()4.89 G 4.89(n=g)198.06 264.001
S(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 264.001 Q 39.12
(13 err_quit\("tcp_listen)134.49 274.001 R(error for %s, %s: %s",)4.89 E 83.13
(14 host,)134.49 284.001 R(serv, gai_strerror\(n\)\);)4.89 E 19.56(15 ressave)
134.49 294.001 R 4.89(=r)4.89 G(es;)222.51 294.001 Q 19.56(16 do)134.49 311.001
R({)4.89 E 39.12(17 listenfd)134.49 321.001 R 4.89(=s)4.89 G
(ocket\(res->ai_family, res->ai_socktype, res->ai_protocol\);)246.96 321.001 Q
39.12(18 if)134.49 331.001 R(\(listenfd < 0\))4.89 E 58.68(19 continue;)134.49
341.001 R(/* error, try next one */)305.64 341.001 Q 39.12
(20 Setsockopt\(listenfd,)134.49 358.001 R
(SOL_SOCKET, SO_REUSEADDR, &on, sizeof\(on\)\);)4.89 E 39.12(21 if)134.49
368.001 R(\(bind\(listenfd, res->ai_addr, res->ai_addrlen\) == 0\))4.89 E 58.68
(22 break;)134.49 378.001 R(/* success */)305.64 378.001 Q 39.12
(23 Close\(listenfd\);)134.49 395.001 R
(/* bind error, close and try next one */)305.64 395.001 Q 19.56(24 })134.49
405.001 R(while \( \(res = res->ai_next\) != NULL\);)4.89 E 19.56(25 if)134.49
422.001 R(\(res == NULL\))4.89 E(/* errno from final socket\(\) or bind\(\) */)
305.64 422.001 Q 39.12(26 err_sys\("tcp_listen)134.49 432.001 R
(error for %s, %s", host, serv\);)4.89 E 19.56(27 Listen\(listenfd,)134.49
449.001 R(LISTENQ\);)4.89 E 19.56(28 if)134.49 466.001 R(\(addrlenp\))4.89 E
39.12(29 *addrlenp)134.49 476.001 R 4.89(=r)4.89 G 14.67(es->ai_addrlen; /*)
251.85 476.001 R(return size of protocol address */)4.89 E 19.56
(30 freeaddrinfo\(ressave\);)134.49 493.001 R 19.56(31 return)134.49 510.001 R
(\(listenfd\);)4.89 E(32 })134.49 520.001 Q 134.6 524.802 129.6 524.802 DL
138.935 524.802 133.935 524.802 DL 143.935 524.802 138.935 524.802 DL 148.935
524.802 143.935 524.802 DL 153.935 524.802 148.935 524.802 DL 158.935 524.802
153.935 524.802 DL 163.935 524.802 158.935 524.802 DL 168.935 524.802 163.935
524.802 DL 173.935 524.802 168.935 524.802 DL 178.935 524.802 173.935 524.802
DL 183.935 524.802 178.935 524.802 DL 188.935 524.802 183.935 524.802 DL
193.935 524.802 188.935 524.802 DL 198.935 524.802 193.935 524.802 DL 203.935
524.802 198.935 524.802 DL 208.935 524.802 203.935 524.802 DL 213.935 524.802
208.935 524.802 DL 218.935 524.802 213.935 524.802 DL 223.935 524.802 218.935
524.802 DL 228.935 524.802 223.935 524.802 DL 233.935 524.802 228.935 524.802
DL 238.935 524.802 233.935 524.802 DL 243.935 524.802 238.935 524.802 DL
248.935 524.802 243.935 524.802 DL 253.935 524.802 248.935 524.802 DL 258.935
524.802 253.935 524.802 DL 263.935 524.802 258.935 524.802 DL 268.935 524.802
263.935 524.802 DL 273.935 524.802 268.935 524.802 DL 278.935 524.802 273.935
524.802 DL 283.935 524.802 278.935 524.802 DL 288.935 524.802 283.935 524.802
DL 293.935 524.802 288.935 524.802 DL 298.935 524.802 293.935 524.802 DL
303.935 524.802 298.935 524.802 DL 308.935 524.802 303.935 524.802 DL 313.935
524.802 308.935 524.802 DL 318.935 524.802 313.935 524.802 DL 323.935 524.802
318.935 524.802 DL 328.935 524.802 323.935 524.802 DL 333.935 524.802 328.935
524.802 DL 338.935 524.802 333.935 524.802 DL 343.935 524.802 338.935 524.802
DL 348.935 524.802 343.935 524.802 DL 353.935 524.802 348.935 524.802 DL
358.935 524.802 353.935 524.802 DL 363.935 524.802 358.935 524.802 DL 368.935
524.802 363.935 524.802 DL 373.935 524.802 368.935 524.802 DL 378.935 524.802
373.935 524.802 DL 383.935 524.802 378.935 524.802 DL 388.935 524.802 383.935
524.802 DL 393.935 524.802 388.935 524.802 DL 398.935 524.802 393.935 524.802
DL 403.935 524.802 398.935 524.802 DL 408.935 524.802 403.935 524.802 DL
413.935 524.802 408.935 524.802 DL 418.935 524.802 413.935 524.802 DL 423.935
524.802 418.935 524.802 DL 428.935 524.802 423.935 524.802 DL 433.935 524.802
428.935 524.802 DL 438.935 524.802 433.935 524.802 DL 443.935 524.802 438.935
524.802 DL 448.935 524.802 443.935 524.802 DL 453.935 524.802 448.935 524.802
DL 458.935 524.802 453.935 524.802 DL 463.935 524.802 458.935 524.802 DL F3
(lib/tcp_listen.c)466.185 527.302 Q/F5 8/Palatino-Bold@0 SF(Figure 1)208.86
540.802 Q(1.8)-.296 E/F6 8/Courier@0 SF(tcp_listen)6 E/F7 8/Palatino-Roman@0 SF
(function: perform normal server steps.)2 E/F8 10/Helvetica-Bold@0 SF
(Example: Da)93.6 579.202 Q(ytime Ser)-.2 E(ver).1 E/F9 10/Palatino-Roman@0 SF
(Figur)129.6 603.202 Q 2.5(e1)-.18 G(1.9 shows our daytime server fr)165.17
603.202 Q(om Figur)-.18 E 2.5(e4)-.18 G(.1)357.55 603.202 Q 2.5(1r)-.55 G
(ecoded to use)375.77 603.202 Q/F10 10/Courier@0 SF(tcp_listen)2.5 E F9(.)A/F11
9/Helvetica-Bold@0 SF(Require ser)129.6 619.202 Q(vice name or por).09 E 2.502
(tn).18 G(umber as command)262.323 619.202 Q(-)-.81 I(line ar).81 I(gument)
-.135 E/F12 7/Courier-Oblique@0 SF(11\21112)104.28 634.202 Q F9 2.232 -.92
(We r)147.6 634.202 T(equir).74 E 2.892(eac)-.18 G(ommand)211.246 634.202 Q(-)
-.9 I .392(line ar).9 J .392
(gument to specify either the service name or the port)-.18 F(number)129.6
646.202 Q 6.098(.T)-.74 G 1.098(his makes it easier to test our server)178.538
646.202 R 3.598(,s)-.74 G 1.098(ince binding port 13 for the daytime)353.642
646.202 R(server r)129.6 658.202 Q(equir)-.18 E(es super)-.18 E
(user privileges.)-.08 E/F13 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 290 18
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(290)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 134.609 124.2 129.609 124.2 DL 139.609 124.2
134.609 124.2 DL 144.609 124.2 139.609 124.2 DL 149.609 124.2 144.609 124.2 DL
154.609 124.2 149.609 124.2 DL 159.609 124.2 154.609 124.2 DL 164.609 124.2
159.609 124.2 DL 169.609 124.2 164.609 124.2 DL 174.609 124.2 169.609 124.2 DL
179.609 124.2 174.609 124.2 DL 184.609 124.2 179.609 124.2 DL 189.609 124.2
184.609 124.2 DL 194.609 124.2 189.609 124.2 DL 199.609 124.2 194.609 124.2 DL
204.609 124.2 199.609 124.2 DL 209.609 124.2 204.609 124.2 DL 214.609 124.2
209.609 124.2 DL 219.609 124.2 214.609 124.2 DL 224.609 124.2 219.609 124.2 DL
229.609 124.2 224.609 124.2 DL 234.609 124.2 229.609 124.2 DL 239.609 124.2
234.609 124.2 DL 244.609 124.2 239.609 124.2 DL 249.609 124.2 244.609 124.2 DL
254.609 124.2 249.609 124.2 DL 259.609 124.2 254.609 124.2 DL 264.609 124.2
259.609 124.2 DL 269.609 124.2 264.609 124.2 DL 274.609 124.2 269.609 124.2 DL
279.609 124.2 274.609 124.2 DL 284.609 124.2 279.609 124.2 DL 289.609 124.2
284.609 124.2 DL 294.609 124.2 289.609 124.2 DL 299.609 124.2 294.609 124.2 DL
304.609 124.2 299.609 124.2 DL 309.609 124.2 304.609 124.2 DL 314.609 124.2
309.609 124.2 DL 319.609 124.2 314.609 124.2 DL 324.609 124.2 319.609 124.2 DL
329.609 124.2 324.609 124.2 DL 334.609 124.2 329.609 124.2 DL 339.609 124.2
334.609 124.2 DL 344.609 124.2 339.609 124.2 DL 349.609 124.2 344.609 124.2 DL
354.609 124.2 349.609 124.2 DL 359.609 124.2 354.609 124.2 DL 364.609 124.2
359.609 124.2 DL 369.609 124.2 364.609 124.2 DL 374.609 124.2 369.609 124.2 DL
379.609 124.2 374.609 124.2 DL 384.609 124.2 379.609 124.2 DL 389.609 124.2
384.609 124.2 DL 394.609 124.2 389.609 124.2 DL 399.609 124.2 394.609 124.2 DL
404.609 124.2 399.609 124.2 DL 409.609 124.2 404.609 124.2 DL 414.609 124.2
409.609 124.2 DL 419.609 124.2 414.609 124.2 DL 424.609 124.2 419.609 124.2 DL
429.609 124.2 424.609 124.2 DL/F2 9/Palatino-Italic@0 SF
(names/daytimetcpsrv1.c)431.859 126.7 Q/F3 8.15/Courier@0 SF 4.89(1#)139.38
133.001 S 14.67(include "unp.h")154.05 133.001 R 4.89(2#)139.38 143.001 S 14.67
(include <time.h>)154.05 143.001 R 4.89(3i)139.38 160.001 S(nt)154.05 160.001 Q
4.89(4m)139.38 170.001 S(ain\(int argc, char **argv\))154.05 170.001 Q 4.89(5{)
139.38 180.001 S 24.45(6i)139.38 190.001 S 19.56(nt listenfd,)173.61 190.001 R
(connfd;)4.89 E 24.45(7s)139.38 200.001 S(ocklen_t addrlen, len;)173.61 200.001
Q 24.45(8c)139.38 210.001 S 14.67(har buff[MAXLINE];)173.61 210.001 R 24.45(9t)
139.38 220.001 S 4.89(ime_t ticks;)173.61 220.001 R 19.56(10 struct)134.49
230.001 R(sockaddr *cliaddr;)4.89 E 19.56(11 if)134.49 247.001 R(\(argc != 2\))
4.89 E 39.12(12 err_quit\("usage:)134.49 257.001 R
(daytimetcpsrv1 <service or port#>"\);)4.89 E 19.56(13 listenfd)134.49 274.001
R 4.89(=T)4.89 G(cp_listen\(NULL, argv[1], &addrlen\);)227.4 274.001 Q 19.56
(14 cliaddr)134.49 291.001 R 4.89(=M)4.89 G(alloc\(addrlen\);)222.51 291.001 Q
19.56(15 for)134.49 308.001 R 4.89(\(;;\){)4.89 G 39.12(16 len)134.49 318.001 R
4.89(=a)4.89 G(ddrlen;)222.51 318.001 Q 39.12(17 connfd)134.49 328.001 R 4.89
(=A)4.89 G(ccept\(listenfd, cliaddr, &len\);)237.18 328.001 Q 39.12
(18 printf\("connection)134.49 338.001 R
(from %s\\n", Sock_ntop\(cliaddr, len\)\);)4.89 E 39.12(19 ticks)134.49 355.001
R 4.89(=t)4.89 G(ime\(NULL\);)232.29 355.001 Q 39.12(20 snprintf\(buff,)134.49
365.001 R(sizeof\(buff\), "%.24s\\r\\n", ctime\(&ticks\)\);)4.89 E 39.12
(21 Write\(connfd,)134.49 375.001 R(buff, strlen\(buff\)\);)4.89 E 39.12
(22 Close\(connfd\);)134.49 392.001 R 19.56(23 })134.49 402.001 R(24 })134.49
412.001 Q 134.6 416.802 129.6 416.802 DL 134.609 416.802 129.609 416.802 DL
139.609 416.802 134.609 416.802 DL 144.609 416.802 139.609 416.802 DL 149.609
416.802 144.609 416.802 DL 154.609 416.802 149.609 416.802 DL 159.609 416.802
154.609 416.802 DL 164.609 416.802 159.609 416.802 DL 169.609 416.802 164.609
416.802 DL 174.609 416.802 169.609 416.802 DL 179.609 416.802 174.609 416.802
DL 184.609 416.802 179.609 416.802 DL 189.609 416.802 184.609 416.802 DL
194.609 416.802 189.609 416.802 DL 199.609 416.802 194.609 416.802 DL 204.609
416.802 199.609 416.802 DL 209.609 416.802 204.609 416.802 DL 214.609 416.802
209.609 416.802 DL 219.609 416.802 214.609 416.802 DL 224.609 416.802 219.609
416.802 DL 229.609 416.802 224.609 416.802 DL 234.609 416.802 229.609 416.802
DL 239.609 416.802 234.609 416.802 DL 244.609 416.802 239.609 416.802 DL
249.609 416.802 244.609 416.802 DL 254.609 416.802 249.609 416.802 DL 259.609
416.802 254.609 416.802 DL 264.609 416.802 259.609 416.802 DL 269.609 416.802
264.609 416.802 DL 274.609 416.802 269.609 416.802 DL 279.609 416.802 274.609
416.802 DL 284.609 416.802 279.609 416.802 DL 289.609 416.802 284.609 416.802
DL 294.609 416.802 289.609 416.802 DL 299.609 416.802 294.609 416.802 DL
304.609 416.802 299.609 416.802 DL 309.609 416.802 304.609 416.802 DL 314.609
416.802 309.609 416.802 DL 319.609 416.802 314.609 416.802 DL 324.609 416.802
319.609 416.802 DL 329.609 416.802 324.609 416.802 DL 334.609 416.802 329.609
416.802 DL 339.609 416.802 334.609 416.802 DL 344.609 416.802 339.609 416.802
DL 349.609 416.802 344.609 416.802 DL 354.609 416.802 349.609 416.802 DL
359.609 416.802 354.609 416.802 DL 364.609 416.802 359.609 416.802 DL 369.609
416.802 364.609 416.802 DL 374.609 416.802 369.609 416.802 DL 379.609 416.802
374.609 416.802 DL 384.609 416.802 379.609 416.802 DL 389.609 416.802 384.609
416.802 DL 394.609 416.802 389.609 416.802 DL 399.609 416.802 394.609 416.802
DL 404.609 416.802 399.609 416.802 DL 409.609 416.802 404.609 416.802 DL
414.609 416.802 409.609 416.802 DL 419.609 416.802 414.609 416.802 DL 424.609
416.802 419.609 416.802 DL 429.609 416.802 424.609 416.802 DL F2
(names/daytimetcpsrv1.c)431.859 419.302 Q/F4 8/Palatino-Bold@0 SF(Figure 1)
219.684 432.802 Q(1.9)-.296 E/F5 8/Palatino-Roman@0 SF(Daytime server r)6 E
(ecoded to use)-.144 E/F6 8/Courier@0 SF(getaddrinfo)2 E F5(.)A/F7 9
/Helvetica-Bold@0 SF(Create listening soc)129.6 456.802 Q(ket)-.18 E/F8 7
/Courier-Oblique@0 SF(13\21114)104.28 471.802 Q/F9 10/Courier@0 SF(tcp_listen)
147.6 471.802 Q/F10 10/Palatino-Roman@0 SF(cr)3.021 E .521
(eates the listening socket and)-.18 F F9(malloc)3.022 E F10 .522
(allocates a buf)3.022 F .522(fer to hold the)-.18 F(client's addr)129.6
483.802 Q(ess.)-.18 E F7 -2.412(Ser ver)129.6 499.802 R(loop)2.502 E F8
(15\21123)104.28 514.802 Q F9(accept)147.6 514.802 Q F10 1.949
(waits for each client connection.)4.45 F 3.789 -.92(We p)6.949 H 1.949
(rint the client addr).92 F 1.949(ess by calling)-.18 F F9(sock_ntop)129.6
526.802 Q F10 5.778(.I)C 3.278(nt)195.248 526.802 S .778
(he case of either IPv4 or IPv6, this function prints the IP addr)207.606
526.802 R .778(ess and)-.18 F .87(port number)129.6 538.802 R 5.87(.W)-.74 G
3.369(ec)203.31 538.802 S .869(ould use the function)215.909 538.802 R F9
(getnameinfo)3.369 E F10 .869(\(described in Section 1)3.369 F .869(1.13\) to)
-.55 F 1.774(try to obtain the hostname of the client, but that involves a PTR\
 query in the DNS,)129.6 550.802 R .144
(which can take some time, especially if the PTR query fails.)129.6 562.802 R
.143(Section 14.8 of TCPv3 notes)5.143 F 1.296(that on a busy W)129.6 574.802 R
1.297(eb server almost 25% of all clients connecting to that server did not)
-.92 F 1.296(have PTR r)129.6 586.802 R(ecor)-.18 E 1.296(ds in the DNS.)-.18 F
1.296(Since we do not want a server \(especially an iterative)6.296 F
(server\) to wait seconds for a PTR query)129.6 598.802 Q 2.5(,w)-1.11 G 2.5
(ej)315.88 598.802 S(ust print the IP addr)325.51 598.802 Q(ess and port.)-.18
E/F11 10/Helvetica-Bold@0 SF(Example: Da)93.6 622.802 Q(ytime Ser)-.2 E
(ver with Pr).1 E(otocol Speci\214cation)-.2 E F10(Ther)129.6 646.802 Q 3.278
(ei)-.18 G 3.278(sas)161.088 646.802 S .778(light pr)181.124 646.802 R .778
(oblem with Figur)-.18 F 3.279(e1)-.18 G .779(1.9: the \214rst ar)305.398
646.802 R .779(gument to)-.18 F F9(tcp_listen)3.279 E F10 .779(is a null)3.279
F(pointer)129.6 658.802 Q 4.769(,w)-.74 G 2.269(hich combined with the addr)
176.669 658.802 R 2.269(ess family of)-.18 F F9(AF_UNSPEC)4.769 E F10(that)
4.769 E F9(tcp_listen)4.769 E/F12 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 291 19
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.9)-.495 E/F1 9/Courier@0 SF
(tcp_listen)394.23 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(291)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF
3.087(speci\214es might cause)129.6 123 R/F4 10/Courier@0 SF(getaddrinfo)5.587
E F3 3.087(to r)5.587 F 3.087(eturn a socket addr)-.18 F 3.088(ess str)-.18 F
(uctur)-.08 E 5.588(ew)-.18 G 3.088(ith an)491.202 123 R(addr)129.6 135 Q .825
(ess family other than what is desir)-.18 F 3.325(ed. For)-.18 F .824
(example, the \214rst socket addr)3.325 F .824(ess str)-.18 F(uc-)-.08 E(tur)
129.6 147 Q 3.005(er)-.18 G .505
(eturned will be for IPv6 on a dual-stack host \(Figur)154.225 147 R 3.005(e1)
-.18 G .505(1.4\) but we might want our)396.555 147 R
(server to handle only IPv4.)129.6 159 Q .853(Clients do not have this pr)147.6
171 R .853(oblem, since the client must always specify either an IP)-.18 F
(addr)129.6 183 Q 1.258(ess or a hostname.)-.18 F 1.259
(Client applications normally allow the user to enter this as a)6.258 F
(command)129.6 195 Q(-)-.9 I 1.239(line ar).9 J 3.739(gument. This)-.18 F 1.238
(gives us the opportunity to specify a hostname that is)3.739 F .577
(associated with a particular type of IP addr)129.6 207 R .577(ess \(r)-.18 F
.577(ecall our)-.18 F F4(-4)3.077 E F3(and)3.078 E F4(-6)3.078 E F3 .578
(hostnames in Sec-)3.078 F .253
(tion 9.2\), or to specify either an IPv4 dotted-decimal string \(for)129.6 219
R .252(cing IPv4\) or an IPv6 hex)-.18 F(string \(for)129.6 231 Q(cing IPv6\).)
-.18 E .318(But ther)147.6 243 R 2.818(ei)-.18 G 2.818(sas)193.976 243 S .319
(imple technique for servers that lets us for)213.092 243 R .319(ce a given pr)
-.18 F .319(otocol upon a)-.18 F(server)129.6 255 Q 2.801(,e)-.74 G .301
(ither IPv4 or IPv6: allow the user to enter either an IP addr)166.321 255 R .3
(ess or a hostname as)-.18 F 3.278(ac)129.6 267 S(ommand)142.318 267 Q(-)-.9 I
.778(line ar).9 J .778(gument to the pr)-.18 F .778(ogram and pass this to)-.18
F F4(getaddrinfo)3.279 E F3 5.779(.I)C 3.279(nt)474.882 267 S .779(he case)
487.241 267 R .251(of an IP addr)129.6 279 R .251
(ess, an IPv4 dotted-decimal string dif)-.18 F .251(fers fr)-.18 F .25
(om an IPv6 hex string.)-.18 F .25(The fol-)5.25 F(lowing calls to)129.6 291 Q
F4(inet_pton)2.5 E F3(either fail or succeed, as indicated.)2.5 E/F5 8.15
/Courier@0 SF 4.89(inet_pton\(AF_INET, "0.0.0.0",)147.6 307 R 24.45(&foo\); /*)
4.89 F(succeeds */)4.89 E 4.89(inet_pton\(AF_INET, "0::0",)147.6 317 R 24.45
(&foo\); /*)299.19 317 R(fails */)4.89 E
(inet_pton\(AF_INET6, "0.0.0.0", &foo\);)147.6 327 Q(/* fails */)357.87 327 Q
(inet_pton\(AF_INET6, "0::0",)147.6 337 Q 24.45(&foo\); /*)299.19 337 R
(succeeds */)4.89 E F3(Ther)129.6 355 Q(efor)-.18 E
(e, if we change our servers to accept an optional ar)-.18 E
(gument, then if we enter)-.18 E F5 4.89(%s)147.6 371 S(erver)162.27 371 Q F3
(it defaults to IPv6 on a dual-stack host, but entering)129.6 389 Q F5 4.89(%s)
147.6 405 S(erver 0.0.0.0)162.27 405 Q F3(explicitly speci\214es IPv4 and)129.6
423 Q F5 4.89(%s)147.6 439 S(erver 0::0)162.27 439 Q F3
(explicitly speci\214es IPv6.)129.6 457 Q(Figur)147.6 481 Q 2.5(e1)-.18 G
(1.10 shows this \214nal version of our daytime server)183.17 481 Q(.)-.74 E/F6
9/Helvetica-Bold@0 SF(Handle command)129.6 497 Q(-)-.81 I(line ar).81 I
(guments)-.135 E/F7 7/Courier-Oblique@0 SF(11\21116)104.28 512 Q F3 .786
(The only change fr)147.6 512 R .786(om Figur)-.18 F 3.287(e1)-.18 G .787
(1.9 is the handling of the command)286.411 512 R(-)-.9 I .787(line ar).9 J
(guments,)-.18 E .222
(allowing the user to specify either a hostname or an IP addr)129.6 524 R .221
(ess for the server to bind, in)-.18 F(addition to a service name or port.)
129.6 536 Q 3.097 -.92(We \214)147.6 557.6 T 1.257
(rst start this server with an IPv4 socket and then connect to the server fr)
.92 F(om)-.18 E(clients on two other hosts on the local subnet.)129.6 569.6 Q
F5(solaris %)147.6 585 Q/F8 8.15/Courier-Bold@0 SF(daytimetcpsrv2 0.0.0.0 9999)
4.89 E F5(connection from 206.62.226.36.32789)147.6 595 Q
(connection from 206.62.226.35.1389)147.6 605 Q F3
(But now we start the server with an IPv6 socket.)129.6 622.4 Q F5(solaris %)
147.6 637.8 Q F8(daytimetcpsrv2 0::0 9999)4.89 E F5
(connection from 5f1b:df00:ce3e:e200:20:800:2003:f642.32799)147.6 647.8 Q
(connection from 5f1b:df00:ce3e:e200:20:800:2b37:6426.1026)147.6 657.8 Q/F9 7
/Palatino-Roman@0 SF 1.75<a943>233.453 676 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 292 20
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(292)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 134.609 124.2 129.609 124.2 DL 139.609 124.2
134.609 124.2 DL 144.609 124.2 139.609 124.2 DL 149.609 124.2 144.609 124.2 DL
154.609 124.2 149.609 124.2 DL 159.609 124.2 154.609 124.2 DL 164.609 124.2
159.609 124.2 DL 169.609 124.2 164.609 124.2 DL 174.609 124.2 169.609 124.2 DL
179.609 124.2 174.609 124.2 DL 184.609 124.2 179.609 124.2 DL 189.609 124.2
184.609 124.2 DL 194.609 124.2 189.609 124.2 DL 199.609 124.2 194.609 124.2 DL
204.609 124.2 199.609 124.2 DL 209.609 124.2 204.609 124.2 DL 214.609 124.2
209.609 124.2 DL 219.609 124.2 214.609 124.2 DL 224.609 124.2 219.609 124.2 DL
229.609 124.2 224.609 124.2 DL 234.609 124.2 229.609 124.2 DL 239.609 124.2
234.609 124.2 DL 244.609 124.2 239.609 124.2 DL 249.609 124.2 244.609 124.2 DL
254.609 124.2 249.609 124.2 DL 259.609 124.2 254.609 124.2 DL 264.609 124.2
259.609 124.2 DL 269.609 124.2 264.609 124.2 DL 274.609 124.2 269.609 124.2 DL
279.609 124.2 274.609 124.2 DL 284.609 124.2 279.609 124.2 DL 289.609 124.2
284.609 124.2 DL 294.609 124.2 289.609 124.2 DL 299.609 124.2 294.609 124.2 DL
304.609 124.2 299.609 124.2 DL 309.609 124.2 304.609 124.2 DL 314.609 124.2
309.609 124.2 DL 319.609 124.2 314.609 124.2 DL 324.609 124.2 319.609 124.2 DL
329.609 124.2 324.609 124.2 DL 334.609 124.2 329.609 124.2 DL 339.609 124.2
334.609 124.2 DL 344.609 124.2 339.609 124.2 DL 349.609 124.2 344.609 124.2 DL
354.609 124.2 349.609 124.2 DL 359.609 124.2 354.609 124.2 DL 364.609 124.2
359.609 124.2 DL 369.609 124.2 364.609 124.2 DL 374.609 124.2 369.609 124.2 DL
379.609 124.2 374.609 124.2 DL 384.609 124.2 379.609 124.2 DL 389.609 124.2
384.609 124.2 DL 394.609 124.2 389.609 124.2 DL 399.609 124.2 394.609 124.2 DL
404.609 124.2 399.609 124.2 DL 409.609 124.2 404.609 124.2 DL 414.609 124.2
409.609 124.2 DL 419.609 124.2 414.609 124.2 DL 424.609 124.2 419.609 124.2 DL
429.609 124.2 424.609 124.2 DL/F2 9/Palatino-Italic@0 SF
(names/daytimetcpsrv2.c)431.859 126.7 Q/F3 8.15/Courier@0 SF 4.89(1#)139.38
133.001 S 14.67(include "unp.h")154.05 133.001 R 4.89(2#)139.38 143.001 S 14.67
(include <time.h>)154.05 143.001 R 4.89(3i)139.38 160.001 S(nt)154.05 160.001 Q
4.89(4m)139.38 170.001 S(ain\(int argc, char **argv\))154.05 170.001 Q 4.89(5{)
139.38 180.001 S 24.45(6i)139.38 190.001 S 19.56(nt listenfd,)173.61 190.001 R
(connfd;)4.89 E 24.45(7s)139.38 200.001 S(ocklen_t addrlen, len;)173.61 200.001
Q 24.45(8s)139.38 210.001 S(truct sockaddr *cliaddr;)173.61 210.001 Q 24.45(9c)
139.38 220.001 S 14.67(har buff[MAXLINE];)173.61 220.001 R 19.56(10 time_t)
134.49 230.001 R(ticks;)9.78 E 19.56(11 if)134.49 247.001 R(\(argc == 2\))4.89
E 39.12(12 listenfd)134.49 257.001 R 4.89(=T)4.89 G
(cp_listen\(NULL, argv[1], &addrlen\);)246.96 257.001 Q 19.56(13 else)134.49
267.001 R(if \(argc == 3\))4.89 E 39.12(14 listenfd)134.49 277.001 R 4.89(=T)
4.89 G(cp_listen\(argv[1], argv[2], &addrlen\);)246.96 277.001 Q 19.56(15 else)
134.49 287.001 R 39.12(16 err_quit\("usage:)134.49 297.001 R
(daytimetcpsrv2 [ <host> ] <service or port>"\);)4.89 E 19.56(17 cliaddr)134.49
314.001 R 4.89(=M)4.89 G(alloc\(addrlen\);)222.51 314.001 Q 19.56(18 for)134.49
331.001 R 4.89(\(;;\){)4.89 G 39.12(19 len)134.49 341.001 R 4.89(=a)4.89 G
(ddrlen;)222.51 341.001 Q 39.12(20 connfd)134.49 351.001 R 4.89(=A)4.89 G
(ccept\(listenfd, cliaddr, &len\);)237.18 351.001 Q 39.12
(21 printf\("connection)134.49 361.001 R
(from %s\\n", Sock_ntop\(cliaddr, len\)\);)4.89 E 39.12(22 ticks)134.49 378.001
R 4.89(=t)4.89 G(ime\(NULL\);)232.29 378.001 Q 39.12(23 snprintf\(buff,)134.49
388.001 R(sizeof\(buff\), "%.24s\\r\\n", ctime\(&ticks\)\);)4.89 E 39.12
(24 Write\(connfd,)134.49 398.001 R(buff, strlen\(buff\)\);)4.89 E 39.12
(25 Close\(connfd\);)134.49 415.001 R 19.56(26 })134.49 425.001 R(27 })134.49
435.001 Q 134.6 439.802 129.6 439.802 DL 134.609 439.802 129.609 439.802 DL
139.609 439.802 134.609 439.802 DL 144.609 439.802 139.609 439.802 DL 149.609
439.802 144.609 439.802 DL 154.609 439.802 149.609 439.802 DL 159.609 439.802
154.609 439.802 DL 164.609 439.802 159.609 439.802 DL 169.609 439.802 164.609
439.802 DL 174.609 439.802 169.609 439.802 DL 179.609 439.802 174.609 439.802
DL 184.609 439.802 179.609 439.802 DL 189.609 439.802 184.609 439.802 DL
194.609 439.802 189.609 439.802 DL 199.609 439.802 194.609 439.802 DL 204.609
439.802 199.609 439.802 DL 209.609 439.802 204.609 439.802 DL 214.609 439.802
209.609 439.802 DL 219.609 439.802 214.609 439.802 DL 224.609 439.802 219.609
439.802 DL 229.609 439.802 224.609 439.802 DL 234.609 439.802 229.609 439.802
DL 239.609 439.802 234.609 439.802 DL 244.609 439.802 239.609 439.802 DL
249.609 439.802 244.609 439.802 DL 254.609 439.802 249.609 439.802 DL 259.609
439.802 254.609 439.802 DL 264.609 439.802 259.609 439.802 DL 269.609 439.802
264.609 439.802 DL 274.609 439.802 269.609 439.802 DL 279.609 439.802 274.609
439.802 DL 284.609 439.802 279.609 439.802 DL 289.609 439.802 284.609 439.802
DL 294.609 439.802 289.609 439.802 DL 299.609 439.802 294.609 439.802 DL
304.609 439.802 299.609 439.802 DL 309.609 439.802 304.609 439.802 DL 314.609
439.802 309.609 439.802 DL 319.609 439.802 314.609 439.802 DL 324.609 439.802
319.609 439.802 DL 329.609 439.802 324.609 439.802 DL 334.609 439.802 329.609
439.802 DL 339.609 439.802 334.609 439.802 DL 344.609 439.802 339.609 439.802
DL 349.609 439.802 344.609 439.802 DL 354.609 439.802 349.609 439.802 DL
359.609 439.802 354.609 439.802 DL 364.609 439.802 359.609 439.802 DL 369.609
439.802 364.609 439.802 DL 374.609 439.802 369.609 439.802 DL 379.609 439.802
374.609 439.802 DL 384.609 439.802 379.609 439.802 DL 389.609 439.802 384.609
439.802 DL 394.609 439.802 389.609 439.802 DL 399.609 439.802 394.609 439.802
DL 404.609 439.802 399.609 439.802 DL 409.609 439.802 404.609 439.802 DL
414.609 439.802 409.609 439.802 DL 419.609 439.802 414.609 439.802 DL 424.609
439.802 419.609 439.802 DL 429.609 439.802 424.609 439.802 DL F2
(names/daytimetcpsrv2.c)431.859 442.302 Q/F4 8/Palatino-Bold@0 SF(Figure 1)
188.836 455.802 Q(1.10)-.296 E/F5 8/Palatino-Roman@0 SF(Pr)6 E
(otocol-independent daytime server that uses)-.144 E/F6 8/Courier@0 SF
(getaddrinfo)2 E F5(.)A F3(connection from ::ffff:206.62.226.36.32792)147.6
489.802 Q(connection from ::ffff:206.62.226.35.1390)147.6 499.802 Q/F7 10
/Palatino-Roman@0 SF .18(The \214rst connection is fr)129.6 517.802 R .18
(om the host)-.18 F/F8 10/Courier@0 SF(sunos5)2.68 E F7 .18
(using IPv6 and the second is fr)2.68 F .18(om the host)-.18 F F8(alpha)129.6
529.802 Q F7 .285(using IPv6.)2.785 F .286(The next two connections ar)5.285 F
2.786(ef)-.18 G -.18(ro)353.684 529.802 S 2.786(mt).18 G .286(he hosts)377.79
529.802 R F8(sunos5)2.786 E F7(and)2.786 E F8(bsdi)2.786 E F7 2.786(,b)C(ut)
510.31 529.802 Q .023(using IPv4, not IPv6.)129.6 541.802 R 1.862 -.92(We c)
5.022 H .022(an tell this because the client's addr).92 F .022(esses r)-.18 F
.022(eturned by)-.18 F F8(accept)2.522 E F7(ar)129.6 553.802 Q 2.5(eb)-.18 G
(oth IPv4-mapped IPv6 addr)151.19 553.802 Q(esses.)-.18 E 1.047
(What we have just shown is that an IPv6 server r)147.6 565.802 R 1.048
(unning on a dual-stack host can)-.08 F 1.808
(handle either IPv4 or IPv6 clients.)129.6 577.802 R 1.808
(The IPv4 client addr)6.808 F 1.808(esses ar)-.18 F 4.308(ep)-.18 G 1.807
(assed to the IPv6)439.648 577.802 R(server as IPv4-mapped IPv6 addr)129.6
589.802 Q(ess, as we discussed in Section 10.2.)-.18 E .629(This server)147.6
613.802 R 3.129(,a)-.74 G .629(long with the client in Figur)207.088 613.802 R
3.129(e1)-.18 G .63(1.7, also work with Unix domain sock-)345.742 613.802 R
1.163(ets \(Chapter 14\) since our implementation of)129.6 625.802 R F8
(getaddrinfo)3.663 E F7 1.162(in Section 1)3.663 F 1.162(1.16 supports)-.55 F
(Unix domain sockets.)129.6 637.802 Q(For example, we start the server as)5 E
F3(solaris %)147.6 653.802 Q/F9 8.15/Courier-Bold@0 SF
(daytimetcpsrv2 /local /tmp/rendezvous)4.89 E/F10 7/Palatino-Roman@0 SF 1.75
<a943>233.453 676 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 293 21
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.10)-.495 E/F1 9/Courier@0 SF
(udp_client)394.23 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(293)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF
(wher)129.6 123 Q 3.866(et)-.18 G 1.366(he pathname)164.236 123 R/F4 10
/Courier@0 SF(/tmp/rendezvous)3.866 E F3 1.367
(is an arbitrary pathname we choose for the)3.866 F 1.251
(server to bind and to which the client connects.)129.6 135 R 3.091 -.92(We t)
6.251 H 1.25(hen start the client on the same).92 F(host, specifying)129.6 147
Q F4(/local)2.5 E F3(as the hostname and)2.5 E F4(/tmp/rendezvous)2.5 E F3
(as the service name.)2.5 E/F5 8.15/Courier@0 SF(solaris %)147.6 163 Q/F6 8.15
/Courier-Bold@0 SF(daytimetcpcli /tmp/rendezvous 0)4.89 E F5
(connected to /tmp/rendezvous)147.6 173 Q(Fri May 30 16:31:37 1997)147.6 183 Q
/F7 12/Helvetica-Bold@0 SF(11.10)93.6 225 Q/F8 12/Courier-Bold@0 SF(udp_client)
5.976 E F7(Function)6.672 E F3 2.394(Our functions that pr)129.6 249 R 2.394
(ovide a simpler interface to)-.18 F F4(getaddrinfo)4.895 E F3 2.395
(change with UDP)4.895 F 1.343(because we pr)129.6 261 R 1.343
(ovide one client function that cr)-.18 F 1.342
(eates an unconnected UDP socket, and)-.18 F
(another in the next section that cr)129.6 273 Q(eates a connected UDP socket.)
-.18 E F5(#include "unp.h")147.6 295 Q(int udp_client\(const char *)147.6 315 Q
/F9 8.15/Palatino-Italic@0 SF(hostname)A F5 4.89(,c)C(onst char *)325.539 315 Q
F9(service)A F5(,)A(void **)220.95 325 Q F9(saptr)A F5 4.89(,s)C(ocklen_t *)
286.598 325 Q F9(lenp)A F5(\);)A/F10 8.15/Palatino-Roman@0 SF
(Returns: unconnected socket descriptor if OK, no r)269.01 345 Q(eturn on err)
-.147 E(or)-.147 E 129.6 349.075 EBEGIN
0 66300 u neg rlineto 390000 u 0 rlineto 0 66300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 349.075 EBEGIN
0 -3.6 rlineto 0 59100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 59100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 10/Palatino-Roman@0 SF 2.451(This function cr)129.6 369 R 2.452
(eates an unconnected UDP socket, r)-.18 F 2.452(eturning thr)-.18 F 2.452
(ee items.)-.18 F 2.452(First, the)7.452 F -.18(re)129.6 381 S .53
(turn value is the socket descriptor).18 F 5.529(.S)-.74 G(econd,)303.178 381 Q
/F1 10/Palatino-Italic@0 SF(saptr)3.029 E F0 .529(is the addr)3.029 F .529
(ess of a pointer \(declar)-.18 F(ed)-.18 E .223
(by the caller\) to a socket addr)129.6 393 R .223(ess str)-.18 F(uctur)-.08 E
2.723(e\()-.18 G .224(allocated dynamically by)322.424 393 R/F2 10/Courier@0 SF
(udp_client)2.724 E F0 2.724(\)a)C(nd)507.67 393 Q .74(in that str)129.6 405 R
(uctur)-.08 E 3.24(et)-.18 G .74(he function stor)208.34 405 R .74
(es the destination IP addr)-.18 F .74(ess and port for futur)-.18 F 3.24(ec)
-.18 G(alls)504.54 405 Q(to)129.6 417 Q F2(sendto)2.885 E F0 5.385(.T)C .386
(he size of that socket addr)191.22 417 R .386(ess str)-.18 F(uctur)-.08 E
2.886(ei)-.18 G 2.886(sr)369.71 417 S .386(eturned in the variable pointed)
380.606 417 R 1.464(to by)129.6 429 R F1(lenp)3.964 E F0 6.464(.T)C 1.464
(his \214nal ar)189.662 429 R 1.464
(gument cannot be a null pointer \(as we allowed for the \214nal)-.18 F(ar)
129.6 441 Q 3.548(gument to)-.18 F F2(tcp_listen)6.048 E F0 6.048(\)b)C 3.548
(ecause the length of the socket addr)268.384 441 R 3.549(ess str)-.18 F(uctur)
-.08 E 6.049(ei)-.18 G(s)515.36 441 Q -.18(re)129.6 453 S(quir).18 E
(ed in any calls to)-.18 E F2(sendto)2.5 E F0(and)2.5 E F2(recvfrom)2.5 E F0(.)
A/F3 8/Courier@0 SF(saptr)183.6 473 Q/F4 8/Palatino-Roman@0 SF .763
(should be declar)2.763 F .763(ed as)-.144 F F3 -2.038(struct sockaddr **)2.762
F F4 4.762(.W)C 2.762(eu)388.204 473 S .762(se the)399.622 473 R F3 -2.038
(void **)2.762 F F4 .762(datatype because)2.762 F .683(we de\214ne another ver\
sion of this function that uses XTI in Section 31.3 and it uses this ar)183.6
483 R(gu-)-.144 E .025(ment to contain the addr)183.6 493 R .025
(ess of a pointer to a dif)-.144 F(fer)-.144 E .025(ent type of str)-.144 F
(uctur)-.064 E 2.025(e. This)-.144 F .024(means our calls to)2.025 F
(this function must contain the cast)183.6 503 Q F3 -2.8(\(void **\))2 F F4(.)A
F0(Figur)147.6 521 Q 2.5(e1)-.18 G(1.1)183.17 521 Q 2.5(1s)-.55 G
(hows the sour)206.86 521 Q(ce code for this function.)-.18 E F2(getaddrinfo)
147.6 533 Q F0 .916(converts the)3.416 F F1(hostname)3.416 E F0(and)3.416 E F1
(service)3.416 E F0(ar)3.416 E 3.416(guments. A)-.18 F .916(datagram socket is)
3.416 F(cr)129.6 545 Q 3.704(eated. Memory)-.18 F 1.203
(is allocated for one socket addr)3.704 F 1.203(ess str)-.18 F(uctur)-.08 E
3.703(ea)-.18 G 1.203(nd the socket addr)420.681 545 R(ess)-.18 E(str)129.6 557
Q(uctur)-.08 E 2.5(ec)-.18 G(orr)176.23 557 Q
(esponding to the socket that was cr)-.18 E(eated is copied into the memory)
-.18 E(.)-1.11 E/F5 10/Helvetica-Bold@0 SF(Example: Pr)93.6 581 Q(otocol)-.2 E
(-)-.9 I(Independent Da).9 I(ytime Client)-.2 E F0 2.657 -.92(We n)129.6 605 T
.817(ow r).92 F .818(ecode our daytime client fr)-.18 F .818(om Figur)-.18 F
3.318(e1)-.18 G .818(1.7 to use UDP and our)349.482 605 R F2(udp_client)3.318 E
F0 2.5(function. Figur)129.6 617 R 2.5(e1)-.18 G(1.12 shows the pr)209.74 617 Q
(otocol-independent sour)-.18 E(ce code.)-.18 E/F6 7/Courier-Oblique@0 SF
(11\21116)104.28 629 Q F0 3.339 -.92(We c)147.6 629 T 1.499(all our).92 F F2
(udp_client)3.999 E F0 1.499(function and then print the IP addr)3.999 F 1.498
(ess and port of the)-.18 F .543
(server to which we will send the UDP datagram.)129.6 641 R 2.383 -.92(We s)
5.543 H .544(end a 1).92 F(-)-.9 I .544(byte datagram and then).9 J -.18(re)
129.6 653 S(ad and print the r).18 E(eply)-.18 E(.)-1.11 E/F7 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 294 22
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(294)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 135.929 124.2 130.929 124.2 DL 140.929 124.2
135.929 124.2 DL 145.929 124.2 140.929 124.2 DL 150.929 124.2 145.929 124.2 DL
155.929 124.2 150.929 124.2 DL 160.929 124.2 155.929 124.2 DL 165.929 124.2
160.929 124.2 DL 170.929 124.2 165.929 124.2 DL 175.929 124.2 170.929 124.2 DL
180.929 124.2 175.929 124.2 DL 185.929 124.2 180.929 124.2 DL 190.929 124.2
185.929 124.2 DL 195.929 124.2 190.929 124.2 DL 200.929 124.2 195.929 124.2 DL
205.929 124.2 200.929 124.2 DL 210.929 124.2 205.929 124.2 DL 215.929 124.2
210.929 124.2 DL 220.929 124.2 215.929 124.2 DL 225.929 124.2 220.929 124.2 DL
230.929 124.2 225.929 124.2 DL 235.929 124.2 230.929 124.2 DL 240.929 124.2
235.929 124.2 DL 245.929 124.2 240.929 124.2 DL 250.929 124.2 245.929 124.2 DL
255.929 124.2 250.929 124.2 DL 260.929 124.2 255.929 124.2 DL 265.929 124.2
260.929 124.2 DL 270.929 124.2 265.929 124.2 DL 275.929 124.2 270.929 124.2 DL
280.929 124.2 275.929 124.2 DL 285.929 124.2 280.929 124.2 DL 290.929 124.2
285.929 124.2 DL 295.929 124.2 290.929 124.2 DL 300.929 124.2 295.929 124.2 DL
305.929 124.2 300.929 124.2 DL 310.929 124.2 305.929 124.2 DL 315.929 124.2
310.929 124.2 DL 320.929 124.2 315.929 124.2 DL 325.929 124.2 320.929 124.2 DL
330.929 124.2 325.929 124.2 DL 335.929 124.2 330.929 124.2 DL 340.929 124.2
335.929 124.2 DL 345.929 124.2 340.929 124.2 DL 350.929 124.2 345.929 124.2 DL
355.929 124.2 350.929 124.2 DL 360.929 124.2 355.929 124.2 DL 365.929 124.2
360.929 124.2 DL 370.929 124.2 365.929 124.2 DL 375.929 124.2 370.929 124.2 DL
380.929 124.2 375.929 124.2 DL 385.929 124.2 380.929 124.2 DL 390.929 124.2
385.929 124.2 DL 395.929 124.2 390.929 124.2 DL 400.929 124.2 395.929 124.2 DL
405.929 124.2 400.929 124.2 DL 410.929 124.2 405.929 124.2 DL 415.929 124.2
410.929 124.2 DL 420.929 124.2 415.929 124.2 DL 425.929 124.2 420.929 124.2 DL
430.929 124.2 425.929 124.2 DL 435.929 124.2 430.929 124.2 DL 440.929 124.2
435.929 124.2 DL 445.929 124.2 440.929 124.2 DL 450.929 124.2 445.929 124.2 DL
455.929 124.2 450.929 124.2 DL 460.929 124.2 455.929 124.2 DL/F2 9
/Palatino-Italic@0 SF(lib/udp_client.c)463.179 126.7 Q/F3 8.15/Courier@0 SF
4.89(1#)139.38 133.001 S 14.67(include "unp.h")154.05 133.001 R 4.89(2i)139.38
150.001 S(nt)154.05 150.001 Q 4.89(3u)139.38 160.001 S(dp_client\(const char *\
host, const char *serv, void **saptr, socklen_t *lenp\))154.05 160.001 Q 4.89
(4{)139.38 170.001 S 24.45(5i)139.38 180.001 S 19.56(nt sockfd,)173.61 180.001
R(n;)4.89 E 24.45(6s)139.38 190.001 S(truct addrinfo hints, *res, *ressave;)
173.61 190.001 Q 24.45(7b)139.38 207.001 S
(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 207.001 Q 24.45(8h)139.38
217.001 S(ints.ai_family = AF_UNSPEC;)173.61 217.001 Q 24.45(9h)139.38 227.001
S(ints.ai_socktype = SOCK_DGRAM;)173.61 227.001 Q 19.56(10 if)134.49 244.001 R
4.89(\(\()4.89 G 4.89(n=g)198.06 244.001 S
(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 244.001 Q 39.12
(11 err_quit\("udp_client)134.49 254.001 R(error for %s, %s: %s",)4.89 E 83.13
(12 host,)134.49 264.001 R(serv, gai_strerror\(n\)\);)4.89 E 19.56(13 ressave)
134.49 274.001 R 4.89(=r)4.89 G(es;)222.51 274.001 Q 19.56(14 do)134.49 291.001
R({)4.89 E 39.12(15 sockfd)134.49 301.001 R 4.89(=s)4.89 G
(ocket\(res->ai_family, res->ai_socktype, res->ai_protocol\);)237.18 301.001 Q
39.12(16 if)134.49 311.001 R(\(sockfd >= 0\))4.89 E 58.68(17 break;)134.49
321.001 R(/* success */)305.64 321.001 Q 19.56(18 })134.49 331.001 R
(while \( \(res = res->ai_next\) != NULL\);)4.89 E 19.56(19 if)134.49 348.001 R
(\(res == NULL\))4.89 E(/* errno set from final socket\(\) */)305.64 348.001 Q
39.12(20 err_sys\("udp_client)134.49 358.001 R
(error for %s, %s", host, serv\);)4.89 E 19.56(21 *saptr)134.49 375.001 R 4.89
(=M)4.89 G(alloc\(res->ai_addrlen\);)217.62 375.001 Q 19.56(22 memcpy\(*saptr,)
134.49 385.001 R(res->ai_addr, res->ai_addrlen\);)4.89 E 19.56(23 *lenp)134.49
395.001 R 4.89(=r)4.89 G(es->ai_addrlen;)212.73 395.001 Q 19.56
(24 freeaddrinfo\(ressave\);)134.49 412.001 R 19.56(25 return)134.49 429.001 R
(\(sockfd\);)4.89 E(26 })134.49 439.001 Q 134.6 443.802 129.6 443.802 DL
135.929 443.802 130.929 443.802 DL 140.929 443.802 135.929 443.802 DL 145.929
443.802 140.929 443.802 DL 150.929 443.802 145.929 443.802 DL 155.929 443.802
150.929 443.802 DL 160.929 443.802 155.929 443.802 DL 165.929 443.802 160.929
443.802 DL 170.929 443.802 165.929 443.802 DL 175.929 443.802 170.929 443.802
DL 180.929 443.802 175.929 443.802 DL 185.929 443.802 180.929 443.802 DL
190.929 443.802 185.929 443.802 DL 195.929 443.802 190.929 443.802 DL 200.929
443.802 195.929 443.802 DL 205.929 443.802 200.929 443.802 DL 210.929 443.802
205.929 443.802 DL 215.929 443.802 210.929 443.802 DL 220.929 443.802 215.929
443.802 DL 225.929 443.802 220.929 443.802 DL 230.929 443.802 225.929 443.802
DL 235.929 443.802 230.929 443.802 DL 240.929 443.802 235.929 443.802 DL
245.929 443.802 240.929 443.802 DL 250.929 443.802 245.929 443.802 DL 255.929
443.802 250.929 443.802 DL 260.929 443.802 255.929 443.802 DL 265.929 443.802
260.929 443.802 DL 270.929 443.802 265.929 443.802 DL 275.929 443.802 270.929
443.802 DL 280.929 443.802 275.929 443.802 DL 285.929 443.802 280.929 443.802
DL 290.929 443.802 285.929 443.802 DL 295.929 443.802 290.929 443.802 DL
300.929 443.802 295.929 443.802 DL 305.929 443.802 300.929 443.802 DL 310.929
443.802 305.929 443.802 DL 315.929 443.802 310.929 443.802 DL 320.929 443.802
315.929 443.802 DL 325.929 443.802 320.929 443.802 DL 330.929 443.802 325.929
443.802 DL 335.929 443.802 330.929 443.802 DL 340.929 443.802 335.929 443.802
DL 345.929 443.802 340.929 443.802 DL 350.929 443.802 345.929 443.802 DL
355.929 443.802 350.929 443.802 DL 360.929 443.802 355.929 443.802 DL 365.929
443.802 360.929 443.802 DL 370.929 443.802 365.929 443.802 DL 375.929 443.802
370.929 443.802 DL 380.929 443.802 375.929 443.802 DL 385.929 443.802 380.929
443.802 DL 390.929 443.802 385.929 443.802 DL 395.929 443.802 390.929 443.802
DL 400.929 443.802 395.929 443.802 DL 405.929 443.802 400.929 443.802 DL
410.929 443.802 405.929 443.802 DL 415.929 443.802 410.929 443.802 DL 420.929
443.802 415.929 443.802 DL 425.929 443.802 420.929 443.802 DL 430.929 443.802
425.929 443.802 DL 435.929 443.802 430.929 443.802 DL 440.929 443.802 435.929
443.802 DL 445.929 443.802 440.929 443.802 DL 450.929 443.802 445.929 443.802
DL 455.929 443.802 450.929 443.802 DL 460.929 443.802 455.929 443.802 DL F2
(lib/udp_client.c)463.179 446.302 Q/F4 8/Palatino-Bold@0 SF(Figure 1)196.104
459.802 Q(1.1)-.296 E(1)-.296 E/F5 8/Courier@0 SF(udp_client)6 E/F6 8
/Palatino-Roman@0 SF(function: cr)2 E(eate an unconnected UDP socket.)-.144 E
1.899 -.736(We n)183.6 493.802 T .426(eed to send only a 0).736 F(-)-.72 I .426
(byte UDP datagram, as what triggers the daytime server).72 J .426('s r).592 F
(esponse)-.144 E .482(is just the arrival of a datagram, r)183.6 503.802 R
(egar)-.144 E .482(dless of its length and contents.)-.144 F .482
(But many SVR4 imple-)4.482 F(mentations do not allow a 0)183.6 513.802 Q(-)
-.72 I(length UDP datagram.).72 I/F7 10/Palatino-Roman@0 SF 2.395 -.92(We r)
147.6 531.802 T .555(un our client specifying a hostname that has a AAAA r).84
F(ecor)-.18 E 3.054(da)-.18 G .554(nd an A r)449.068 531.802 R(ecor)-.18 E(d.)
-.18 E 1.033(Since the str)129.6 543.802 R(uctur)-.08 E 3.533(ew)-.18 G 1.033
(ith the AAAA r)225.309 543.802 R(ecor)-.18 E 3.533(di)-.18 G 3.533(sr)327.671
543.802 S 1.033(eturned \214rst by)339.214 543.802 R/F8 10/Courier@0 SF
(getaddrinfo)3.533 E F7 3.533(,a)C 3.534(nI)490.186 543.802 S(Pv6)502.91
543.802 Q(socket is cr)129.6 555.802 Q(eated.)-.18 E F3(solaris %)147.6 571.802
Q/F9 8.15/Courier-Bold@0 SF(daytimeudpcli1 aix daytime)4.89 E F3
(sending to 5f1b:df00:ce3e:e200:20:800:5afc:2b36)147.6 581.802 Q
(Sat May 31 08:13:34 1997)147.6 591.802 Q F7 2.341
(Next we specify the dotted-decimal addr)129.6 609.802 R 2.341
(ess of the same host, r)-.18 F 2.34(esulting in an IPv4)-.18 F(socket.)129.6
621.802 Q F3(solaris %)147.6 637.802 Q F9(daytimeudpcli1 206.62.226.43 daytime)
4.89 E F3(sending to 206.62.226.43)147.6 647.802 Q(Sat May 31 08:14:02 1997)
147.6 657.802 Q/F10 7/Palatino-Roman@0 SF 1.75<a943>233.453 676 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 295 23
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.1)-.495 E(1)-.495 E/F1 9
/Courier@0 SF(udp_connect)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF
(295)506.1 82 Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2
99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6
89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2
DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4 LW 134.6 124.2 129.6 124.2
DL 139.6 124.2 134.6 124.2 DL 144.6 124.2 139.6 124.2 DL 149.6 124.2 144.6
124.2 DL 154.6 124.2 149.6 124.2 DL 159.6 124.2 154.6 124.2 DL 164.6 124.2
159.6 124.2 DL 169.6 124.2 164.6 124.2 DL 174.6 124.2 169.6 124.2 DL 179.6
124.2 174.6 124.2 DL 184.6 124.2 179.6 124.2 DL 189.6 124.2 184.6 124.2 DL
194.6 124.2 189.6 124.2 DL 199.6 124.2 194.6 124.2 DL 204.6 124.2 199.6 124.2
DL 209.6 124.2 204.6 124.2 DL 214.6 124.2 209.6 124.2 DL 219.6 124.2 214.6
124.2 DL 224.6 124.2 219.6 124.2 DL 229.6 124.2 224.6 124.2 DL 234.6 124.2
229.6 124.2 DL 239.6 124.2 234.6 124.2 DL 244.6 124.2 239.6 124.2 DL 249.6
124.2 244.6 124.2 DL 254.6 124.2 249.6 124.2 DL 259.6 124.2 254.6 124.2 DL
264.6 124.2 259.6 124.2 DL 269.6 124.2 264.6 124.2 DL 274.6 124.2 269.6 124.2
DL 279.6 124.2 274.6 124.2 DL 284.6 124.2 279.6 124.2 DL 289.6 124.2 284.6
124.2 DL 294.6 124.2 289.6 124.2 DL 299.6 124.2 294.6 124.2 DL 304.6 124.2
299.6 124.2 DL 309.6 124.2 304.6 124.2 DL 314.6 124.2 309.6 124.2 DL 319.6
124.2 314.6 124.2 DL 324.6 124.2 319.6 124.2 DL 329.6 124.2 324.6 124.2 DL
334.6 124.2 329.6 124.2 DL 339.6 124.2 334.6 124.2 DL 344.6 124.2 339.6 124.2
DL 349.6 124.2 344.6 124.2 DL 354.6 124.2 349.6 124.2 DL 359.6 124.2 354.6
124.2 DL 364.6 124.2 359.6 124.2 DL 369.6 124.2 364.6 124.2 DL 374.6 124.2
369.6 124.2 DL 379.6 124.2 374.6 124.2 DL 384.6 124.2 379.6 124.2 DL 389.6
124.2 384.6 124.2 DL 394.6 124.2 389.6 124.2 DL 399.6 124.2 394.6 124.2 DL
404.6 124.2 399.6 124.2 DL 409.6 124.2 404.6 124.2 DL 414.6 124.2 409.6 124.2
DL 419.6 124.2 414.6 124.2 DL 424.6 124.2 419.6 124.2 DL 429.6 124.2 424.6
124.2 DL/F3 9/Palatino-Italic@0 SF(names/daytimeudpcli1.c)431.85 126.7 Q/F4
8.15/Courier@0 SF 4.89(1#)139.38 133.001 S 14.67(include "unp.h")154.05 133.001
R 4.89(2i)139.38 151.001 S(nt)154.05 151.001 Q 4.89(3m)139.38 161.001 S
(ain\(int argc, char **argv\))154.05 161.001 Q 4.89(4{)139.38 171.001 S 24.45
(5i)139.38 181.001 S 19.56(nt sockfd,)173.61 181.001 R(n;)4.89 E 24.45(6c)
139.38 191.001 S 14.67(har recvline[MAXLINE)173.61 191.001 R 4.89(+1)4.89 G(];)
305.64 191.001 Q 24.45(7s)139.38 201.001 S(ocklen_t salen;)173.61 201.001 Q
24.45(8s)139.38 211.001 S(truct sockaddr *sa;)173.61 211.001 Q 24.45(9i)139.38
229.001 S 4.89(f\()173.61 229.001 S(argc != 3\))188.28 229.001 Q 39.12
(10 err_quit\("usage:)134.49 239.001 R
(daytimeudpcli1 <hostname/IPaddress> <service/port#>"\);)4.89 E 19.56
(11 sockfd)134.49 257.001 R 4.89(=U)4.89 G
(dp_client\(argv[1], argv[2], \(void **\) &sa, &salen\);)217.62 257.001 Q 19.56
(12 printf\("sending)134.49 275.001 R
(to %s\\n", Sock_ntop_host\(sa, salen\)\);)4.89 E 19.56(13 Sendto\(sockfd,)
134.49 293.001 R("", 1, 0, sa, salen\);)4.89 E(/* send 1-byte datagram */)
364.32 293.001 Q 19.56(14 n)134.49 311.001 R 4.89(=R)4.89 G
(ecvfrom\(sockfd, recvline, MAXLINE, 0, NULL, NULL\);)193.17 311.001 Q 19.56
(15 recvline[n])134.49 321.001 R 4.89(=0)4.89 G 58.68(;/)242.07 321.001 S 4.89
(*n)310.53 321.001 S(ull terminate */)325.2 321.001 Q 19.56
(16 Fputs\(recvline,)134.49 331.001 R(stdout\);)4.89 E 19.56(17 exit\(0\);)
134.49 349.001 R(18 })134.49 359.001 Q 134.6 363.802 129.6 363.802 DL 139.6
363.802 134.6 363.802 DL 144.6 363.802 139.6 363.802 DL 149.6 363.802 144.6
363.802 DL 154.6 363.802 149.6 363.802 DL 159.6 363.802 154.6 363.802 DL 164.6
363.802 159.6 363.802 DL 169.6 363.802 164.6 363.802 DL 174.6 363.802 169.6
363.802 DL 179.6 363.802 174.6 363.802 DL 184.6 363.802 179.6 363.802 DL 189.6
363.802 184.6 363.802 DL 194.6 363.802 189.6 363.802 DL 199.6 363.802 194.6
363.802 DL 204.6 363.802 199.6 363.802 DL 209.6 363.802 204.6 363.802 DL 214.6
363.802 209.6 363.802 DL 219.6 363.802 214.6 363.802 DL 224.6 363.802 219.6
363.802 DL 229.6 363.802 224.6 363.802 DL 234.6 363.802 229.6 363.802 DL 239.6
363.802 234.6 363.802 DL 244.6 363.802 239.6 363.802 DL 249.6 363.802 244.6
363.802 DL 254.6 363.802 249.6 363.802 DL 259.6 363.802 254.6 363.802 DL 264.6
363.802 259.6 363.802 DL 269.6 363.802 264.6 363.802 DL 274.6 363.802 269.6
363.802 DL 279.6 363.802 274.6 363.802 DL 284.6 363.802 279.6 363.802 DL 289.6
363.802 284.6 363.802 DL 294.6 363.802 289.6 363.802 DL 299.6 363.802 294.6
363.802 DL 304.6 363.802 299.6 363.802 DL 309.6 363.802 304.6 363.802 DL 314.6
363.802 309.6 363.802 DL 319.6 363.802 314.6 363.802 DL 324.6 363.802 319.6
363.802 DL 329.6 363.802 324.6 363.802 DL 334.6 363.802 329.6 363.802 DL 339.6
363.802 334.6 363.802 DL 344.6 363.802 339.6 363.802 DL 349.6 363.802 344.6
363.802 DL 354.6 363.802 349.6 363.802 DL 359.6 363.802 354.6 363.802 DL 364.6
363.802 359.6 363.802 DL 369.6 363.802 364.6 363.802 DL 374.6 363.802 369.6
363.802 DL 379.6 363.802 374.6 363.802 DL 384.6 363.802 379.6 363.802 DL 389.6
363.802 384.6 363.802 DL 394.6 363.802 389.6 363.802 DL 399.6 363.802 394.6
363.802 DL 404.6 363.802 399.6 363.802 DL 409.6 363.802 404.6 363.802 DL 414.6
363.802 409.6 363.802 DL 419.6 363.802 414.6 363.802 DL 424.6 363.802 419.6
363.802 DL 429.6 363.802 424.6 363.802 DL F3(names/daytimeudpcli1.c)431.85
366.302 Q/F5 8/Palatino-Bold@0 SF(Figure 1)205.28 379.802 Q(1.12)-.296 E/F6 8
/Palatino-Roman@0 SF(UDP daytime client using our)6 E/F7 8/Courier@0 SF
(udp_client)2 E F6(function.)2 E/F8 12/Helvetica-Bold@0 SF(11.11)93.6 463.802 Q
/F9 12/Courier-Bold@0 SF(udp_connect)5.976 E F8(Function)6.672 E/F10 10
/Palatino-Roman@0 SF(Our)129.6 487.802 Q/F11 10/Courier@0 SF(udp_connect)2.5 E
F10(function cr)2.5 E(eates a connected UDP socket.)-.18 E F4(#include "unp.h")
147.6 509.802 Q(int udp_connect\(const char *)147.6 529.802 Q/F12 8.15
/Palatino-Italic@0 SF(hostname)A F4 4.89(,c)C(onst char *)330.429 529.802 Q F12
(service)A F4(\);)A/F13 8.15/Palatino-Roman@0 SF
(Returns: connected socket descriptor if OK, no r)278.667 549.802 Q
(eturn on err)-.147 E(or)-.147 E 129.6 553.877 EBEGIN
0 56300 u neg rlineto 390000 u 0 rlineto 0 56300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 553.877 EBEGIN
0 -3.6 rlineto 0 49100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 49100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 10/Palatino-Roman@0 SF -.55(Wi)129.6 573.802 S .393
(th a connected UDP socket the \214nal two ar).55 F .393(guments r)-.18 F
(equir)-.18 E .393(ed by)-.18 F/F1 10/Courier@0 SF(udp_client)2.893 E F0(ar)
2.893 E 2.894(en)-.18 G(o)514.14 573.802 Q .726(longer needed.)129.6 585.802 R
.726(The caller can call)5.726 F F1(write)3.226 E F0 .726(instead of)3.226 F F1
(sendto)3.226 E F0 3.226(,s)C 3.225(oo)412.68 585.802 S .725
(ur function need not)426.825 585.802 R -.18(re)129.6 597.802 S
(turn a socket addr).18 E(ess str)-.18 E(uctur)-.08 E 2.5(ea)-.18 G
(nd its length.)281.42 597.802 Q(Figur)147.6 609.802 Q 2.5(e1)-.18 G
(1.13 shows the sour)183.17 609.802 Q(ce code.)-.18 E .487
(This function is nearly identical to)147.6 621.802 R F1(tcp_connect)2.987 E F0
5.487(.O)C .487(ne dif)385.589 621.802 R(fer)-.18 E .488(ence, however)-.18 F
2.988(,i)-.74 G 2.988(st)495.032 621.802 S(hat)505.52 621.802 Q 1.245
(the call to)129.6 633.802 R F1(connect)3.745 E F0 1.245
(with a UDP socket does not send anything to the peer)3.745 F 6.245(.I)-.74 G
3.745(fs)485.875 633.802 S(ome-)497.19 633.802 Q .953(thing is wr)129.6 645.802
R .953(ong \(the peer is unr)-.18 F .953(eachable or ther)-.18 F 3.453(ei)-.18
G 3.453(sn)352.687 645.802 S 3.453(os)366.2 645.802 S .953
(erver at the speci\214ed port\), the)379.353 645.802 R
(caller does not discover that until it sends a datagram to the peer)129.6
657.802 Q(.)-.74 E/F2 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 296 24
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(296)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 138.27 124.2 133.27 124.2 DL 143.27 124.2 138.27
124.2 DL 148.27 124.2 143.27 124.2 DL 153.27 124.2 148.27 124.2 DL 158.27 124.2
153.27 124.2 DL 163.27 124.2 158.27 124.2 DL 168.27 124.2 163.27 124.2 DL
173.27 124.2 168.27 124.2 DL 178.27 124.2 173.27 124.2 DL 183.27 124.2 178.27
124.2 DL 188.27 124.2 183.27 124.2 DL 193.27 124.2 188.27 124.2 DL 198.27 124.2
193.27 124.2 DL 203.27 124.2 198.27 124.2 DL 208.27 124.2 203.27 124.2 DL
213.27 124.2 208.27 124.2 DL 218.27 124.2 213.27 124.2 DL 223.27 124.2 218.27
124.2 DL 228.27 124.2 223.27 124.2 DL 233.27 124.2 228.27 124.2 DL 238.27 124.2
233.27 124.2 DL 243.27 124.2 238.27 124.2 DL 248.27 124.2 243.27 124.2 DL
253.27 124.2 248.27 124.2 DL 258.27 124.2 253.27 124.2 DL 263.27 124.2 258.27
124.2 DL 268.27 124.2 263.27 124.2 DL 273.27 124.2 268.27 124.2 DL 278.27 124.2
273.27 124.2 DL 283.27 124.2 278.27 124.2 DL 288.27 124.2 283.27 124.2 DL
293.27 124.2 288.27 124.2 DL 298.27 124.2 293.27 124.2 DL 303.27 124.2 298.27
124.2 DL 308.27 124.2 303.27 124.2 DL 313.27 124.2 308.27 124.2 DL 318.27 124.2
313.27 124.2 DL 323.27 124.2 318.27 124.2 DL 328.27 124.2 323.27 124.2 DL
333.27 124.2 328.27 124.2 DL 338.27 124.2 333.27 124.2 DL 343.27 124.2 338.27
124.2 DL 348.27 124.2 343.27 124.2 DL 353.27 124.2 348.27 124.2 DL 358.27 124.2
353.27 124.2 DL 363.27 124.2 358.27 124.2 DL 368.27 124.2 363.27 124.2 DL
373.27 124.2 368.27 124.2 DL 378.27 124.2 373.27 124.2 DL 383.27 124.2 378.27
124.2 DL 388.27 124.2 383.27 124.2 DL 393.27 124.2 388.27 124.2 DL 398.27 124.2
393.27 124.2 DL 403.27 124.2 398.27 124.2 DL 408.27 124.2 403.27 124.2 DL
413.27 124.2 408.27 124.2 DL 418.27 124.2 413.27 124.2 DL 423.27 124.2 418.27
124.2 DL 428.27 124.2 423.27 124.2 DL 433.27 124.2 428.27 124.2 DL 438.27 124.2
433.27 124.2 DL 443.27 124.2 438.27 124.2 DL 448.27 124.2 443.27 124.2 DL
453.27 124.2 448.27 124.2 DL/F2 9/Palatino-Italic@0 SF(lib/udp_connect.c)455.52
126.7 Q/F3 8.15/Courier@0 SF 4.89(1#)139.38 133.001 S 14.67(include "unp.h")
154.05 133.001 R 4.89(2i)139.38 150.001 S(nt)154.05 150.001 Q 4.89(3u)139.38
160.001 S(dp_connect\(const char *host, const char *serv\))154.05 160.001 Q
4.89(4{)139.38 170.001 S 24.45(5i)139.38 180.001 S 19.56(nt sockfd,)173.61
180.001 R(n;)4.89 E 24.45(6s)139.38 190.001 S
(truct addrinfo hints, *res, *ressave;)173.61 190.001 Q 24.45(7b)139.38 207.001
S(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 207.001 Q 24.45(8h)139.38
217.001 S(ints.ai_family = AF_UNSPEC;)173.61 217.001 Q 24.45(9h)139.38 227.001
S(ints.ai_socktype = SOCK_DGRAM;)173.61 227.001 Q 19.56(10 if)134.49 244.001 R
4.89(\(\()4.89 G 4.89(n=g)198.06 244.001 S
(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 244.001 Q 39.12
(11 err_quit\("udp_connect)134.49 254.001 R(error for %s, %s: %s",)4.89 E 83.13
(12 host,)134.49 264.001 R(serv, gai_strerror\(n\)\);)4.89 E 19.56(13 ressave)
134.49 274.001 R 4.89(=r)4.89 G(es;)222.51 274.001 Q 19.56(14 do)134.49 291.001
R({)4.89 E 39.12(15 sockfd)134.49 301.001 R 4.89(=s)4.89 G
(ocket\(res->ai_family, res->ai_socktype, res->ai_protocol\);)237.18 301.001 Q
39.12(16 if)134.49 311.001 R(\(sockfd < 0\))4.89 E 58.68(17 continue;)134.49
321.001 R(/* ignore this one */)305.64 321.001 Q 39.12(18 if)134.49 338.001 R
(\(connect\(sockfd, res->ai_addr, res->ai_addrlen\) == 0\))4.89 E 58.68
(19 break;)134.49 348.001 R(/* success */)305.64 348.001 Q 39.12
(20 Close\(sockfd\);)134.49 365.001 R(/* ignore this one */)305.64 365.001 Q
19.56(21 })134.49 375.001 R(while \( \(res = res->ai_next\) != NULL\);)4.89 E
19.56(22 if)134.49 392.001 R(\(res == NULL\))4.89 E
(/* errno set from final connect\(\) */)305.64 392.001 Q 39.12
(23 err_sys\("udp_connect)134.49 402.001 R(error for %s, %s", host, serv\);)
4.89 E 19.56(24 freeaddrinfo\(ressave\);)134.49 419.001 R 19.56(25 return)
134.49 436.001 R(\(sockfd\);)4.89 E(26 })134.49 446.001 Q 134.6 450.802 129.6
450.802 DL 138.27 450.802 133.27 450.802 DL 143.27 450.802 138.27 450.802 DL
148.27 450.802 143.27 450.802 DL 153.27 450.802 148.27 450.802 DL 158.27
450.802 153.27 450.802 DL 163.27 450.802 158.27 450.802 DL 168.27 450.802
163.27 450.802 DL 173.27 450.802 168.27 450.802 DL 178.27 450.802 173.27
450.802 DL 183.27 450.802 178.27 450.802 DL 188.27 450.802 183.27 450.802 DL
193.27 450.802 188.27 450.802 DL 198.27 450.802 193.27 450.802 DL 203.27
450.802 198.27 450.802 DL 208.27 450.802 203.27 450.802 DL 213.27 450.802
208.27 450.802 DL 218.27 450.802 213.27 450.802 DL 223.27 450.802 218.27
450.802 DL 228.27 450.802 223.27 450.802 DL 233.27 450.802 228.27 450.802 DL
238.27 450.802 233.27 450.802 DL 243.27 450.802 238.27 450.802 DL 248.27
450.802 243.27 450.802 DL 253.27 450.802 248.27 450.802 DL 258.27 450.802
253.27 450.802 DL 263.27 450.802 258.27 450.802 DL 268.27 450.802 263.27
450.802 DL 273.27 450.802 268.27 450.802 DL 278.27 450.802 273.27 450.802 DL
283.27 450.802 278.27 450.802 DL 288.27 450.802 283.27 450.802 DL 293.27
450.802 288.27 450.802 DL 298.27 450.802 293.27 450.802 DL 303.27 450.802
298.27 450.802 DL 308.27 450.802 303.27 450.802 DL 313.27 450.802 308.27
450.802 DL 318.27 450.802 313.27 450.802 DL 323.27 450.802 318.27 450.802 DL
328.27 450.802 323.27 450.802 DL 333.27 450.802 328.27 450.802 DL 338.27
450.802 333.27 450.802 DL 343.27 450.802 338.27 450.802 DL 348.27 450.802
343.27 450.802 DL 353.27 450.802 348.27 450.802 DL 358.27 450.802 353.27
450.802 DL 363.27 450.802 358.27 450.802 DL 368.27 450.802 363.27 450.802 DL
373.27 450.802 368.27 450.802 DL 378.27 450.802 373.27 450.802 DL 383.27
450.802 378.27 450.802 DL 388.27 450.802 383.27 450.802 DL 393.27 450.802
388.27 450.802 DL 398.27 450.802 393.27 450.802 DL 403.27 450.802 398.27
450.802 DL 408.27 450.802 403.27 450.802 DL 413.27 450.802 408.27 450.802 DL
418.27 450.802 413.27 450.802 DL 423.27 450.802 418.27 450.802 DL 428.27
450.802 423.27 450.802 DL 433.27 450.802 428.27 450.802 DL 438.27 450.802
433.27 450.802 DL 443.27 450.802 438.27 450.802 DL 448.27 450.802 443.27
450.802 DL 453.27 450.802 448.27 450.802 DL F2(lib/udp_connect.c)455.52 453.302
Q/F4 8/Palatino-Bold@0 SF(Figure 1)200.624 466.802 Q(1.13)-.296 E/F5 8
/Courier@0 SF(udp_connect)6 E/F6 8/Palatino-Roman@0 SF(function: cr)2 E
(eate a connected UDP socket.)-.144 E/F7 12/Helvetica-Bold@0 SF(11.12)93.6
500.402 Q/F8 12/Courier-Bold@0 SF(udp_server)5.976 E F7(Function)6.672 E/F9 10
/Palatino-Roman@0 SF 4.652(Our \214nal UDP function that pr)129.6 524.402 R
4.652(ovides a simpler interface to)-.18 F/F10 10/Courier@0 SF(getaddrinfo)
7.151 E F9(is)7.151 E F10(udp_server)129.6 536.402 Q F9(.)A F3
(#include "unp.h")147.6 558.402 Q(int udp_server\(const char *)147.6 578.402 Q
/F11 8.15/Palatino-Italic@0 SF(hostname)A F3 4.89(,c)C(onst char *)325.539
578.402 Q F11(service)A F3 4.89(,s)C(ocklen_t *)416.337 578.402 Q F11(lenptr)A
F3(\);)A/F12 8.15/Palatino-Roman@0 SF
(Returns: unconnected socket descriptor if OK, no r)269.01 598.402 Q
(eturn on err)-.147 E(or)-.147 E 129.6 602.477 EBEGIN
0 56300 u neg rlineto 390000 u 0 rlineto 0 56300 u rlineto 390000 u neg 0 rlineto [3] 0 setdash 0.5 setlinewidth stroke [] 0 setdash
EEND 129.6 602.477 EBEGIN
0 -3.6 rlineto 0 49100 u neg rmoveto 0 -3.6 rlineto 3.6 0 rlineto 382800 u 0 rmoveto 3.6 0 rlineto 0 3.6 rlineto 0 49100 u rmoveto 0 3.6 rlineto -3.6 0 rlineto 382800 u neg 0 rmoveto -3.6 0 rlineto 0.5 setlinewidth stroke
EEND/F0 10/Palatino-Roman@0 SF .002(The ar)129.6 622.402 R .002(guments ar)-.18
F 2.502(et)-.18 G .002(he same as for)217.966 622.402 R/F1 10/Courier@0 SF
(tcp_listen)2.502 E F0 2.502(:a)C 2.502(no)353.426 622.402 S(ptional)367.208
622.402 Q/F2 10/Palatino-Italic@0 SF(hostname)2.503 E F0 2.503(,ar)C(equir)
455.687 622.402 Q(ed)-.18 E F2(service)2.503 E F0 1.025(\(so its port number c\
an be bound\), and an optional pointer to a variable in which the)129.6 634.402
R(size of the socket addr)129.6 646.402 Q(ess str)-.18 E(uctur)-.08 E 2.5(ei)
-.18 G 2.5(sr)288.81 646.402 S(eturned.)299.32 646.402 Q(Figur)147.6 658.402 Q
2.5(e1)-.18 G(1.14 shows the sour)183.17 658.402 Q(ce code.)-.18 E/F3 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 297 25
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.12)-.495 E/F1 9/Courier@0 SF
(udp_server)394.23 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(297)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4 LW 134.6 123 129.6 123 DL
134.759 123 129.759 123 DL 139.759 123 134.759 123 DL 144.759 123 139.759 123
DL 149.759 123 144.759 123 DL 154.759 123 149.759 123 DL 159.759 123 154.759
123 DL 164.759 123 159.759 123 DL 169.759 123 164.759 123 DL 174.759 123
169.759 123 DL 179.759 123 174.759 123 DL 184.759 123 179.759 123 DL 189.759
123 184.759 123 DL 194.759 123 189.759 123 DL 199.759 123 194.759 123 DL
204.759 123 199.759 123 DL 209.759 123 204.759 123 DL 214.759 123 209.759 123
DL 219.759 123 214.759 123 DL 224.759 123 219.759 123 DL 229.759 123 224.759
123 DL 234.759 123 229.759 123 DL 239.759 123 234.759 123 DL 244.759 123
239.759 123 DL 249.759 123 244.759 123 DL 254.759 123 249.759 123 DL 259.759
123 254.759 123 DL 264.759 123 259.759 123 DL 269.759 123 264.759 123 DL
274.759 123 269.759 123 DL 279.759 123 274.759 123 DL 284.759 123 279.759 123
DL 289.759 123 284.759 123 DL 294.759 123 289.759 123 DL 299.759 123 294.759
123 DL 304.759 123 299.759 123 DL 309.759 123 304.759 123 DL 314.759 123
309.759 123 DL 319.759 123 314.759 123 DL 324.759 123 319.759 123 DL 329.759
123 324.759 123 DL 334.759 123 329.759 123 DL 339.759 123 334.759 123 DL
344.759 123 339.759 123 DL 349.759 123 344.759 123 DL 354.759 123 349.759 123
DL 359.759 123 354.759 123 DL 364.759 123 359.759 123 DL 369.759 123 364.759
123 DL 374.759 123 369.759 123 DL 379.759 123 374.759 123 DL 384.759 123
379.759 123 DL 389.759 123 384.759 123 DL 394.759 123 389.759 123 DL 399.759
123 394.759 123 DL 404.759 123 399.759 123 DL 409.759 123 404.759 123 DL
414.759 123 409.759 123 DL 419.759 123 414.759 123 DL 424.759 123 419.759 123
DL 429.759 123 424.759 123 DL 434.759 123 429.759 123 DL 439.759 123 434.759
123 DL 444.759 123 439.759 123 DL 449.759 123 444.759 123 DL 454.759 123
449.759 123 DL 459.759 123 454.759 123 DL/F3 9/Palatino-Italic@0 SF
(lib/udp_server)462.009 125.5 Q(.c)-.666 E/F4 8.15/Courier@0 SF 4.89(1#)139.38
131.801 S 14.67(include "unp.h")154.05 131.801 R 4.89(2i)139.38 148.801 S(nt)
154.05 148.801 Q 4.89(3u)139.38 158.801 S
(dp_server\(const char *host, const char *serv, socklen_t *addrlenp\))154.05
158.801 Q 4.89(4{)139.38 168.801 S 24.45(5i)139.38 178.801 S 19.56(nt sockfd,)
173.61 178.801 R(n;)4.89 E 24.45(6s)139.38 188.801 S
(truct addrinfo hints, *res, *ressave;)173.61 188.801 Q 24.45(7b)139.38 205.801
S(zero\(&hints, sizeof\(struct addrinfo\)\);)173.61 205.801 Q 24.45(8h)139.38
215.801 S(ints.ai_flags = AI_PASSIVE;)173.61 215.801 Q 24.45(9h)139.38 225.801
S(ints.ai_family = AF_UNSPEC;)173.61 225.801 Q 19.56(10 hints.ai_socktype)
134.49 235.801 R 4.89(=S)4.89 G(OCK_DGRAM;)271.41 235.801 Q 19.56(11 if)134.49
252.801 R 4.89(\(\()4.89 G 4.89(n=g)198.06 252.801 S
(etaddrinfo\(host, serv, &hints, &res\)\) != 0\))222.51 252.801 Q 39.12
(12 err_quit\("udp_server)134.49 262.801 R(error for %s, %s: %s",)4.89 E 83.13
(13 host,)134.49 272.801 R(serv, gai_strerror\(n\)\);)4.89 E 19.56(14 ressave)
134.49 282.801 R 4.89(=r)4.89 G(es;)222.51 282.801 Q 19.56(15 do)134.49 299.801
R({)4.89 E 39.12(16 sockfd)134.49 309.801 R 4.89(=s)4.89 G
(ocket\(res->ai_family, res->ai_socktype, res->ai_protocol\);)237.18 309.801 Q
39.12(17 if)134.49 319.801 R(\(sockfd < 0\))4.89 E 58.68(18 continue;)134.49
329.801 R(/* error, try next one */)305.64 329.801 Q 39.12(19 if)134.49 346.801
R(\(bind\(sockfd, res->ai_addr, res->ai_addrlen\) == 0\))4.89 E 58.68
(20 break;)134.49 356.801 R(/* success */)305.64 356.801 Q 39.12
(21 Close\(sockfd\);)134.49 373.801 R(/* bind error, close and try next one */)
305.64 373.801 Q 19.56(22 })134.49 383.801 R
(while \( \(res = res->ai_next\) != NULL\);)4.89 E 19.56(23 if)134.49 400.801 R
(\(res == NULL\))4.89 E(/* errno from final socket\(\) or bind\(\) */)305.64
400.801 Q 39.12(24 err_sys\("udp_server)134.49 410.801 R
(error for %s, %s", host, serv\);)4.89 E 19.56(25 if)134.49 427.801 R
(\(addrlenp\))4.89 E 39.12(26 *addrlenp)134.49 437.801 R 4.89(=r)4.89 G 14.67
(es->ai_addrlen; /*)251.85 437.801 R(return size of protocol address */)4.89 E
19.56(27 freeaddrinfo\(ressave\);)134.49 454.801 R 19.56(28 return)134.49
471.801 R(\(sockfd\);)4.89 E(29 })134.49 481.801 Q 134.6 486.602 129.6 486.602
DL 134.759 486.602 129.759 486.602 DL 139.759 486.602 134.759 486.602 DL
144.759 486.602 139.759 486.602 DL 149.759 486.602 144.759 486.602 DL 154.759
486.602 149.759 486.602 DL 159.759 486.602 154.759 486.602 DL 164.759 486.602
159.759 486.602 DL 169.759 486.602 164.759 486.602 DL 174.759 486.602 169.759
486.602 DL 179.759 486.602 174.759 486.602 DL 184.759 486.602 179.759 486.602
DL 189.759 486.602 184.759 486.602 DL 194.759 486.602 189.759 486.602 DL
199.759 486.602 194.759 486.602 DL 204.759 486.602 199.759 486.602 DL 209.759
486.602 204.759 486.602 DL 214.759 486.602 209.759 486.602 DL 219.759 486.602
214.759 486.602 DL 224.759 486.602 219.759 486.602 DL 229.759 486.602 224.759
486.602 DL 234.759 486.602 229.759 486.602 DL 239.759 486.602 234.759 486.602
DL 244.759 486.602 239.759 486.602 DL 249.759 486.602 244.759 486.602 DL
254.759 486.602 249.759 486.602 DL 259.759 486.602 254.759 486.602 DL 264.759
486.602 259.759 486.602 DL 269.759 486.602 264.759 486.602 DL 274.759 486.602
269.759 486.602 DL 279.759 486.602 274.759 486.602 DL 284.759 486.602 279.759
486.602 DL 289.759 486.602 284.759 486.602 DL 294.759 486.602 289.759 486.602
DL 299.759 486.602 294.759 486.602 DL 304.759 486.602 299.759 486.602 DL
309.759 486.602 304.759 486.602 DL 314.759 486.602 309.759 486.602 DL 319.759
486.602 314.759 486.602 DL 324.759 486.602 319.759 486.602 DL 329.759 486.602
324.759 486.602 DL 334.759 486.602 329.759 486.602 DL 339.759 486.602 334.759
486.602 DL 344.759 486.602 339.759 486.602 DL 349.759 486.602 344.759 486.602
DL 354.759 486.602 349.759 486.602 DL 359.759 486.602 354.759 486.602 DL
364.759 486.602 359.759 486.602 DL 369.759 486.602 364.759 486.602 DL 374.759
486.602 369.759 486.602 DL 379.759 486.602 374.759 486.602 DL 384.759 486.602
379.759 486.602 DL 389.759 486.602 384.759 486.602 DL 394.759 486.602 389.759
486.602 DL 399.759 486.602 394.759 486.602 DL 404.759 486.602 399.759 486.602
DL 409.759 486.602 404.759 486.602 DL 414.759 486.602 409.759 486.602 DL
419.759 486.602 414.759 486.602 DL 424.759 486.602 419.759 486.602 DL 429.759
486.602 424.759 486.602 DL 434.759 486.602 429.759 486.602 DL 439.759 486.602
434.759 486.602 DL 444.759 486.602 439.759 486.602 DL 449.759 486.602 444.759
486.602 DL 454.759 486.602 449.759 486.602 DL 459.759 486.602 454.759 486.602
DL F3(lib/udp_server)462.009 489.102 Q(.c)-.666 E/F5 8/Palatino-Bold@0 SF
(Figure 1)175.208 502.602 Q(1.14)-.296 E/F6 8/Courier@0 SF(udp_server)6 E/F7 8
/Palatino-Roman@0 SF(function: cr)2 E
(eate an unconnected socket for a UDP server)-.144 E(.)-.592 E/F8 10
/Palatino-Roman@0 SF 1.252(This function is nearly identical to)147.6 526.602 R
/F9 10/Courier@0 SF(tcp_listen)3.752 E F8 3.753(,b)C 1.253
(ut without the call to)380.115 526.602 R F9(listen)3.753 E F8(.)A 2.268 -.92
(We s)129.6 538.602 T .428(et the addr).92 F .428(ess family to)-.18 F F9
(AF_UNSPEC)2.927 E F8 .427(but the caller can use the same technique that)2.927
F(we described with Figur)129.6 550.602 Q 2.5(e1)-.18 G(1.10 to for)249 550.602
Q(ce a particular pr)-.18 E(otocol)-.18 E(\()2.5 -.4 M(IPv4 or IPv6).4 I(\))-.4
I(.).4 I 3.203 -.92(We d)147.6 562.602 T 3.863(on).92 G 1.363(ot set the)
186.586 562.602 R F9(SO_REUSEADDR)3.863 E F8 1.363
(socket option for the UDP socket because this)3.863 F .6(socket option can al\
low multiple sockets to bind the same UDP port on hosts that sup-)129.6 574.602
R 2.143(port multicasting, as we described in Section 7.5.)129.6 586.602 R
2.143(Since ther)7.143 F 4.643(ei)-.18 G 4.643(sn)424.33 586.602 S 2.143
(othing like TCP's)439.033 586.602 R(TIME_W)129.6 598.602 Q .535
(AIT state for a UDP socket, ther)-.92 F 3.034(ei)-.18 G 3.034(sn)322.714
598.602 S 3.034(on)335.808 598.602 S .534
(eed to set this socket option when the)350.122 598.602 R(server is started.)
129.6 610.602 Q/F10 10/Helvetica-Bold@0 SF(Example: Pr)93.6 634.602 Q(otocol)
-.2 E(-)-.9 I(Independent Da).9 I(ytime Ser)-.2 E(ver).1 E F8(Figur)129.6
658.602 Q 2.5(e1)-.18 G(1.15 shows our daytime server)165.17 658.602 Q 2.5(,m)
-.74 G(odi\214ed fr)313.13 658.602 Q(om Figur)-.18 E 2.5(e1)-.18 G
(1.10 to use UDP)406.52 658.602 Q(.)-1.29 E/F11 7/Palatino-Roman@0 SF 1.75
<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 298 26
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(298)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 123 129.6 123 DL 136.765 123 131.765 123 DL 141.765 123 136.765 123 DL
146.765 123 141.765 123 DL 151.765 123 146.765 123 DL 156.765 123 151.765 123
DL 161.765 123 156.765 123 DL 166.765 123 161.765 123 DL 171.765 123 166.765
123 DL 176.765 123 171.765 123 DL 181.765 123 176.765 123 DL 186.765 123
181.765 123 DL 191.765 123 186.765 123 DL 196.765 123 191.765 123 DL 201.765
123 196.765 123 DL 206.765 123 201.765 123 DL 211.765 123 206.765 123 DL
216.765 123 211.765 123 DL 221.765 123 216.765 123 DL 226.765 123 221.765 123
DL 231.765 123 226.765 123 DL 236.765 123 231.765 123 DL 241.765 123 236.765
123 DL 246.765 123 241.765 123 DL 251.765 123 246.765 123 DL 256.765 123
251.765 123 DL 261.765 123 256.765 123 DL 266.765 123 261.765 123 DL 271.765
123 266.765 123 DL 276.765 123 271.765 123 DL 281.765 123 276.765 123 DL
286.765 123 281.765 123 DL 291.765 123 286.765 123 DL 296.765 123 291.765 123
DL 301.765 123 296.765 123 DL 306.765 123 301.765 123 DL 311.765 123 306.765
123 DL 316.765 123 311.765 123 DL 321.765 123 316.765 123 DL 326.765 123
321.765 123 DL 331.765 123 326.765 123 DL 336.765 123 331.765 123 DL 341.765
123 336.765 123 DL 346.765 123 341.765 123 DL 351.765 123 346.765 123 DL
356.765 123 351.765 123 DL 361.765 123 356.765 123 DL 366.765 123 361.765 123
DL 371.765 123 366.765 123 DL 376.765 123 371.765 123 DL 381.765 123 376.765
123 DL 386.765 123 381.765 123 DL 391.765 123 386.765 123 DL 396.765 123
391.765 123 DL 401.765 123 396.765 123 DL 406.765 123 401.765 123 DL 411.765
123 406.765 123 DL 416.765 123 411.765 123 DL 421.765 123 416.765 123 DL
426.765 123 421.765 123 DL/F2 9/Palatino-Italic@0 SF(names/daytimeudpsrv2.c)
429.015 125.5 Q/F3 8.15/Courier@0 SF 4.89(1#)139.38 131.801 S 14.67
(include "unp.h")154.05 131.801 R 4.89(2#)139.38 141.801 S 14.67
(include <time.h>)154.05 141.801 R 4.89(3i)139.38 158.801 S(nt)154.05 158.801 Q
4.89(4m)139.38 168.801 S(ain\(int argc, char **argv\))154.05 168.801 Q 4.89(5{)
139.38 178.801 S 24.45(6i)139.38 188.801 S 19.56(nt sockfd;)173.61 188.801 R
24.45(7s)139.38 198.801 S(size_t n;)173.61 198.801 Q 24.45(8c)139.38 208.801 S
14.67(har buff[MAXLINE];)173.61 208.801 R 24.45(9t)139.38 218.801 S 4.89
(ime_t ticks;)173.61 218.801 R 19.56(10 socklen_t)134.49 228.801 R
(addrlen, len;)4.89 E 19.56(11 struct)134.49 238.801 R(sockaddr *cliaddr;)4.89
E 19.56(12 if)134.49 255.801 R(\(argc == 2\))4.89 E 39.12(13 sockfd)134.49
265.801 R 4.89(=U)4.89 G(dp_server\(NULL, argv[1], &addrlen\);)237.18 265.801 Q
19.56(14 else)134.49 275.801 R(if \(argc == 3\))4.89 E 39.12(15 sockfd)134.49
285.801 R 4.89(=U)4.89 G(dp_server\(argv[1], argv[2], &addrlen\);)237.18
285.801 Q 19.56(16 else)134.49 295.801 R 39.12(17 err_quit\("usage:)134.49
305.801 R(daytimeudpsrv [ <host> ] <service or port>"\);)4.89 E 19.56
(18 cliaddr)134.49 322.801 R 4.89(=M)4.89 G(alloc\(addrlen\);)222.51 322.801 Q
19.56(19 for)134.49 339.801 R 4.89(\(;;\){)4.89 G 39.12(20 len)134.49 349.801 R
4.89(=a)4.89 G(ddrlen;)222.51 349.801 Q 39.12(21 n)134.49 359.801 R 4.89(=R)
4.89 G(ecvfrom\(sockfd, buff, MAXLINE, 0, cliaddr, &len\);)212.73 359.801 Q
39.12(22 printf\("datagram)134.49 369.801 R
(from %s\\n", Sock_ntop\(cliaddr, len\)\);)4.89 E 39.12(23 ticks)134.49 386.801
R 4.89(=t)4.89 G(ime\(NULL\);)232.29 386.801 Q 39.12(24 snprintf\(buff,)134.49
396.801 R(sizeof\(buff\), "%.24s\\r\\n", ctime\(&ticks\)\);)4.89 E 39.12
(25 Sendto\(sockfd,)134.49 406.801 R(buff, strlen\(buff\), 0, cliaddr, len\);)
4.89 E 19.56(26 })134.49 416.801 R(27 })134.49 426.801 Q 134.6 431.602 129.6
431.602 DL 136.765 431.602 131.765 431.602 DL 141.765 431.602 136.765 431.602
DL 146.765 431.602 141.765 431.602 DL 151.765 431.602 146.765 431.602 DL
156.765 431.602 151.765 431.602 DL 161.765 431.602 156.765 431.602 DL 166.765
431.602 161.765 431.602 DL 171.765 431.602 166.765 431.602 DL 176.765 431.602
171.765 431.602 DL 181.765 431.602 176.765 431.602 DL 186.765 431.602 181.765
431.602 DL 191.765 431.602 186.765 431.602 DL 196.765 431.602 191.765 431.602
DL 201.765 431.602 196.765 431.602 DL 206.765 431.602 201.765 431.602 DL
211.765 431.602 206.765 431.602 DL 216.765 431.602 211.765 431.602 DL 221.765
431.602 216.765 431.602 DL 226.765 431.602 221.765 431.602 DL 231.765 431.602
226.765 431.602 DL 236.765 431.602 231.765 431.602 DL 241.765 431.602 236.765
431.602 DL 246.765 431.602 241.765 431.602 DL 251.765 431.602 246.765 431.602
DL 256.765 431.602 251.765 431.602 DL 261.765 431.602 256.765 431.602 DL
266.765 431.602 261.765 431.602 DL 271.765 431.602 266.765 431.602 DL 276.765
431.602 271.765 431.602 DL 281.765 431.602 276.765 431.602 DL 286.765 431.602
281.765 431.602 DL 291.765 431.602 286.765 431.602 DL 296.765 431.602 291.765
431.602 DL 301.765 431.602 296.765 431.602 DL 306.765 431.602 301.765 431.602
DL 311.765 431.602 306.765 431.602 DL 316.765 431.602 311.765 431.602 DL
321.765 431.602 316.765 431.602 DL 326.765 431.602 321.765 431.602 DL 331.765
431.602 326.765 431.602 DL 336.765 431.602 331.765 431.602 DL 341.765 431.602
336.765 431.602 DL 346.765 431.602 341.765 431.602 DL 351.765 431.602 346.765
431.602 DL 356.765 431.602 351.765 431.602 DL 361.765 431.602 356.765 431.602
DL 366.765 431.602 361.765 431.602 DL 371.765 431.602 366.765 431.602 DL
376.765 431.602 371.765 431.602 DL 381.765 431.602 376.765 431.602 DL 386.765
431.602 381.765 431.602 DL 391.765 431.602 386.765 431.602 DL 396.765 431.602
391.765 431.602 DL 401.765 431.602 396.765 431.602 DL 406.765 431.602 401.765
431.602 DL 411.765 431.602 406.765 431.602 DL 416.765 431.602 411.765 431.602
DL 421.765 431.602 416.765 431.602 DL 426.765 431.602 421.765 431.602 DL F2
(names/daytimeudpsrv2.c)429.015 434.102 Q/F4 8/Palatino-Bold@0 SF(Figure 1)
223.896 447.602 Q(1.15)-.296 E/F5 8/Palatino-Roman@0 SF(Pr)6 E
(otocol independent UDP daytime server)-.144 E(.)-.592 E/F6 12/Helvetica-Bold@0
SF(11.13)93.6 493.202 Q/F7 12/Courier-Bold@0 SF(getnameinfo)5.976 E F6
(Function)6.672 E/F8 10/Palatino-Roman@0 SF .235
(This function is the complement of)129.6 517.202 R/F9 10/Courier@0 SF
(getaddrinfo)2.735 E F8 2.735(:i)C 2.735(tt)361.275 517.202 S .236
(akes a socket addr)370.53 517.202 R .236(ess and r)-.18 F(eturns)-.18 E 3.835
(ac)129.6 529.202 S 1.335(haracter string describing the host and another char\
acter string describing the ser)142.875 529.202 R(-)-.18 E 2.817(vice. This)
129.6 541.202 R .317(function pr)2.817 F .317(ovides this information in a pr)
-.18 F .318(otocol-independent fashion; that is,)-.18 F .284
(the caller does not car)129.6 553.202 R 2.784(ew)-.18 G .284(hat type of pr)
242.87 553.202 R .284(otocol addr)-.18 F .284
(ess is contained in the socket addr)-.18 F(ess)-.18 E(str)129.6 565.202 Q
(uctur)-.08 E(e, as that detail is handled by the function.)-.18 E F3
(#include <netdb.h>)147.6 587.202 Q(int getnameinfo\(const struct sockaddr *)
147.6 607.202 Q/F10 8.15/Palatino-Italic@0 SF(sockaddr)A F3 4.89(,s)C(ocklen_t)
381.644 607.202 Q F10(addrlen)4.89 E F3(,)A(char *)225.84 617.202 Q F10(host)A
F3 4.89(,s)C(ize_t)283.428 617.202 Q F10(hostlen)4.89 E F3(,)A(char *)225.84
627.202 Q F10(serv)A F3 4.89(,s)C(ize_t)283.435 627.202 Q F10(servlen)4.89 E F3
4.89(,i)C(nt)350.997 627.202 Q F10(\215ags)4.89 E F3(\);)A/F11 8.15
/Palatino-Roman@0 SF(Returns: 0 if OK,)399.869 647.202 Q/F12 8.15/Symbol SF(-)
2.038 E F11 2.038(1o)C 2.038(ne)476.955 647.202 S(rr)487.64 647.202 Q(or)-.147
E .326 LW 129.6 574.977 129.6 651.277 DL 519.6 574.977 129.6 574.977 DL 519.6
651.277 519.6 574.977 DL 129.6 651.277 519.6 651.277 DL/F13 7/Palatino-Roman@0
SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 299 27
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.13)-.495 E/F1 9/Courier@0 SF
(getnameinfo)388.83 82 Q F0(Function)4.5 E/F2 9/Palatino-Bold@0 SF(299)506.1 82
Q .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL
107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL
119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL
131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL
143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL
155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL
167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL
179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL
191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL
203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL
215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL
227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL
239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL
251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL
263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL
275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL
287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL
299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL
311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL
323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL
335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL
347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL
359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL
371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL
383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL
395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL
407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL
419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL
431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL
443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL
455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL
467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL
479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL
491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL
503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL
515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Italic@0 SF
(sockaddr)129.6 123 Q/F4 10/Palatino-Roman@0 SF .027(points to the socket addr)
2.526 F .027(ess str)-.18 F(uctur)-.08 E 2.527(ec)-.18 G .027(ontaining the pr)
338.888 123 R .027(otocol addr)-.18 F .027(ess to be con-)-.18 F 1.543
(verted into a human-r)129.6 135 R 1.543(eadable string, and)-.18 F F3(addrlen)
4.042 E F4 1.542(is the length of this str)4.042 F(uctur)-.08 E 4.042(e. This)
-.18 F(str)129.6 147 Q(uctur)-.08 E 7.668(ea)-.18 G 5.168(nd its length ar)
181.958 147 R 7.668(en)-.18 G 5.168(ormally r)282.51 147 R 5.168
(eturned by either)-.18 F/F5 10/Courier@0 SF(accept)7.668 E F4(,)A F5(recvfrom)
7.668 E F4(,)A F5(getsockname)129.6 159 Q F4 2.5(,o)C(r)206.06 159 Q F5
(getpeername)2.5 E F4(.)A .384(The caller allocates space for the two human-r)
147.6 171 R .383(eadable strings:)-.18 F F3(host)2.883 E F4(and)2.883 E F3
(hostlen)2.883 E F4(spec-)2.883 E .719(ify the host string, and)129.6 183 R F3
(serv)3.219 E F4(and)3.219 E F3(servlen)3.219 E F4 .719
(specify the service string.)3.219 F .72(If the caller does not)5.72 F .226
(want the host string r)129.6 195 R .226(eturned, a)-.18 F F3(hostlen)2.726 E
F4 .226(of 0 is speci\214ed.)2.726 F .225(Similarly a)5.225 F F3(servlen)2.725
E F4 .225(of 0 speci\214es)2.725 F 2.128(not to r)129.6 207 R 2.128
(eturn information on the service.)-.18 F 3.969 -.92(To h)7.129 H 2.129
(elp allocate arrays to hold these two).92 F 1.203
(strings, the constants shown in Figur)129.6 219 R 3.703(e1)-.18 G 1.202
(1.16 ar)311.188 219 R 3.702(ed)-.18 G 1.202(e\214ned by including the)355.762
219 R F5(<netdb.h>)3.702 E F4(header)129.6 231 Q(.)-.74 E 446.152 245 203.048
245 DL/F6 8/Palatino-Roman@0 SF 68.948(Constant Description)215.068 253 R -.736
(Va)422.128 253 S(lue).736 E 446.152 257 203.048 257 DL 446.152 259 203.048 259
DL/F7 8/Courier@0 SF(NI_MAXHOST)207.048 267 Q F6(maximum size of r)267.048 267
Q(eturned host string)-.144 E(1025)424.14 267 Q F7(NI_MAXSERV)207.048 277 Q F6
(maximum size of r)267.048 277 Q(eturned service string)-.144 E(32)432.14 277 Q
446.152 281 203.048 281 DL 416.128 245 416.128 281 DL 261.048 245 261.048 281
DL 446.152 245 446.152 281 DL 203.048 245 203.048 281 DL/F8 8/Palatino-Bold@0
SF(Figure 1)201.064 299 Q(1.16)-.296 E F6(Constants for r)6 E
(eturned string sizes fr)-.144 E(om)-.144 E F7(getnameinfo)2 E F6(.)A F4 .527
(The dif)147.6 321.8 R(fer)-.18 E .527(ence between)-.18 F F5(sock_ntop)3.027 E
F4(and)3.027 E F5(getnameinfo)3.027 E F4 .528(is that the former does not)3.027
F .189(involve the DNS and just r)129.6 333.8 R .189
(eturns a printable version of the IP addr)-.18 F .188(ess and port number)-.18
F(.)-.74 E
(The latter normally tries to obtain a name for both the host and service.)
129.6 345.8 Q(Figur)147.6 357.8 Q 4.032(e1)-.18 G 1.533(1.17 shows the \214ve)
184.702 357.8 R F3(\215ags)4.033 E F4 1.533
(that can be speci\214ed to change the operation of)4.033 F F5(getnameinfo)
129.6 369.8 Q F4(.)A 467.012 383.8 182.188 383.8 DL F6 105.82
(Constant Description)203.808 391.8 R 467.012 395.8 182.188 395.8 DL 467.012
397.8 182.188 397.8 DL F7(NI_DGRAM)186.188 405.8 Q F6(datagram service)265.388
405.8 Q F7(NI_NAMEREQD)186.188 415.8 Q F6 -.144(re)265.388 415.8 S(turn an err)
.144 E(or if name cannot be r)-.144 E(esolved fr)-.144 E(om addr)-.144 E(ess)
-.144 E F7(NI_NOFQDN)186.188 425.8 Q F6 -.144(re)265.388 425.8 S
(turn only hostname portion of FQDN).144 E F7(NI_NUMERICHOST)186.188 435.8 Q F6
-.144(re)265.388 435.8 S(turn numeric string for hostname).144 E F7
(NI_NUMERICSERV)186.188 445.8 Q F6 -.144(re)265.388 445.8 S
(turn numeric string for service name).144 E 467.012 449.8 182.188 449.8 DL
259.388 383.8 259.388 449.8 DL 467.012 383.8 467.012 449.8 DL 182.188 383.8
182.188 449.8 DL F8(Figure 1)257.96 467.8 Q(1.17)-.296 E/F9 8/Palatino-Italic@0
SF(\215ags)6 E F6(for)2 E F7(getnameinfo)2 E F6(.)A F5(NI_DGRAM)147.6 490.6 Q
F4 .365
(should be speci\214ed when the caller knows it is dealing with a datagram)
2.866 F 4.267(socket. The)129.6 502.6 R -.18(re)4.267 G 1.767
(ason is that given only the IP addr).18 F 1.768
(ess and port number in the socket)-.18 F(addr)129.6 514.6 Q .967(ess str)-.18
F(uctur)-.08 E(e,)-.18 E F5(getnameinfo)3.467 E F4 .967
(cannot determine the pr)3.467 F(otocol)-.18 E(\()3.467 -.4 M .967(TCP or UDP)
.4 J(\))-.4 I 5.967(.T).4 K(her)500.43 514.6 Q(e)-.18 E .049
(exist a few port numbers that ar)129.6 526.6 R 2.549(eu)-.18 G .05
(sed for one service with TCP and a completely dif)284.063 526.6 R(fer)-.18 E
(-)-.18 E .788(ent service with UDP)129.6 538.6 R 5.788(.A)-1.29 G 3.288(ne)
240.772 538.6 S .788(xample is port 514, which is the)254.67 538.6 R F5(rsh)
3.287 E F4 .787(service with TCP)3.287 F 3.287(,b)-1.29 G(ut)510.31 538.6 Q
(the)129.6 550.6 Q F5(syslog)2.5 E F4(service with UDP)2.5 E(.)-1.29 E F5
(NI_NAMEREQD)147.6 562.6 Q F4 1.315(causes an err)3.815 F 1.316(or to be r)-.18
F 1.316(eturned if the hostname cannot be r)-.18 F(esolved)-.18 E 2.081
(using the DNS.)129.6 574.6 R 2.081(This can be used by servers that r)7.081 F
(equir)-.18 E 4.58(et)-.18 G 2.08(he client's IP addr)405.53 574.6 R 2.08
(ess be)-.18 F 2.228(mapped into a hostname.)129.6 586.6 R 2.228
(These servers then take this r)7.228 F 2.229(eturned hostname and call)-.18 F
F5(gethostbyname)129.6 598.6 Q F4 1.586(and verify that one of the r)4.087 F
1.586(eturned addr)-.18 F 1.586(esses is the addr)-.18 F 1.586(ess in the)-.18
F(socket addr)129.6 610.6 Q(ess str)-.18 E(uctur)-.08 E(e.)-.18 E F5(NI_NOFQDN)
147.6 622.6 Q F4 1.1(causes the r)3.6 F 1.1(eturned hostname to be tr)-.18 F
1.1(uncated at the \214rst period.)-.08 F(For)6.1 E 4.795
(example, if the IP addr)129.6 634.6 R 4.795(ess in the socket addr)-.18 F
4.794(ess str)-.18 F(uctur)-.08 E 7.294(ew)-.18 G(er)438.956 634.6 Q 7.294(e2)
-.18 G(06.62.226.42,)464.6 634.6 Q F5(gethostbyaddr)129.6 646.6 Q F4 .152
(would r)2.652 F .152(eturn a name of)-.18 F F5(alpha.kohala.com)2.652 E F4
5.153(.B)C .153(ut if this \215ag is spec-)427.975 646.6 R(i\214ed to)129.6
658.6 Q F5(getnameinfo)2.5 E F4 2.5(,i)C 2.5(tr)237.09 658.6 S
(eturns the hostname as just)246.62 658.6 Q F5(alpha)2.5 E F4(.)A/F10 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 300 28
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(300)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Courier@0 SF(NI_NUMERICHOST)147.6 123 Q/F3 10/Palatino-Roman@0 SF(tells)
3.641 E F2(getnameinfo)3.641 E F3 1.141
(not to call the DNS \(which can take time\).)3.641 F 1.514
(Instead the numeric r)129.6 135 R(epr)-.18 E 1.514(esentation of the IP addr)
-.18 F 1.514(ess is r)-.18 F 1.514(eturned, pr)-.18 F 1.515(obably by calling)
-.18 F F2(inet_ntop)129.6 147 Q F3 5.345(.S)C .345(imilarly the)196.695 147 R
F2(NI_NUMERICSERV)2.845 E F3 .345(speci\214es that the decimal port number is)
2.845 F .139(to be r)129.6 159 R .139
(eturned, instead of looking up the service name.)-.18 F .14
(Servers should normally specify)5.139 F F2(NI_NUMERICSERV)129.6 171 Q F3 .111
(because the client port numbers normally have no associated service)2.611 F
-1.667(name \212 they)129.6 183 R(ar)2.5 E 2.5(ee)-.18 G(phemeral ports.)
208.486 183 Q .892(The logical OR of multiple \215ags can be speci\214ed if th\
ey make sense together \(e.g.,)147.6 195 R F2(NI_DGRAM)129.6 207 Q F3(and)5.222
E F2(NI_NUMERICHOST)5.221 E F3 2.721
(\), while other combinations make no sense \(e.g.,)B F2(NI_NAMEREQD)129.6 219
Q F3(and)2.5 E F2(NI_NUMERICHOST)2.5 E F3(\).)A/F4 8/Courier@0 SF(getnameinfo)
183.6 239 Q/F5 8/Palatino-Roman@0 SF(was overlooked by Posix.1g but is speci\
\214ed in RFC 2133 [Gilligan et al. 1997].)2 E/F6 12/Helvetica-Bold@0 SF 2.64
(11.14 Reentrant)93.6 275 R(Functions)6.672 E F3(The)129.6 299 Q F2
(gethostbyname)2.702 E F3 .202(function fr)2.702 F .203(om Section 9.3 pr)-.18
F .203(esents an inter)-.18 F .203(esting pr)-.18 F .203(oblem that we)-.18 F
.475(have not yet examined in the text: it is not)129.6 311 R/F7 10
/Palatino-Italic@0 SF -.18(re)2.974 G(entrant).18 E F3 5.474(.W)C 2.974(ew)
376.25 311 S .474(ill encounter this pr)392.354 311 R .474(oblem in)-.18 F
1.156(general when we deal with thr)129.6 323 R 1.156
(eads in Chapter 23, but it is inter)-.18 F 1.156(esting to examine the)-.18 F
(pr)129.6 335 Q .24(oblem now \(without having to deal with the concept of thr)
-.18 F .239(eads\) and to see how to \214x)-.18 F(it.)129.6 347 Q .727
(First let us look at how the function works.)147.6 359 R .727
(If we look at its sour)5.727 F .727(ce code \(which is)-.18 F .418
(easy since the sour)129.6 371 R .418(ce code for the entir)-.18 F 2.918(eB)
-.18 G .418(IND r)316.194 371 R .418
(elease is publicly available\), we see that)-.18 F .768
(one \214le contains both)129.6 383 R F2(gethostbyname)3.268 E F3(and)3.268 E
F2(gethostbyaddr)3.268 E F3 3.268(,a)C .769(nd the \214le has the fol-)419.746
383 R(lowing general outline:)129.6 395 Q/F8 8.15/Courier-Bold@0 SF(static)
147.6 411 Q/F9 8.15/Courier@0 SF(struct hostent)4.89 E 14.67(host; /*)9.78 F
(result stored here */)4.89 E(struct hostent *)147.6 428 Q
(gethostbyname\(const char *hostname\))147.6 438 Q({)147.6 448 Q
(return\(gethostbyname2\(hostname, family\)\);)167.16 458 Q(/* Figure 9.6 */)
9.78 E(})147.6 468 Q(struct hostent *)147.6 485 Q
(gethostbyname2\(const char *hostname, int family\))147.6 495 Q({)147.6 505 Q
(/* call DNS functions for A or AAAA query */)167.16 515 Q
(/* fill in host structure */)167.16 532 Q(return\(&host\);)167.16 549 Q(})
147.6 559 Q(struct hostent *)147.6 576 Q
(gethostbyaddr\(const char *addr, size_t len, int family\))147.6 586 Q({)147.6
596 Q(/* call DNS functions for PTR query in in-addr.arpa domain */)167.16 606
Q(/* fill in host structure */)167.16 623 Q(return\(&host\);)167.16 640 Q(})
147.6 650 Q/F10 7/Palatino-Roman@0 SF 1.75<a943>233.453 676 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 301 29
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 258.789(1.14 Reentrant)-.495 F
(Functions)4.5 E/F1 9/Palatino-Bold@0 SF(301)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F2 10/Palatino-Roman@0 SF 2.899 -.92(We h)129.6 123 T
1.059(ighlight the).92 F/F3 10/Courier@0 SF(static)3.559 E F2 1.058
(storage class speci\214er of the r)3.559 F 1.058(esult str)-.18 F(uctur)-.08 E
1.058(e, because that is)-.18 F .533(the basic pr)129.6 135 R 3.033(oblem. The)
-.18 F .533(fact that these thr)3.033 F .534(ee functions shar)-.18 F 3.034
(eas)-.18 G(ingle)410.868 135 Q F3(host)3.034 E F2 .534(variable pr)3.034 F(e-)
-.18 E .123(sents yet another pr)129.6 147 R .122
(oblem that we discussed in Exer)-.18 F .122(cise 9.1.)-.18 F .122(\(Recall fr)
5.122 F .122(om Figur)-.18 F 2.622(e9)-.18 G .122(.6 that)492.138 147 R F3
(gethostbyname2)129.6 159 Q F2 .519
(is new with the IPv6 support in BIND 4.9.4.)3.019 F 2.36 -.92(We w)5.519 H .52
(ill ignor).92 F 3.02(et)-.18 G .52(he fact)489.94 159 R(that)129.6 171 Q F3
(gethostbyname2)4.951 E F2 2.451(is involved when we call)4.951 F F3
(gethostbyname)4.951 E F2 4.951(,a)C 4.951(st)455.658 171 S 2.451(hat doesn't)
468.109 171 R(af)129.6 183 Q(fect this discussion.\))-.18 E 6.047(The r)147.6
195 R 6.047(eentrancy pr)-.18 F 6.047(oblem can occur in a normal Unix pr)-.18
F 6.048(ocess that calls)-.18 F F3(gethostbyname)129.6 207 Q F2(or)3.633 E F3
(gethostbyaddr)3.633 E F2(fr)3.633 E 1.133(om both the main \215ow of contr)
-.18 F 1.132(ol and fr)-.18 F 1.132(om a)-.18 F .098(signal handler)129.6 219 R
5.098(.W)-.74 G .098(hen the signal handler is called \(say it is a)209.896 219
R F3(SIGALRM)2.598 E F2 .099(signal that is gen-)2.598 F 1.244
(erated once a second\), the main \215ow of contr)129.6 231 R 1.243
(ol of the pr)-.18 F 1.243(ocess is temporarily stopped)-.18 F
(and the signal handling function is called.)129.6 243 Q
(Consider the following.)5 E/F4 8.15/Courier@0 SF(main\(\))147.6 259 Q({)147.6
269 Q(struct hostent)167.16 279 Q(*hptr;)9.78 E(...)167.16 296 Q
(signal\(SIGALRM, sig_alrm\);)167.16 306 Q(...)167.16 323 Q
(hptr = gethostbyname\( ... \);)167.16 333 Q(...)167.16 343 Q(})147.6 353 Q
(void)147.6 370 Q(sig_alrm\(int signo\))147.6 380 Q({)147.6 390 Q
(struct hostent)167.16 400 Q(*hptr;)9.78 E(...)167.16 417 Q
(hptr = gethostbyname\( ... \);)167.16 427 Q(...)167.16 437 Q(})147.6 447 Q F2
.71(If the main \215ow of contr)129.6 465 R .711(ol is in the middle of)-.18 F
F3(gethostbyname)3.211 E F2 .711(when it is temporarily)3.211 F .16
(stopped \(say the function has \214lled in the)129.6 477 R F3(host)2.659 E F2
.159(variable and is about to r)2.659 F .159(eturn\), and the)-.18 F 1.465
(signal handler then calls)129.6 489 R F3(gethostbyname)3.965 E F2 3.965(,s)C
1.465(ince only one copy of the variable)334.195 489 R F3(host)3.965 E F2 .156
(exists in the pr)129.6 501 R .156(ocess, it is r)-.18 F 2.656(eused. This)-.18
F .156(overwrites the values that wer)2.656 F 2.656(ec)-.18 G .156
(alculated for the)447.228 501 R .365(call fr)129.6 513 R .365
(om the main \215ow of contr)-.18 F .366
(ol with the values calculated for the call fr)-.18 F .366(om the signal)-.18 F
(handler)129.6 525 Q(.)-.74 E .836(If we look at the name and addr)147.6 537 R
.835(ess conversion functions pr)-.18 F .835(esented in this chapter)-.18 F
1.183(and Chapter 9, along with the)129.6 549 R F3(inet_)3.683 E/F5 10
/Palatino-Italic@0 SF(XXX)A F2 1.183(functions fr)3.683 F 1.183
(om Chapter 4, we note the fol-)-.18 F(lowing:)129.6 561 Q 8.83<8348>147.6 585
S(istorically)170.81 585 Q(,)-1.11 E F3(gethostbyname)234.534 585 Q F2(,)A F3
(gethostbyname2)333.817 585 Q F2(,)A F3(gethostbyaddr)439.1 585 Q F2(,)A F3
(getservbyname)162.49 597 Q F2 3.873(,a)C(nd)251.863 597 Q F3(getservbyport)
3.873 E F2(ar)3.873 E 3.873(en)-.18 G 1.373(ot r)372.792 597 R 1.374
(eentrant because all r)-.18 F 1.374(eturn a)-.18 F(pointer to a static str)
162.49 609 Q(uctur)-.08 E(e.)-.18 E .935(Some implementations that support thr)
162.49 627 R .934(eads \(Solaris 2.x\) pr)-.18 F .934(ovide r)-.18 F .934
(eentrant ver)-.18 F(-)-.18 E 1.258
(sions of these four functions with names ending with the)162.49 639 R F3(_r)
3.759 E F2(suf)3.759 E 1.259(\214x, which we)-.18 F
(describe in the next section.)162.49 651 Q/F6 7/Palatino-Roman@0 SF 1.75<a943>
233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 302 30
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(302)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF(Alternately)162.49 123 Q 4.169(,s)-1.11 G 1.669
(ome implementations that support thr)222.319 123 R 1.669
(eads \(Digital Unix 4.0 and)-.18 F(HP)162.49 135 Q(-)-.9 I .211(UX 10.30\) pr)
.9 J .211(ovide r)-.18 F .211(eentrant versions of these functions using thr)
-.18 F(ead-speci\214c)-.18 E(data.)162.49 147 Q<83>147.6 163 Q/F3 10/Courier@0
SF(inet_pton)8.83 E F2(and)2.5 E F3(inet_ntop)2.5 E F2(ar)2.5 E 2.5(ea)-.18 G
(lways r)315.98 163 Q(eentrant.)-.18 E 8.83<8348>147.6 179 S(istorically)170.81
179 Q F3(inet_ntoa)2.646 E F2 .146(is not r)2.646 F .145
(eentrant but some implementations that support)-.18 F(thr)162.49 191 Q
(eads pr)-.18 E(ovide a r)-.18 E(eentrant version that uses thr)-.18 E
(ead-speci\214c data.)-.18 E<83>147.6 207 Q F3(getaddrinfo)8.83 E F2 1.094
(is r)3.594 F 1.094(eentrant only if it calls r)-.18 F 1.095
(eentrant functions itself; that is, if it)-.18 F 8.005(calls r)162.49 219 R
8.005(eentrant versions of)-.18 F F3(gethostbyname)310.32 219 Q F2 8.005
(for the hostname, and)398.825 219 R F3(getservbyname)162.49 231 Q F2 .723
(for the service name.)3.223 F .723(One r)5.723 F .724
(eason that all the memory for the)-.18 F -.18(re)162.49 243 S
(sults is dynamically allocated is to allow it to be r).18 E(eentrant.)-.18 E
<83>147.6 259 Q F3(getnameinfo)8.83 E F2 1.095(is r)3.595 F 1.095
(eentrant only if it calls r)-.18 F 1.094
(eentrant functions itself; that is, if it)-.18 F 4.175(calls r)162.49 271 R
4.175(eentrant versions of)-.18 F F3(gethostbyaddr)6.675 E F2 4.176
(to obtain the hostname, and)6.676 F F3(getservbyport)162.49 283 Q F2 .291
(to obtain the service name.)2.791 F .291(Notice that both r)5.291 F .291
(esult strings \(for)-.18 F 1.88(the hostname and the service name\) ar)162.49
295 R 4.381(ea)-.18 G 1.881(llocated by the caller)358.144 295 R 4.381(,t)-.74
G 4.381(oa)464.528 295 S 1.881(llow this)479.369 295 R -.18(re)162.49 307 S
(entrancy).18 E(.)-1.11 E 3.949(As)147.6 331 S 1.449(imilar pr)163.569 331 R
1.449(oblem occurs with the variable)-.18 F F3(errno)3.948 E F2 6.448(.H)C
1.448(istorically ther)396.838 331 R 3.948(eh)-.18 G 1.448(as been a)476.534
331 R .653(single copy of this integer variable per pr)129.6 343 R 3.153
(ocess. If)-.18 F .653(the pr)3.153 F .654(ocess makes a system call that)-.18
F -.18(re)129.6 355 S 1.078(turns an err).18 F(or)-.18 E 3.578(,a)-.74 G 3.578
(ni)211.694 355 S 1.078(nteger err)224.002 355 R 1.078(or code is stor)-.18 F
1.078(ed into this variable.)-.18 F 1.077(For example, when)6.078 F 1.173
(the function named)129.6 367 R F3(close)3.673 E F2 1.173(in the standar)3.673
F 3.674(dCl)-.18 G 1.174(ibrary is called, it might execute some-)342.386 367 R
(thing like the following pseudocode:)129.6 379 Q 7.5<8370>147.6 397 S
(ut the ar)167.17 397 Q
(gument to the system call \(an integer descriptor\) into a r)-.18 E(egister)
-.18 E 7.5<8370>147.6 409 S(ut a value in another r)167.17 409 Q
(egister indicating the)-.18 E F3(close)2.5 E F2(system call is being called)
2.5 E 7.5<8369>147.6 421 S
(nvoke the system call \(switch to the kernel with a special instr)164.07 421 Q
(uction\))-.08 E 7.5<8374>147.6 433 S(est the value of a r)164.42 433 Q
(egister to see if an err)-.18 E(or occurr)-.18 E(ed)-.18 E 7.5<8369>147.6 445
S 2.5(fn)164.07 445 S 2.5(oe)175.72 445 S(rr)188.47 445 Q(or)-.18 E(,)-.74 E F3
(return)2.5 E(\()-.4 I(0).4 I(\))-.4 I F2 7.5<8373>147.6 457 S(tor)165.4 457 Q
2.5(et)-.18 G(he value of some other r)188.44 457 Q(egister into)-.18 E F3
(errno)2.5 E F2<83>147.6 469 Q F3(return\(-1\))7.5 E F2 .867
(First notice that if an err)129.6 487 R .867(or does not occur)-.18 F 3.366
(,t)-.74 G .866(he value of)327.302 487 R F3(errno)3.366 E F2 .866
(is not changed.)3.366 F .866(That is)5.866 F .762
(why we cannot look at the value of)129.6 499 R F3(errno)3.262 E F2 .762
(unless we know that an err)3.262 F .762(or has occurr)-.18 F(ed)-.18 E
(\(normally indicated by the function r)129.6 511 Q(eturning)-.18 E/F4 10
/Symbol SF(-)2.5 E F2(1\).)A .996(Assume the pr)147.6 523 R .996
(ogram tests the r)-.18 F .995(eturn value of the)-.18 F F3(close)3.495 E F2
.995(function and then prints)3.495 F(the value of)129.6 535 Q F3(errno)2.5 E
F2(if an err)2.5 E(or occurr)-.18 E(ed, as in the following:)-.18 E/F5 8.15
/Courier@0 SF(if \(close\(fd\) < 0\) {)147.6 551 Q
(fprintf\(stderr, "close error, errno = %d\\n", errno\))167.16 561 Q
(exit\(1\);)167.16 571 Q(})147.6 581 Q F2(Ther)129.6 599 Q 2.694(ei)-.18 G
2.694(sas)160.504 599 S .194
(mall window of time between the storing of the err)179.372 599 R .195
(or code into)-.18 F F3(errno)2.695 E F2(when)2.695 E 1.458(the system call r)
129.6 611 R 1.457(eturns, and the printing of this value by the pr)-.18 F 1.457
(ogram, during which)-.18 F 1.284(another thr)129.6 623 R 1.284
(ead of execution within this pr)-.18 F 1.285
(ocess \(i.e., a signal handler\) can change the)-.18 F 1.35(value of)129.6 635
R F3(errno)3.85 E F2 6.35(.F)C 1.349
(or example, if, when the signal handler is called, the main \215ow of)214.88
635 R(contr)129.6 647 Q .357(ol is between the)-.18 F F3(close)2.857 E F2 .357
(and the)2.857 F F3(fprintf)2.857 E F2 .357
(and the signal handler calls some other)2.857 F 1.578(system call that r)129.6
659 R 1.578(eturns an err)-.18 F 1.578(or \(say)-.18 F F3(write)4.078 E F2
1.578(\), then the)B F3(errno)4.078 E F2 1.578(value stor)4.078 F 1.577(ed fr)
-.18 F 1.577(om the)-.18 F/F6 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 303 31
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q(1.15)-.495 E/F1 9/Courier@0 SF
(gethostbyname_r)258.177 82 Q F0(and)4.5 E F1(gethostbyaddr_r)4.5 E F0
(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(303)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 10/Courier@0 SF(write)129.6 123 Q/F4 10
/Palatino-Roman@0 SF(system call overwrites the value stor)2.5 E(ed by the)-.18
E F3(close)2.5 E F4(system call.)2.5 E .285(In looking at these two pr)147.6
135 R .285(oblems with r)-.18 F(egar)-.18 E 2.785(dt)-.18 G 2.785(os)355.1 135
S .285(ignal handlers, one solution to the)367.585 135 R(pr)129.6 147 Q 1.467
(oblem with)-.18 F F3(gethostbyname)3.967 E F4(\(r)3.967 E 1.467
(eturning a pointer to a static variable\) is to)-.18 F/F5 10/Palatino-Italic@0
SF(not)3.967 E F4(call)3.966 E(nonr)129.6 159 Q .278(eentrant functions fr)-.18
F .278(om a signal handler)-.18 F 5.278(.T)-.74 G .278(he pr)342.758 159 R .278
(oblem with)-.18 F F3(errno)2.779 E F4 .279(\(a single global)2.779 F .257(var\
iable that can be changed by the signal handler\) can be avoided by coding the\
 signal)129.6 171 R(handler to save and r)129.6 183 Q(estor)-.18 E 2.5(et)-.18
G(he value of)255.17 183 Q F3(errno)2.5 E F4(in the signal handler)2.5 E 2.5
(,a)-.74 G 2.5(sf)439.15 183 S(ollows:)449.22 183 Q/F6 8.15/Courier@0 SF(void)
147.6 199 Q(sig_alrm\(int signo\))147.6 209 Q({)147.6 219 Q 4.89
(int errno_save;)167.16 229 R(errno_save = errno;)167.16 246 Q
(/* save its value on entry *)294.3 246 Q(if \(write\( ... \) != nbytes\))
167.16 256 Q(fprintf\(stderr, "write error, errno = %d\\n", errno\);)186.72 266
Q(errno = errno_save;)167.16 276 Q(/* restore its value on return */)294.3 276
Q(})147.6 286 Q F4 1.28(In this example code we also call)129.6 304 R F3
(fprintf)3.78 E F4 3.78(,as)C(tandar)347.07 304 Q 3.78(dI)-.18 G 1.28
(/O function, fr)389.29 304 R 1.28(om the signal)-.18 F(handler)129.6 316 Q
5.319(.T)-.74 G .319(his is yet another r)177.209 316 R .318(eentrancy pr)-.18
F .318(oblem because many versions of the standar)-.18 F(d)-.18 E .995
(I/O library ar)129.6 328 R 3.496(en)-.18 G(onr)206.566 328 Q .996
(eentrant: standar)-.18 F 3.496(dI)-.18 G .996
(/O functions should not be called fr)310.478 328 R .996(om signal)-.18 F
(handlers.)129.6 340 Q 3.117 -.92(We r)147.6 352 T 1.277(evisit this pr).74 F
1.277(oblem of r)-.18 F 1.276(eentrancy in Chapter 23 and we will see how thr)
-.18 F(eads)-.18 E 1.125(handle the pr)129.6 364 R 1.126(oblem of the)-.18 F F3
(errno)3.626 E F4 3.626(variable. The)3.626 F 1.126
(next section describes some r)3.626 F(eentrant)-.18 E
(versions of the hostname functions.)129.6 376 Q/F7 12/Helvetica-Bold@0 SF
(11.15)93.6 412 Q/F8 12/Courier-Bold@0 SF(gethostbyname_r)5.976 E F7(and)6.672
E F8(gethostbyaddr_r)6.672 E F7(Functions)6.672 E F4(Ther)129.6 436 Q 4.012(ea)
-.18 G 1.872 -.18(re t)163.912 436 T 1.512(wo ways to make a nonr).18 F 1.511
(eentrant function such as)-.18 F F3(gethostbyname)4.011 E F4 -.18(re)4.011 G
(en-).18 E(trant.)129.6 448 Q 6.33(1. Instead)147.6 472 R .218
(of \214lling in and r)2.718 F .218(eturning a static str)-.18 F(uctur)-.08 E
.219(e, the caller allocates the str)-.18 F(uc-)-.08 E(tur)163.93 484 Q 4.044
(ea)-.18 G 1.544(nd the r)190.824 484 R 1.544
(eentrant function \214lls in the caller)-.18 F 1.544('s str).74 F(uctur)-.08 E
4.044(e. This)-.18 F 1.543(is the tech-)4.044 F 1.644(nique used in going fr)
163.93 496 R 1.644(om the nonr)-.18 F(eentrant)-.18 E F3(gethostbyname)4.144 E
F4 1.644(to the r)4.144 F(eentrant)-.18 E F3(gethostbyname_r)163.93 508 Q F4
5.72(.B)C .72(ut this solution gets mor)268.26 508 R 3.22(ec)-.18 G .72
(omplicated because not only)391.11 508 R .962(must the caller pr)163.93 520 R
.962(ovide the)-.18 F F3(hostent)3.462 E F4(str)3.462 E(uctur)-.08 E 3.462(et)
-.18 G 3.462<6f8c>381.914 520 S .963(ll in, but this str)396.886 520 R(uctur)
-.08 E 3.463(ea)-.18 G(lso)506.99 520 Q .76(points to other information: the c\
anonical name, the array of alias pointers, the)163.93 532 R .966
(alias strings, the array of addr)163.93 544 R .966(ess pointers, and the addr)
-.18 F .966(esses \(e.g., Figur)-.18 F 3.466(e9)-.18 G(.2\).)506.27 544 Q .134
(The caller must pr)163.93 556 R .134(ovide one lar)-.18 F .134(ge buf)-.18 F
.134(fer that is used for this additional informa-)-.18 F .14(tion and the)
163.93 568 R F3(hostent)2.641 E F4(str)2.641 E(uctur)-.08 E 2.641(et)-.18 G
.141(hat is \214lled in then contains numer)310.333 568 R .141(ous pointers)
-.18 F 2.251(into this other buf)163.93 580 R(fer)-.18 E 7.251(.T)-.74 G 2.251
(his adds at least thr)277.064 580 R 2.251(ee ar)-.18 F 2.25
(guments to the function: a)-.18 F .841(pointer to the)163.93 592 R F3(hostent)
3.341 E F4(str)3.341 E(uctur)-.08 E 3.341(et)-.18 G 3.341<6f8c>320.375 592 S
.841(ll in, a pointer to the buf)335.226 592 R .842(fer to use for all)-.18 F
.441(the other information, and the size of this buf)163.93 604 R(fer)-.18 E
5.441(.A)-.74 G .44(fourth additional ar)397.32 604 R(gument)-.18 E 1.334
(is also r)163.93 616 R(equir)-.18 E 1.334
(ed, a pointer to an integer in which an err)-.18 F 1.334(or code can be stor)
-.18 F(ed,)-.18 E 1.593(since the global integer)163.93 628 R F3(h_errno)4.093
E F4 1.592(can no longer be used.)4.093 F 1.592(\(The global integer)6.592 F F3
(h_errno)163.93 640 Q F4(pr)2.602 E .102(esents the same r)-.18 F .102
(eentrancy pr)-.18 F .102(oblem that we described with)-.18 F F3(errno)2.602 E
F4(.\))A(This technique is also used by)163.93 658 Q F3(getnameinfo)2.5 E F4
(and)2.5 E F3(inet_ntop)2.5 E F4(.)A/F9 7/Palatino-Roman@0 SF 1.75<a943>233.453
678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 304 32
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(304)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF 6.33(2. The)147.6 123 R -.18(re)4.804 G 2.304
(entrant function calls).18 F/F3 10/Courier@0 SF(malloc)4.803 E F2 2.303
(and dynamically allocates the memory)4.803 F(.)-1.11 E .838
(This is the technique used by)163.93 135 R F3(getaddrinfo)3.338 E F2 5.838(.T)
C .838(he pr)380.266 135 R .839(oblem with this appr)-.18 F(oach)-.18 E .175
(is that the application calling this function must also call)163.93 147 R F3
(freeaddrinfo)2.675 E F2 .175(to fr)2.675 F(ee)-.18 E 1.558(the dynamic memory)
163.93 159 R 6.558(.I)-1.11 G 4.058(ft)273.324 159 S 1.558(he fr)283.972 159 R
1.559(ee function is not called, a)-.18 F/F4 10/Palatino-Italic@0 SF 1.559
(memory leak)4.059 F F2(occurs:)4.059 E .771(each time the pr)163.93 171 R .771
(ocess calls the function that allocates the memory)-.18 F 3.27(,t)-1.11 G .77
(he memory)468.3 171 R .412(use of the pr)163.93 183 R .412(ocess incr)-.18 F
2.912(eases. If)-.18 F .413(the pr)2.913 F .413(ocess r)-.18 F .413
(uns for a long time \(a common trait)-.08 F
(of network servers\), the memory usage just gr)163.93 195 Q(ows and gr)-.18 E
(ows over time.)-.18 E 5.793 -.92(We n)147.6 221.4 T 3.953
(ow discuss the Solaris 2.x r).92 F 3.953(eentrant functions for name-to-addr)
-.18 F 3.953(ess and)-.18 F(addr)129.6 233.4 Q(ess-to-name r)-.18 E(esolution.)
-.18 E/F5 8.15/Courier@0 SF(#include <netdb.h>)147.6 255.4 Q
(struct hostent *gethostbyname_r\(const char *)147.6 275.4 Q/F6 8.15
/Palatino-Italic@0 SF(hostname)A F5(,)A(struct hostent *)304.08 285.4 Q F6
-.147(re)C(sult).147 E F5(,)A(char *)304.08 295.4 Q F6(buf)A F5 4.89(,i)C(nt)
358.66 295.4 Q F6(bu\215en)4.89 E F5 4.89(,i)C(nt *)408.447 295.4 Q F6
(h_errnop)A F5(\);)A(struct hostent *gethostbyaddr_r\(const char *)147.6 315.4
Q F6(addr)A F5 4.89(,i)C(nt)392.369 315.4 Q F6(len)4.89 E F5 4.89(,i)C(nt)
431.676 315.4 Q F6(type)4.89 E F5(,)A(struct hostent *)304.08 325.4 Q F6 -.147
(re)C(sult).147 E F5(,)A(char *)304.08 335.4 Q F6(buf)A F5 4.89(,i)C(nt)358.66
335.4 Q F6(bu\215en)4.89 E F5 4.89(,i)C(nt *)408.447 335.4 Q F6(h_errnop)A F5
(\);)A/F7 8.15/Palatino-Roman@0 SF(Both r)323.275 355.4 Q
(eturn: nonnull pointer if OK,)-.147 E F5(NULL)2.038 E F7(on err)2.038 E(or)
-.147 E .326 LW 129.6 243.175 129.6 359.475 DL 519.6 243.175 129.6 243.175 DL
519.6 359.475 519.6 243.175 DL 129.6 359.475 519.6 359.475 DL F2 .251
(Four additional ar)129.6 379.4 R .251(guments ar)-.18 F 2.751(er)-.18 G(equir)
271.724 379.4 Q .252(ed for each function.)-.18 F F4 -.18(re)5.252 G(sult).18 E
F2 .252(is a)2.752 F F3(hostent)2.752 E F2(str)2.752 E(uctur)-.08 E(e)-.18 E
.554(allocated by the caller which is \214lled in by the function.)129.6 391.4
R .553(On success this pointer is also)5.554 F(the r)129.6 403.4 Q
(eturn value of the function.)-.18 E F4(buf)147.6 415.4 Q F2 .88(is a buf)3.38
F .88(fer allocated by the caller and)-.18 F F4(bu\215en)3.38 E F2 .88
(is its size.)3.38 F .88(This buf)5.88 F .88(fer will contain)-.18 F 1.278
(the canonical hostname, the alias pointers, the alias strings, the addr)129.6
427.4 R 1.277(ess pointers, and)-.18 F .202(the actual addr)129.6 439.4 R 2.702
(esses. All)-.18 F .202(the pointers in the str)2.702 F(uctur)-.08 E 2.702(ep)
-.18 G .202(ointed to by)374.928 439.4 R F4 -.18(re)2.702 G(sult).18 E F2 .202
(point into this)2.702 F(buf)129.6 451.4 Q(fer)-.18 E 5.21(.H)-.74 G .21
(ow big should this buf)171.67 451.4 R .21(fer be?)-.18 F .21
(Unfortunately all that most manual pages say is)5.21 F .948
(something vague like `)129.6 463.4 R .948(`The buf)-.37 F .948
(fer must be lar)-.18 F .948(ge enough to hold all of the data associ-)-.18 F
.604(ated with the host entry)129.6 475.4 R(.')-1.11 E 5.604('C)-.37 G(urr)
256.81 475.4 Q .604(ent implementations of)-.18 F F3(gethostbyname)3.103 E F2
.603(can r)3.103 F .603(eturn up)-.18 F .719(to 35 alias pointers, 35 addr)
129.6 487.4 R .719(ess pointers, and internally use an 8192)-.18 F(-)-.9 I .72
(byte buf).9 J .72(fer to hold)-.18 F(the alias names and addr)129.6 499.4 Q
2.5(esses. So)-.18 F 2.5(ab)2.5 G(uf)296.17 499.4 Q
(fer size of 8192 bytes should be adequate.)-.18 E .897(If an err)147.6 511.4 R
.897(or occurs, the err)-.18 F .896(or code is r)-.18 F .896(eturned thr)-.18 F
.896(ough the)-.18 F F4(h_errnop)3.396 E F2(pointer)3.396 E 3.396(,a)-.74 G
.896(nd not)489.734 511.4 R(thr)129.6 523.4 Q(ough the global)-.18 E F3
(h_errno)2.5 E F2(.)A/F8 8/Palatino-Roman@0 SF .214(Unfortunately this pr)183.6
547 R .215(oblem of r)-.144 F .215(eentrancy is even worse than it appears.)
-.144 F .215(First, ther)4.215 F 2.215(ei)-.144 G 2.215(sn)485.434 547 S 2.215
(os)495.697 547 S(tan-)505.672 547 Q(dar)183.6 557 Q 3.932(dr)-.144 G(egar)
207.34 557 Q 1.932(ding r)-.144 F 1.932(eentrancy and)-.144 F/F9 8/Courier@0 SF
(gethostbyname)3.932 E F8(and)3.932 E F9(gethostbyaddr)3.932 E F8 5.932(.P)C
1.932(osix.1g speci\214es)461.028 557 R .177
(both functions but says nothing about thr)183.6 567 R .177(ead safety)-.144 F
4.177(.U)-.888 G .177(nix 98 just says that these two functions)378.432 567 R
(need not be thr)183.6 577 Q(ead-safe.)-.144 E 1.022(Second, ther)183.6 597 R
3.022(ei)-.144 G 3.022(sn)237.412 597 S 3.022(os)248.482 597 S(tandar)259.264
597 Q 3.022(df)-.144 G 1.022(or the)293.006 597 R F9(_r)3.022 E F8 3.022
(functions. What)3.022 F 1.022(we have shown in this section \(for)3.022 F .811
(example purposes\) ar)183.6 607 R 2.811(et)-.144 G .811(wo of the)270.729 607
R F9(_r)2.812 E F8 .812(functions pr)2.812 F .812(ovided by Solaris 2.x.)-.144
F .812(But Digital Unix 4.0)4.812 F 1.4(and HP)183.6 617 R(-)-.72 I 1.4
(UX 10.30 have versions of these functions with dif).72 J(fer)-.144 E 1.4
(ent ar)-.144 F 3.4(guments. The)-.144 F 1.4(\214rst two)3.4 F(ar)183.6 627 Q
.153(guments for)-.144 F F9(gethostbyname_r)2.153 E F8(ar)2.153 E 2.153(et)
-.144 G .153(he same as the Solaris version, but the r)325.7 627 R .154
(emaining thr)-.144 F(ee)-.144 E(ar)183.6 637 Q .824
(guments for the Solaris version ar)-.144 F 2.823(ec)-.144 G .823
(ombined into a new)324.102 637 R F9(hostent_data)2.823 E F8(str)2.823 E(uctur)
-.064 E 2.823(e\()-.144 G(which)497.736 637 Q .293
(must be allocated by the caller\), and a pointer to this str)183.6 647 R
(uctur)-.064 E 2.293(ei)-.144 G 2.293(st)410.335 647 S .293(he thir)418.628 647
R 2.293(da)-.144 G .293(nd \214nal ar)453.198 647 R(gument.)-.144 E .531
(The normal functions)183.6 657 R F9(gethostbyname)2.53 E F8(and)2.53 E F9
(gethostbyaddr)2.53 E F8 .53(in Digital Unix 4.0 and HP)2.53 F(-)-.72 I(UX).72
I/F10 7/Palatino-Roman@0 SF 1.75<a943>233.453 676 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 305 33
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(305)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 8/Palatino-Roman@0 SF .788(10.30 ar)183.6 121 R
2.789(er)-.144 G .789(eentrant, by using thr)221.041 121 R .789
(ead-speci\214c data \(Section 23.5\).)-.144 F .789(An inter)4.789 F .789
(esting history of the)-.144 F(development of the Solaris 2.x)183.6 131 Q/F4 8
/Courier@0 SF(_r)2 E F3(functions is in)2 E([)2 -.32 M(Maslen 1997).32 I(])-.32
I(.).32 I(Lastly)183.6 151 Q 4.517(,w)-.888 G 2.517(hile a r)217.565 151 R
2.517(eentrant version of)-.144 F F4(gethostbyname)4.516 E F3 2.516(may pr)
4.516 F 2.516(ovide safety fr)-.144 F 2.516(om dif)-.144 F(fer)-.144 E(ent)
-.144 E(thr)183.6 161 Q .966
(eads calling it at the same time, this says nothing about the r)-.144 F .967
(eentrancy of the underlying)-.144 F -.144(re)183.6 171 S(solver functions.)
.144 E(As of this writing, the r)4 E(esolver functions in BIND ar)-.144 E 2(en)
-.144 G(ot r)446.432 171 Q(eentrant.)-.144 E/F5 12/Helvetica-Bold@0 SF 2.64
(11.16 Implementation)93.6 207 R(of)6.672 E/F6 12/Courier-Bold@0 SF
(getaddrinfo)6.672 E F5(and)6.672 E F6(getnameinfo)6.672 E F5(Functions)6.672 E
/F7 10/Palatino-Roman@0 SF 2.648 -.92(We n)129.6 231 T .808
(ow look at an implementation of).92 F/F8 10/Courier@0 SF(getaddrinfo)3.308 E
F7(and)3.308 E F8(getnameinfo)3.308 E F7 5.808(.D)C(eveloping)475.7 231 Q .436
(an implementation of the former will let us look at how it operates in mor)
129.6 243 R 2.936(ed)-.18 G 2.936(etail. Our)474.954 243 R(implementation also\
 supports Unix domain sockets, as we mentioned in Section 1)129.6 255 Q(1.5.)
-.55 E F3 .264(Note: All of the appr)183.6 275 R .263
(opriate portions of the code that we look at in this section that ar)-.144 F
2.263(ed)-.144 G(epen-)499.808 275 Q .702
(dent on IPv4, IPv6, or Unix domain support, ar)183.6 285 R 2.702(eb)-.144 G
.702(ounded by an)366.43 285 R F4(#ifdef)2.702 E F3(and)2.702 E F4(#endif)2.702
E F3 .702(of the)2.702 F(appr)183.6 295 Q .355(opriate constant:)-.144 F F4
(IPV4)2.355 E F3(,)A F4(IPV6)2.355 E F3 2.355(,o)C(r)313.364 295 Q F4
(UNIXDOMAIN)2.355 E F3 4.355(.T)C .355(his allows the code to be compiled on a)
378.138 295 R .153(system that supports any combination of these thr)183.6 305
R .153(ee pr)-.144 F 2.153(otocols. But)-.144 F .153(we have r)2.153 F .154
(emoved all these)-.144 F(pr)183.6 315 Q(epr)-.144 E .492
(ocessor statements fr)-.144 F .492
(om the code that we show because they add nothing to our discus-)-.144 F
(sion and make the code har)183.6 325 Q(der to follow)-.144 E(.)-.736 E 1.472
-.736(We a)183.6 345 T
(lso note that we do not cover Unix domain sockets in detail until Chapter 14.)
.736 E F7(Figur)147.6 363 Q 3.371(e1)-.18 G .871
(1.18 shows the functions that ar)184.041 363 R 3.372(ec)-.18 G .872(alled by)
340.39 363 R F8(getaddrinfo)3.372 E F7 5.872(.A)C .872(ll begin with)462.096
363 R(the)129.6 375 Q F8(ga_)2.5 E F7(pr)2.5 E(e\214x.)-.18 E 64.8 16.2 166.2
444.336 DE ST F4(ga_echeck)144.6 446.096 Q 64.8 16.2 245.4 444.336 DE ST
(ga_unix)228.6 446.096 Q 64.8 16.2 324.6 444.336 DE ST(ga_nsearch)300.6 446.096
Q 64.8 16.2 483 444.336 DE ST(ga_serv)466.2 446.096 Q 64.8 16.2 324.6 392.136
DE ST(getaddrinfo)298.2 393.896 Q 64.8 16.2 403.8 496.536 DE ST(ga_aistruct)
377.4 498.296 Q 483 488.4 483 452.4 DL 483 488.4 MT -1.656 -5.04 RL 3.384 0 RL
CL BL 483 488.4 MT -1.656 -5.04 RL 3.384 0 RL CL ST 64.8 16.2 483 496.536 DE ST
(ga_port)466.2 498.296 Q 483 540.6 483 504.6 DL 483 540.6 MT -1.656 -5.04 RL
3.384 0 RL CL BL 483 540.6 MT -1.656 -5.04 RL 3.384 0 RL CL ST 64.8 16.2 483
548.736 DE ST(ga_clone)463.8 550.496 Q 166.2 436.2 310.2 400.2 DL 166.2 436.2
MT 4.536 -2.88 RL .792 3.24 RL CL BL 166.2 436.2 MT 4.536 -2.88 RL .792 3.24 RL
CL ST 245.4 436.2 317.4 400.2 DL 245.4 436.2 MT 3.744 -3.744 RL 1.512 3.024 RL
CL BL 245.4 436.2 MT 3.744 -3.744 RL 1.512 3.024 RL CL ST 324.6 436.2 324.6
400.2 DL 324.6 436.2 MT -1.656 -5.04 RL 3.384 0 RL CL BL 324.6 436.2 MT -1.656
-5.04 RL 3.384 0 RL CL ST 403.8 488.4 331.8 400.2 DL 403.8 488.4 MT -4.536
-2.88 RL 2.592 -2.16 RL CL BL 403.8 488.4 MT -4.536 -2.88 RL 2.592 -2.16 RL CL
ST 483 436.2 339 400.2 DL 483 436.2 MT -5.328 .432 RL .792 -3.24 RL CL BL 483
436.2 MT -5.328 .432 RL .792 -3.24 RL CL ST 380.904 490.776 245.4 452.4 DL
380.904 490.776 MT -5.328 .216 RL .936 -3.24 RL CL BL 380.904 490.776 MT -5.328
.216 RL .936 -3.24 RL CL ST/F9 8/Palatino-Bold@0 SF(Figure 1)196.32 575.8 Q
(1.18)-.296 E F3(Functions called by our implementation of)6 E F4(getaddrinfo)2
E F3(.)A F7 .288(The \214rst \214le is our)147.6 599.8 R F8(gai_hdr.h)2.788 E
F7(header)2.788 E 2.788(,s)-.74 G .288(hown in Figur)328.156 599.8 R 2.788(e1)
-.18 G .288(1.19, which is included by)403.76 599.8 R(all our sour)129.6 611.8
Q(ce \214les.)-.18 E 2.833 -.92(We i)147.6 623.8 T .993(nclude our normal).92 F
F8(unp.h)3.493 E F7 .993(header and one additional header)3.493 F 5.993(.W)-.74
G 3.493(ew)459.57 623.8 S .993(ill see the)476.193 623.8 R 1.927(use of our)
129.6 635.8 R F8(AI_CLONE)4.427 E F7 1.927(\215ag and our)4.427 F F8(search)
4.427 E F7(str)4.427 E(uctur)-.08 E 4.427(es)-.18 G(hortly)385.673 635.8 Q
6.927(.T)-1.11 G 1.927(he r)427.08 635.8 R 1.927(emainder of the)-.18 F 1.274
(header de\214nes the function pr)129.6 647.8 R 1.275
(ototypes for the various functions we show in this sec-)-.18 F(tion.)129.6
659.8 Q/F10 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)
-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 306 34
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(306)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 123 129.6 123 DL 136.271 123 131.271 123 DL 141.271 123 136.271 123 DL
146.271 123 141.271 123 DL 151.271 123 146.271 123 DL 156.271 123 151.271 123
DL 161.271 123 156.271 123 DL 166.271 123 161.271 123 DL 171.271 123 166.271
123 DL 176.271 123 171.271 123 DL 181.271 123 176.271 123 DL 186.271 123
181.271 123 DL 191.271 123 186.271 123 DL 196.271 123 191.271 123 DL 201.271
123 196.271 123 DL 206.271 123 201.271 123 DL 211.271 123 206.271 123 DL
216.271 123 211.271 123 DL 221.271 123 216.271 123 DL 226.271 123 221.271 123
DL 231.271 123 226.271 123 DL 236.271 123 231.271 123 DL 241.271 123 236.271
123 DL 246.271 123 241.271 123 DL 251.271 123 246.271 123 DL 256.271 123
251.271 123 DL 261.271 123 256.271 123 DL 266.271 123 261.271 123 DL 271.271
123 266.271 123 DL 276.271 123 271.271 123 DL 281.271 123 276.271 123 DL
286.271 123 281.271 123 DL 291.271 123 286.271 123 DL 296.271 123 291.271 123
DL 301.271 123 296.271 123 DL 306.271 123 301.271 123 DL 311.271 123 306.271
123 DL 316.271 123 311.271 123 DL 321.271 123 316.271 123 DL 326.271 123
321.271 123 DL 331.271 123 326.271 123 DL 336.271 123 331.271 123 DL 341.271
123 336.271 123 DL 346.271 123 341.271 123 DL 351.271 123 346.271 123 DL
356.271 123 351.271 123 DL 361.271 123 356.271 123 DL 366.271 123 361.271 123
DL 371.271 123 366.271 123 DL 376.271 123 371.271 123 DL 381.271 123 376.271
123 DL 386.271 123 381.271 123 DL 391.271 123 386.271 123 DL 396.271 123
391.271 123 DL 401.271 123 396.271 123 DL 406.271 123 401.271 123 DL 411.271
123 406.271 123 DL 416.271 123 411.271 123 DL 421.271 123 416.271 123 DL
426.271 123 421.271 123 DL 431.271 123 426.271 123 DL 436.271 123 431.271 123
DL 441.271 123 436.271 123 DL 446.271 123 441.271 123 DL 451.271 123 446.271
123 DL 456.271 123 451.271 123 DL 461.271 123 456.271 123 DL/F2 9
/Palatino-Italic@0 SF(libgai/gai_hdr)463.521 125.5 Q(.c)-.666 E/F3 8.15
/Courier@0 SF 4.89(1#)139.38 131.801 S 14.67(include "unp.h")154.05 131.801 R
4.89(2#)139.38 141.801 S 14.67(include <ctype.h>)154.05 141.801 R
(/* isxdigit\(\), etc. */)305.64 141.801 Q 44.01(3/)139.38 157.801 S 4.89(*f)
193.17 157.801 S
(ollowing internal flag cannot overlap with other AI_xxx flags */)207.84
157.801 Q 4.89(4#)139.38 167.801 S(define AI_CLONE)154.05 167.801 Q 29.34(4/)
271.41 167.801 S 4.89(*c)310.53 167.801 S
(lone this entry for other socket types */)325.2 167.801 Q 4.89(5s)139.38
183.801 S(truct search {)154.05 183.801 Q 24.45(6c)139.38 193.801 S
(onst char *host;)173.61 193.801 Q(/* hostname or address string */)305.64
193.801 Q 24.45(7i)139.38 203.801 S 19.56(nt family;)173.61 203.801 R
(/* AF_xxx */)305.64 203.801 Q 4.89(8})139.38 213.801 S(;)154.05 213.801 Q
63.57(9/)139.38 229.801 S 4.89(*f)212.73 229.801 S
(unction prototypes for our own internal functions */)227.4 229.801 Q(10 int)
134.49 239.801 Q(ga_aistruct\(struct addrinfo ***, const struct addrinfo *,)
188.28 239.801 Q 97.8(11 const)134.49 249.801 R(void *, int\);)4.89 E
(12 struct addrinfo *ga_clone\(struct addrinfo *\);)134.49 259.801 Q(13 int)
134.49 269.801 Q(ga_echeck\(const char *, const char *, int, int, int, int\);)
188.28 269.801 Q(14 int)134.49 279.801 Q
(ga_nsearch\(const char *, const struct addrinfo *, struct search *\);)188.28
279.801 Q(15 int)134.49 289.801 Q(ga_port\(struct addrinfo *, int, int\);)
188.28 289.801 Q(16 int)134.49 299.801 Q
(ga_serv\(struct addrinfo *, const struct addrinfo *, const char *\);)188.28
299.801 Q(17 int)134.49 309.801 Q
(ga_unix\(const char *, struct addrinfo *, struct addrinfo **\);)188.28 309.801
Q(18 int)134.49 325.801 Q
(gn_ipv46\(char *, size_t, char *, size_t, void *, size_t,)188.28 325.801 Q
83.13(19 int,)134.49 335.801 R(int, int\);)4.89 E 134.6 340.602 129.6 340.602
DL 136.271 340.602 131.271 340.602 DL 141.271 340.602 136.271 340.602 DL
146.271 340.602 141.271 340.602 DL 151.271 340.602 146.271 340.602 DL 156.271
340.602 151.271 340.602 DL 161.271 340.602 156.271 340.602 DL 166.271 340.602
161.271 340.602 DL 171.271 340.602 166.271 340.602 DL 176.271 340.602 171.271
340.602 DL 181.271 340.602 176.271 340.602 DL 186.271 340.602 181.271 340.602
DL 191.271 340.602 186.271 340.602 DL 196.271 340.602 191.271 340.602 DL
201.271 340.602 196.271 340.602 DL 206.271 340.602 201.271 340.602 DL 211.271
340.602 206.271 340.602 DL 216.271 340.602 211.271 340.602 DL 221.271 340.602
216.271 340.602 DL 226.271 340.602 221.271 340.602 DL 231.271 340.602 226.271
340.602 DL 236.271 340.602 231.271 340.602 DL 241.271 340.602 236.271 340.602
DL 246.271 340.602 241.271 340.602 DL 251.271 340.602 246.271 340.602 DL
256.271 340.602 251.271 340.602 DL 261.271 340.602 256.271 340.602 DL 266.271
340.602 261.271 340.602 DL 271.271 340.602 266.271 340.602 DL 276.271 340.602
271.271 340.602 DL 281.271 340.602 276.271 340.602 DL 286.271 340.602 281.271
340.602 DL 291.271 340.602 286.271 340.602 DL 296.271 340.602 291.271 340.602
DL 301.271 340.602 296.271 340.602 DL 306.271 340.602 301.271 340.602 DL
311.271 340.602 306.271 340.602 DL 316.271 340.602 311.271 340.602 DL 321.271
340.602 316.271 340.602 DL 326.271 340.602 321.271 340.602 DL 331.271 340.602
326.271 340.602 DL 336.271 340.602 331.271 340.602 DL 341.271 340.602 336.271
340.602 DL 346.271 340.602 341.271 340.602 DL 351.271 340.602 346.271 340.602
DL 356.271 340.602 351.271 340.602 DL 361.271 340.602 356.271 340.602 DL
366.271 340.602 361.271 340.602 DL 371.271 340.602 366.271 340.602 DL 376.271
340.602 371.271 340.602 DL 381.271 340.602 376.271 340.602 DL 386.271 340.602
381.271 340.602 DL 391.271 340.602 386.271 340.602 DL 396.271 340.602 391.271
340.602 DL 401.271 340.602 396.271 340.602 DL 406.271 340.602 401.271 340.602
DL 411.271 340.602 406.271 340.602 DL 416.271 340.602 411.271 340.602 DL
421.271 340.602 416.271 340.602 DL 426.271 340.602 421.271 340.602 DL 431.271
340.602 426.271 340.602 DL 436.271 340.602 431.271 340.602 DL 441.271 340.602
436.271 340.602 DL 446.271 340.602 441.271 340.602 DL 451.271 340.602 446.271
340.602 DL 456.271 340.602 451.271 340.602 DL 461.271 340.602 456.271 340.602
DL F2(libgai/gai_hdr)463.521 343.102 Q(.c)-.666 E/F4 8/Palatino-Bold@0 SF
(Figure 1)264.48 356.602 Q(1.19)-.296 E/F5 8/Courier@0 SF(gai_hdr.h)6 E/F6 8
/Palatino-Roman@0 SF(header)2 E(.)-.592 E/F7 10/Palatino-Roman@0 SF(Figur)147.6
383.002 Q 2.5(e1)-.18 G(1.20 shows the \214rst part of the)183.17 383.002 Q/F8
10/Courier@0 SF(getaddrinfo)2.5 E F7(function.)2.5 E/F9 9/Helvetica-Bold@0 SF
(De\214ne)129.6 399.002 Q/F10 9/Courier-Bold@0 SF(error)2.502 E F9(macr)2.502 E
(o)-.18 E/F11 7/Courier-Oblique@0 SF(13\21117)104.28 414.002 Q F7 .586(At mor)
147.6 414.002 R 3.086(et)-.18 G .586(han a dozen points thr)190.922 414.002 R
.586(oughout this function if we encounter an err)-.18 F(or)-.18 E 3.085(,w)
-.74 G(e)514.81 414.002 Q 1.089(want to fr)129.6 426.002 R 1.089
(ee all the memory that we have allocated and r)-.18 F 1.09(eturn the appr)-.18
F 1.09(opriate r)-.18 F(eturn)-.18 E 3.057(code. T)129.6 438.002 R 3.057(os)
-.92 G .557(implify the code we de\214ne this macr)176.424 438.002 R 3.057(ot)
-.18 G .557(hat stor)352.633 438.002 R .557(es the r)-.18 F .557
(eturn code in the vari-)-.18 F(able)129.6 450.002 Q F8(error)2.5 E F7
(and branches to the label)2.5 E F8(bad)2.5 E F7
(at the end of the function \(Figur)2.5 E 2.5(e1)-.18 G(1.26\).)468.56 450.002
Q F9 -2.412(Initializ e)129.6 466.002 R(automatic v)2.502 E(ariab)-.18 E(les)
-.09 E F11(18\21120)104.28 481.002 Q F7 1.598(Some automatic variables ar)147.6
481.002 R 4.098(ei)-.18 G 4.098(nitialized. W)288.962 481.002 R 4.098(ed)-.92 G
1.598(escribe the)363.758 481.002 R F8(aihead)4.098 E F7(and)4.098 E F8
(aipnext)4.098 E F7(pointers in Figur)129.6 493.002 Q 2.5(e1)-.18 G(1.34.)
215.34 493.002 Q F9(Cop)129.6 509.002 Q 2.502(yc)-.135 G(aller')159.471 509.002
Q(s)-.54 E F10(hints)2.502 E F9(structure)2.502 E F11(21\21125)104.28 524.002 Q
F7 .355(If the caller pr)147.6 524.002 R .355(ovides a)-.18 F/F12 10
/Palatino-Italic@0 SF(hints)2.855 E F7(str)2.855 E(uctur)-.08 E .354
(e, we copy it into our own local variable, so we)-.18 F 2.058
(can modify it later)129.6 536.002 R 7.058(.O)-.74 G 2.058
(therwise we start with a str)233.492 536.002 R(uctur)-.08 E 4.558(et)-.18 G
2.058(hat is all zer)400.06 536.002 R 2.058(o, other than)-.18 F F8(ai_family)
129.6 548.002 Q F7 3.005(,w)C .505(hich is initialized to)197.445 548.002 R F8
(AF_UNSPEC)3.005 E F7 5.505(.T)C .504(he latter is normally de\214ned to be 0,)
356.99 548.002 R(but this is not r)129.6 560.002 Q(equir)-.18 E
(ed by Posix.1g.)-.18 E F9(Chec)129.6 576.002 Q 2.502(ka)-.18 G -.135(rg)
163.935 576.002 S(uments).135 E F11(26\21129)104.28 591.002 Q F7 3.343 -.92
(We c)147.6 591.002 T 1.503(all our).92 F F8(ga_echeck)4.004 E F7 1.504
(function, shown in Figur)4.004 F 4.004(e1)-.18 G 1.504
(1.39, to validate some of the)389.25 591.002 R(ar)129.6 603.002 Q(guments.)
-.18 E F9(Chec)129.6 619.002 Q 2.502(kf)-.18 G(or Unix domain pathname)161.748
619.002 Q F11(30\21134)104.28 634.002 Q F7 1.782(If the hostname is either)
147.6 634.002 R F8(/local)4.282 E F7(or)4.282 E F8(/unix)4.281 E F7 1.781
(and the service name begins with a)4.281 F 1.12(slash, we pr)129.6 646.002 R
1.12(ocess this ar)-.18 F 1.12(gument as a Unix domain pathname.)-.18 F 1.12
(Our function)6.12 F F8(ga_unix)3.62 E F7(\(Figur)129.6 658.002 Q 2.5(e1)-.18 G
(1.33\) completely pr)168.5 658.002 Q(ocesses the pathname.)-.18 E/F13 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 307 35
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(307)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL .4 LW 134.6 124.2 129.6 124.2 DL 137.105 124.2 132.105
124.2 DL 142.105 124.2 137.105 124.2 DL 147.105 124.2 142.105 124.2 DL 152.105
124.2 147.105 124.2 DL 157.105 124.2 152.105 124.2 DL 162.105 124.2 157.105
124.2 DL 167.105 124.2 162.105 124.2 DL 172.105 124.2 167.105 124.2 DL 177.105
124.2 172.105 124.2 DL 182.105 124.2 177.105 124.2 DL 187.105 124.2 182.105
124.2 DL 192.105 124.2 187.105 124.2 DL 197.105 124.2 192.105 124.2 DL 202.105
124.2 197.105 124.2 DL 207.105 124.2 202.105 124.2 DL 212.105 124.2 207.105
124.2 DL 217.105 124.2 212.105 124.2 DL 222.105 124.2 217.105 124.2 DL 227.105
124.2 222.105 124.2 DL 232.105 124.2 227.105 124.2 DL 237.105 124.2 232.105
124.2 DL 242.105 124.2 237.105 124.2 DL 247.105 124.2 242.105 124.2 DL 252.105
124.2 247.105 124.2 DL 257.105 124.2 252.105 124.2 DL 262.105 124.2 257.105
124.2 DL 267.105 124.2 262.105 124.2 DL 272.105 124.2 267.105 124.2 DL 277.105
124.2 272.105 124.2 DL 282.105 124.2 277.105 124.2 DL 287.105 124.2 282.105
124.2 DL 292.105 124.2 287.105 124.2 DL 297.105 124.2 292.105 124.2 DL 302.105
124.2 297.105 124.2 DL 307.105 124.2 302.105 124.2 DL 312.105 124.2 307.105
124.2 DL 317.105 124.2 312.105 124.2 DL 322.105 124.2 317.105 124.2 DL 327.105
124.2 322.105 124.2 DL 332.105 124.2 327.105 124.2 DL 337.105 124.2 332.105
124.2 DL 342.105 124.2 337.105 124.2 DL 347.105 124.2 342.105 124.2 DL 352.105
124.2 347.105 124.2 DL 357.105 124.2 352.105 124.2 DL 362.105 124.2 357.105
124.2 DL 367.105 124.2 362.105 124.2 DL 372.105 124.2 367.105 124.2 DL 377.105
124.2 372.105 124.2 DL 382.105 124.2 377.105 124.2 DL 387.105 124.2 382.105
124.2 DL 392.105 124.2 387.105 124.2 DL 397.105 124.2 392.105 124.2 DL 402.105
124.2 397.105 124.2 DL 407.105 124.2 402.105 124.2 DL 412.105 124.2 407.105
124.2 DL 417.105 124.2 412.105 124.2 DL 422.105 124.2 417.105 124.2 DL 427.105
124.2 422.105 124.2 DL 432.105 124.2 427.105 124.2 DL 437.105 124.2 432.105
124.2 DL 442.105 124.2 437.105 124.2 DL 447.105 124.2 442.105 124.2 DL/F3 9
/Palatino-Italic@0 SF(libgai/getaddrinfo.c)449.355 126.7 Q/F4 8.15/Courier@0 SF
4.89(1#)139.38 133.001 S 14.67(include "gai_hdr.h")154.05 133.001 R 4.89(2#)
139.38 143.001 S 14.67(include <arpa/nameser.h> /*)154.05 143.001 R
(needed for <resolv.h> */)4.89 E 4.89(3#)139.38 153.001 S 14.67
(include <resolv.h>)154.05 153.001 R(/* res_init, _res */)305.64 153.001 Q 4.89
(4i)139.38 169.001 S(nt)154.05 169.001 Q 4.89(5g)139.38 179.001 S
(etaddrinfo\(const char *hostname, const char *servname,)154.05 179.001 Q 63.57
(6c)139.38 189.001 S(onst struct addrinfo *hintsp, struct addrinfo **result\))
212.73 189.001 Q 4.89(7{)139.38 199.001 S 24.45(8i)139.38 209.001 S 19.56
(nt rc,)173.61 209.001 R(error, nsearch;)4.89 E 24.45(9c)139.38 219.001 S 4.89
(har **ap,)173.61 219.001 R(*canon;)4.89 E 19.56(10 struct)134.49 229.001 R
(hostent *hptr;)4.89 E 19.56(11 struct)134.49 239.001 R
(search search[3], *sptr;)4.89 E 19.56(12 struct)134.49 249.001 R
(addrinfo hints, *aihead, **aipnext;)4.89 E 19.56(13 /*)134.49 265.001 R 24.45
(14 *)134.49 275.001 R
(If we encounter an error we want to free\(\) any dynamic memory)4.89 E 24.45
(15 *)134.49 285.001 R(that we've allocated.)4.89 E
(This is our hack to simplify the code.)9.78 E 24.45(16 */)134.49 295.001 R
(17 #define error\(e\) { error = \(e\); goto bad; })134.49 305.001 Q 19.56
(18 aihead)134.49 321.001 R 4.89(=N)4.89 G 63.57(ULL; /*)217.62 321.001 R
(initialize automatic variables */)4.89 E 19.56(19 aipnext)134.49 331.001 R
4.89(=&)4.89 G(aihead;)222.51 331.001 Q 19.56(20 canon)134.49 341.001 R 4.89
(=N)4.89 G(ULL;)212.73 341.001 Q 19.56(21 if)134.49 357.001 R
(\(hintsp == NULL\) {)4.89 E 39.12(22 bzero\(&hints,)134.49 367.001 R
(sizeof\(hints\)\);)4.89 E 39.12(23 hints.ai_family)134.49 377.001 R 4.89(=A)
4.89 G(F_UNSPEC;)281.19 377.001 Q 19.56(24 })134.49 387.001 R(else)4.89 E 39.12
(25 hints)134.49 397.001 R 4.89(=*)4.89 G 34.23(hintsp; /*)232.29 397.001 R
(struct copy */)4.89 E 39.12(26 /*)134.49 413.001 R
(first some basic error checking */)4.89 E 19.56(27 if)134.49 423.001 R 4.89
(\(\()4.89 G
(rc = ga_echeck\(hostname, servname, hints.ai_flags, hints.ai_family,)198.06
423.001 Q 117.36(28 hints.ai_socktype,)134.49 433.001 R
(hints.ai_protocol\)\) != 0\))4.89 E 39.12(29 error\(rc\);)134.49 443.001 R
39.12(30 /*)134.49 459.001 R(special case Unix domain first */)4.89 E 19.56
(31 if)134.49 469.001 R(\(hostname != NULL &&)4.89 E 24.45
(32 \(strcmp\(hostname,)134.49 479.001 R
("/local"\) == 0 || strcmp\(hostname, "/unix"\) == 0\) &&)4.89 E 39.12
(33 \(servname)134.49 489.001 R(!= NULL && servname[0] == '/'\)\))4.89 E 39.12
(34 return)134.49 499.001 R(\(ga_unix\(servname, &hints, result\)\);)4.89 E
134.6 503.802 129.6 503.802 DL 137.105 503.802 132.105 503.802 DL 142.105
503.802 137.105 503.802 DL 147.105 503.802 142.105 503.802 DL 152.105 503.802
147.105 503.802 DL 157.105 503.802 152.105 503.802 DL 162.105 503.802 157.105
503.802 DL 167.105 503.802 162.105 503.802 DL 172.105 503.802 167.105 503.802
DL 177.105 503.802 172.105 503.802 DL 182.105 503.802 177.105 503.802 DL
187.105 503.802 182.105 503.802 DL 192.105 503.802 187.105 503.802 DL 197.105
503.802 192.105 503.802 DL 202.105 503.802 197.105 503.802 DL 207.105 503.802
202.105 503.802 DL 212.105 503.802 207.105 503.802 DL 217.105 503.802 212.105
503.802 DL 222.105 503.802 217.105 503.802 DL 227.105 503.802 222.105 503.802
DL 232.105 503.802 227.105 503.802 DL 237.105 503.802 232.105 503.802 DL
242.105 503.802 237.105 503.802 DL 247.105 503.802 242.105 503.802 DL 252.105
503.802 247.105 503.802 DL 257.105 503.802 252.105 503.802 DL 262.105 503.802
257.105 503.802 DL 267.105 503.802 262.105 503.802 DL 272.105 503.802 267.105
503.802 DL 277.105 503.802 272.105 503.802 DL 282.105 503.802 277.105 503.802
DL 287.105 503.802 282.105 503.802 DL 292.105 503.802 287.105 503.802 DL
297.105 503.802 292.105 503.802 DL 302.105 503.802 297.105 503.802 DL 307.105
503.802 302.105 503.802 DL 312.105 503.802 307.105 503.802 DL 317.105 503.802
312.105 503.802 DL 322.105 503.802 317.105 503.802 DL 327.105 503.802 322.105
503.802 DL 332.105 503.802 327.105 503.802 DL 337.105 503.802 332.105 503.802
DL 342.105 503.802 337.105 503.802 DL 347.105 503.802 342.105 503.802 DL
352.105 503.802 347.105 503.802 DL 357.105 503.802 352.105 503.802 DL 362.105
503.802 357.105 503.802 DL 367.105 503.802 362.105 503.802 DL 372.105 503.802
367.105 503.802 DL 377.105 503.802 372.105 503.802 DL 382.105 503.802 377.105
503.802 DL 387.105 503.802 382.105 503.802 DL 392.105 503.802 387.105 503.802
DL 397.105 503.802 392.105 503.802 DL 402.105 503.802 397.105 503.802 DL
407.105 503.802 402.105 503.802 DL 412.105 503.802 407.105 503.802 DL 417.105
503.802 412.105 503.802 DL 422.105 503.802 417.105 503.802 DL 427.105 503.802
422.105 503.802 DL 432.105 503.802 427.105 503.802 DL 437.105 503.802 432.105
503.802 DL 442.105 503.802 437.105 503.802 DL 447.105 503.802 442.105 503.802
DL F3(libgai/getaddrinfo.c)449.355 506.302 Q/F5 8/Palatino-Bold@0 SF(Figure 1)
215.02 519.802 Q(1.20)-.296 E/F6 8/Courier@0 SF(getaddrinfo)6 E/F7 8
/Palatino-Roman@0 SF(function: \214rst part, initialization.)2 E/F8 10
/Palatino-Roman@0 SF 2.093(The r)147.6 543.802 R 2.093(emainder of our)-.18 F
/F9 10/Courier@0 SF(getaddrinfo)4.593 E F8 2.093
(function \(which continues in Figur)4.593 F 4.593(e1)-.18 G(1.24\))498.77
543.802 Q .522(deals with IPv4 and IPv6 sockets.)129.6 555.802 R .522
(Our function)5.522 F F9(ga_nsearch)3.022 E F8 3.022(,t)C .522
(he \214rst part of which is)414.888 555.802 R .97(shown in Figur)129.6 567.802
R 3.47(e1)-.18 G .969
(1.21, calculates the number of times that we look up a hostname.)211.49
567.802 R(If)5.969 E 1.23(the caller speci\214es an addr)129.6 579.802 R 1.23
(ess family of)-.18 F F9(AF_INET)3.73 E F8(or)3.73 E F9(AF_INET6)3.73 E F8 3.73
(,t)C 1.23(hen we look up the)429.82 579.802 R .4(hostname only one time.)129.6
591.802 R .4(But if the addr)5.4 F .4(ess family is unspeci\214ed,)-.18 F F9
(AF_UNSPEC)2.9 E F8 2.9(,t)C .4(hen we)487.14 591.802 R .337
(do two lookups: once for an IPv6 hostname, and again for an IPv4 hostname.)
129.6 603.802 R 2.178 -.92(We s)5.338 H(how).92 E(the function in thr)129.6
615.802 Q(ee parts:)-.18 E 7.5<836e>147.6 633.802 S 2.5(oh)166.98 633.802 S
(ostname and)180.76 633.802 Q F9(AI_PASSIVE)2.5 E F8(speci\214ed,)2.5 E 7.5
<836e>147.6 645.802 S 2.5(oh)166.98 645.802 S(ostname and)180.76 645.802 Q F9
(AI_PASSIVE)2.5 E F8(not speci\214ed \(i.e., active\), and)2.5 E 7.5<8368>147.6
657.802 S(ostname speci\214ed.)166.98 657.802 Q/F10 7/Palatino-Roman@0 SF 1.75
<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 308 36
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(308)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF(These thr)129.6 123 Q(ee parts corr)-.18 E
(espond to the thr)-.18 E(ee major portions of Figur)-.18 E 2.5(e1)-.18 G(1.4.)
427.38 123 Q .4 LW 134.6 136.2 129.6 136.2 DL 138.104 136.2 133.104 136.2 DL
143.104 136.2 138.104 136.2 DL 148.104 136.2 143.104 136.2 DL 153.104 136.2
148.104 136.2 DL 158.104 136.2 153.104 136.2 DL 163.104 136.2 158.104 136.2 DL
168.104 136.2 163.104 136.2 DL 173.104 136.2 168.104 136.2 DL 178.104 136.2
173.104 136.2 DL 183.104 136.2 178.104 136.2 DL 188.104 136.2 183.104 136.2 DL
193.104 136.2 188.104 136.2 DL 198.104 136.2 193.104 136.2 DL 203.104 136.2
198.104 136.2 DL 208.104 136.2 203.104 136.2 DL 213.104 136.2 208.104 136.2 DL
218.104 136.2 213.104 136.2 DL 223.104 136.2 218.104 136.2 DL 228.104 136.2
223.104 136.2 DL 233.104 136.2 228.104 136.2 DL 238.104 136.2 233.104 136.2 DL
243.104 136.2 238.104 136.2 DL 248.104 136.2 243.104 136.2 DL 253.104 136.2
248.104 136.2 DL 258.104 136.2 253.104 136.2 DL 263.104 136.2 258.104 136.2 DL
268.104 136.2 263.104 136.2 DL 273.104 136.2 268.104 136.2 DL 278.104 136.2
273.104 136.2 DL 283.104 136.2 278.104 136.2 DL 288.104 136.2 283.104 136.2 DL
293.104 136.2 288.104 136.2 DL 298.104 136.2 293.104 136.2 DL 303.104 136.2
298.104 136.2 DL 308.104 136.2 303.104 136.2 DL 313.104 136.2 308.104 136.2 DL
318.104 136.2 313.104 136.2 DL 323.104 136.2 318.104 136.2 DL 328.104 136.2
323.104 136.2 DL 333.104 136.2 328.104 136.2 DL 338.104 136.2 333.104 136.2 DL
343.104 136.2 338.104 136.2 DL 348.104 136.2 343.104 136.2 DL 353.104 136.2
348.104 136.2 DL 358.104 136.2 353.104 136.2 DL 363.104 136.2 358.104 136.2 DL
368.104 136.2 363.104 136.2 DL 373.104 136.2 368.104 136.2 DL 378.104 136.2
373.104 136.2 DL 383.104 136.2 378.104 136.2 DL 388.104 136.2 383.104 136.2 DL
393.104 136.2 388.104 136.2 DL 398.104 136.2 393.104 136.2 DL 403.104 136.2
398.104 136.2 DL 408.104 136.2 403.104 136.2 DL 413.104 136.2 408.104 136.2 DL
418.104 136.2 413.104 136.2 DL 423.104 136.2 418.104 136.2 DL 428.104 136.2
423.104 136.2 DL 433.104 136.2 428.104 136.2 DL 438.104 136.2 433.104 136.2 DL
443.104 136.2 438.104 136.2 DL 448.104 136.2 443.104 136.2 DL/F3 9
/Palatino-Italic@0 SF(libgai/ga_nsear)450.354 138.7 Q(ch.c)-.162 E/F4 8.15
/Courier@0 SF 4.89(6i)139.38 145.001 S(nt)154.05 145.001 Q 4.89(7g)139.38
155.001 S(a_nsearch\(const char *hostname, const struct addrinfo *hintsp,)
154.05 155.001 Q 58.68(8s)139.38 165.001 S(truct search *search\))207.84
165.001 Q 4.89(9{)139.38 175.001 S 19.56(10 int nsearch)134.49 185.001 R 4.89
(=0)4.89 G(;)261.63 185.001 Q 19.56(11 if)134.49 202.001 R
(\(hostname == NULL || hostname[0] == '\\0'\) {)4.89 E 39.12(12 if)134.49
212.001 R(\(hintsp->ai_flags & AI_PASSIVE\) {)4.89 E 78.24(13 /*)134.49 222.001
R(no hostname and AI_PASSIVE: implies wildcard bind */)4.89 E 58.68(14 switch)
134.49 232.001 R(\(hintsp->ai_family\) {)4.89 E 58.68(15 case)134.49 242.001 R
(AF_INET:)4.89 E 78.24(16 search[nsearch].host)134.49 252.001 R 4.89(=")4.89 G
(0.0.0.0";)344.76 252.001 Q 78.24(17 search[nsearch].family)134.49 262.001 R
4.89(=A)4.89 G(F_INET;)354.54 262.001 Q 78.24(18 nsearch++;)134.49 272.001 R
78.24(19 break;)134.49 282.001 R 58.68(20 case)134.49 292.001 R(AF_INET6:)4.89
E 78.24(21 search[nsearch].host)134.49 302.001 R 4.89(=")4.89 G(0::0";)344.76
302.001 Q 78.24(22 search[nsearch].family)134.49 312.001 R 4.89(=A)4.89 G
(F_INET6;)354.54 312.001 Q 78.24(23 nsearch++;)134.49 322.001 R 78.24
(24 break;)134.49 332.001 R 58.68(25 case)134.49 342.001 R(AF_UNSPEC:)4.89 E
78.24(26 search[nsearch].host)134.49 352.001 R 4.89(=")4.89 G 4.89(0::0"; /*)
344.76 352.001 R(IPv6 first, then IPv4 */)4.89 E 78.24
(27 search[nsearch].family)134.49 362.001 R 4.89(=A)4.89 G(F_INET6;)354.54
362.001 Q 78.24(28 nsearch++;)134.49 372.001 R 78.24(29 search[nsearch].host)
134.49 382.001 R 4.89(=")4.89 G(0.0.0.0";)344.76 382.001 Q 78.24
(30 search[nsearch].family)134.49 392.001 R 4.89(=A)4.89 G(F_INET;)354.54
392.001 Q 78.24(31 nsearch++;)134.49 402.001 R 78.24(32 break;)134.49 412.001 R
58.68(33 })134.49 422.001 R 134.6 426.802 129.6 426.802 DL 138.104 426.802
133.104 426.802 DL 143.104 426.802 138.104 426.802 DL 148.104 426.802 143.104
426.802 DL 153.104 426.802 148.104 426.802 DL 158.104 426.802 153.104 426.802
DL 163.104 426.802 158.104 426.802 DL 168.104 426.802 163.104 426.802 DL
173.104 426.802 168.104 426.802 DL 178.104 426.802 173.104 426.802 DL 183.104
426.802 178.104 426.802 DL 188.104 426.802 183.104 426.802 DL 193.104 426.802
188.104 426.802 DL 198.104 426.802 193.104 426.802 DL 203.104 426.802 198.104
426.802 DL 208.104 426.802 203.104 426.802 DL 213.104 426.802 208.104 426.802
DL 218.104 426.802 213.104 426.802 DL 223.104 426.802 218.104 426.802 DL
228.104 426.802 223.104 426.802 DL 233.104 426.802 228.104 426.802 DL 238.104
426.802 233.104 426.802 DL 243.104 426.802 238.104 426.802 DL 248.104 426.802
243.104 426.802 DL 253.104 426.802 248.104 426.802 DL 258.104 426.802 253.104
426.802 DL 263.104 426.802 258.104 426.802 DL 268.104 426.802 263.104 426.802
DL 273.104 426.802 268.104 426.802 DL 278.104 426.802 273.104 426.802 DL
283.104 426.802 278.104 426.802 DL 288.104 426.802 283.104 426.802 DL 293.104
426.802 288.104 426.802 DL 298.104 426.802 293.104 426.802 DL 303.104 426.802
298.104 426.802 DL 308.104 426.802 303.104 426.802 DL 313.104 426.802 308.104
426.802 DL 318.104 426.802 313.104 426.802 DL 323.104 426.802 318.104 426.802
DL 328.104 426.802 323.104 426.802 DL 333.104 426.802 328.104 426.802 DL
338.104 426.802 333.104 426.802 DL 343.104 426.802 338.104 426.802 DL 348.104
426.802 343.104 426.802 DL 353.104 426.802 348.104 426.802 DL 358.104 426.802
353.104 426.802 DL 363.104 426.802 358.104 426.802 DL 368.104 426.802 363.104
426.802 DL 373.104 426.802 368.104 426.802 DL 378.104 426.802 373.104 426.802
DL 383.104 426.802 378.104 426.802 DL 388.104 426.802 383.104 426.802 DL
393.104 426.802 388.104 426.802 DL 398.104 426.802 393.104 426.802 DL 403.104
426.802 398.104 426.802 DL 408.104 426.802 403.104 426.802 DL 413.104 426.802
408.104 426.802 DL 418.104 426.802 413.104 426.802 DL 423.104 426.802 418.104
426.802 DL 428.104 426.802 423.104 426.802 DL 433.104 426.802 428.104 426.802
DL 438.104 426.802 433.104 426.802 DL 443.104 426.802 438.104 426.802 DL
448.104 426.802 443.104 426.802 DL F3(libgai/ga_nsear)450.354 429.302 Q(ch.c)
-.162 E/F5 8/Palatino-Bold@0 SF(Figure 1)212.432 442.802 Q(1.21)-.296 E/F6 8
/Courier@0 SF(ga_nsearch)6 E/F7 8/Palatino-Roman@0 SF
(function: no hostname and passive.)2 E/F8 9/Helvetica-Bold@0 SF
(No hostname and passive soc)129.6 470.802 Q(ket)-.18 E/F9 7/Courier-Oblique@0
SF(11\21133)104.28 485.802 Q F2 2.095
(If the caller does not specify a hostname and speci\214es)147.6 485.802 R/F10
10/Courier@0 SF(AI_PASSIVE)4.595 E F2 4.595(,w)C 4.595(er)482.595 485.802 S
(eturn)495.75 485.802 Q .909(information to cr)129.6 497.802 R .909
(eate one or mor)-.18 F 3.409(ep)-.18 G .909
(assive sockets that will bind the wildcar)291.914 497.802 R 3.41(da)-.18 G
(ddr)487.84 497.802 Q(ess.)-.18 E(A)129.6 509.802 Q F10(switch)3.817 E F2 1.317
(is made based on the addr)3.817 F 1.316
(ess family: an IPv4 socket needs to bind 0.0.0.0)-.18 F(\()129.6 521.802 Q F10
(INADDR_ANY)A F2 1.564(\), and an IPv6 socket needs to bind 0)B -.101 .833
(::0 \().833 H F10(IN6ADDR_ANY_INIT)-.833 E F2 4.065(\). If)B(the)4.065 E .033
(family is)129.6 533.802 R F10(AF_UNSPEC)2.533 E F2 2.532(,w)C 2.532(em)237.728
533.802 S .032(ust r)253.88 533.802 R .032(eturn information to cr)-.18 F .032
(eate two sockets: the \214rst one for)-.18 F .264
(IPv6 and the second for IPv4.)129.6 545.802 R .265(The r)5.265 F .265
(eason for the or)-.18 F .265(dering of IPv6 \214rst, and then IPv4 is)-.18 F
.848(because an IPv6 socket on a dual-stack host can handle both IPv6 and IPv4\
 clients.)129.6 557.802 R(In)5.848 E 1.271(this scenario, if the caller cr)
129.6 569.802 R 1.271(eates only one socket fr)-.18 F 1.272(om the r)-.18 F
1.272(eturned list of)-.18 F F10(addrinfo)3.772 E F2(str)129.6 581.802 Q(uctur)
-.08 E(es, it should be the IPv6 socket.)-.18 E .963(This function cr)147.6
593.802 R .963(eates an array of)-.18 F F10(search)3.463 E F2(str)3.462 E
(uctur)-.08 E .962(es \(Figur)-.18 F 3.462(e1)-.18 G .962
(1.19\) with each entry)424.624 593.802 R .815
(specifying the hostname to look up and the addr)129.6 605.802 R .815
(ess family)-.18 F 5.815(.T)-1.11 G .815(he pointer to the caller)409.18
605.802 R('s).74 E .27(array of)129.6 617.802 R F10(search)2.77 E F2(str)2.77 E
(uctur)-.08 E .27(es is the last ar)-.18 F .27(gument to this function.)-.18 F
.27(The r)5.27 F .27(eturn value is the)-.18 F(number of these str)129.6
629.802 Q(uctur)-.08 E(es that ar)-.18 E 2.5(ec)-.18 G -.18(re)290.51 629.802 S
(ated, and this will always be one or two.).18 E/F11 7/Palatino-Roman@0 SF 1.75
<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 309 37
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(309)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF 1.015
(The next part of this function, shown in Figur)147.6 123 R 3.515(e1)-.18 G
1.016(1.22, handles the case of no host-)369.295 123 R 1.185(name and)129.6 135
R/F4 10/Courier@0 SF(AI_PASSIVE)3.685 E F3 1.185(not set.)3.685 F 1.185
(This implies that the caller wants to cr)6.185 F 1.185(eate an active)-.18 F
(socket to the local host.)129.6 147 Q .4 LW 134.6 160.2 129.6 160.2 DL 138.104
160.2 133.104 160.2 DL 143.104 160.2 138.104 160.2 DL 148.104 160.2 143.104
160.2 DL 153.104 160.2 148.104 160.2 DL 158.104 160.2 153.104 160.2 DL 163.104
160.2 158.104 160.2 DL 168.104 160.2 163.104 160.2 DL 173.104 160.2 168.104
160.2 DL 178.104 160.2 173.104 160.2 DL 183.104 160.2 178.104 160.2 DL 188.104
160.2 183.104 160.2 DL 193.104 160.2 188.104 160.2 DL 198.104 160.2 193.104
160.2 DL 203.104 160.2 198.104 160.2 DL 208.104 160.2 203.104 160.2 DL 213.104
160.2 208.104 160.2 DL 218.104 160.2 213.104 160.2 DL 223.104 160.2 218.104
160.2 DL 228.104 160.2 223.104 160.2 DL 233.104 160.2 228.104 160.2 DL 238.104
160.2 233.104 160.2 DL 243.104 160.2 238.104 160.2 DL 248.104 160.2 243.104
160.2 DL 253.104 160.2 248.104 160.2 DL 258.104 160.2 253.104 160.2 DL 263.104
160.2 258.104 160.2 DL 268.104 160.2 263.104 160.2 DL 273.104 160.2 268.104
160.2 DL 278.104 160.2 273.104 160.2 DL 283.104 160.2 278.104 160.2 DL 288.104
160.2 283.104 160.2 DL 293.104 160.2 288.104 160.2 DL 298.104 160.2 293.104
160.2 DL 303.104 160.2 298.104 160.2 DL 308.104 160.2 303.104 160.2 DL 313.104
160.2 308.104 160.2 DL 318.104 160.2 313.104 160.2 DL 323.104 160.2 318.104
160.2 DL 328.104 160.2 323.104 160.2 DL 333.104 160.2 328.104 160.2 DL 338.104
160.2 333.104 160.2 DL 343.104 160.2 338.104 160.2 DL 348.104 160.2 343.104
160.2 DL 353.104 160.2 348.104 160.2 DL 358.104 160.2 353.104 160.2 DL 363.104
160.2 358.104 160.2 DL 368.104 160.2 363.104 160.2 DL 373.104 160.2 368.104
160.2 DL 378.104 160.2 373.104 160.2 DL 383.104 160.2 378.104 160.2 DL 388.104
160.2 383.104 160.2 DL 393.104 160.2 388.104 160.2 DL 398.104 160.2 393.104
160.2 DL 403.104 160.2 398.104 160.2 DL 408.104 160.2 403.104 160.2 DL 413.104
160.2 408.104 160.2 DL 418.104 160.2 413.104 160.2 DL 423.104 160.2 418.104
160.2 DL 428.104 160.2 423.104 160.2 DL 433.104 160.2 428.104 160.2 DL 438.104
160.2 433.104 160.2 DL 443.104 160.2 438.104 160.2 DL 448.104 160.2 443.104
160.2 DL/F5 9/Palatino-Italic@0 SF(libgai/ga_nsear)450.354 162.7 Q(ch.c)-.162 E
/F6 8.15/Courier@0 SF 39.12(34 })134.49 169.001 R(else {)4.89 E 78.24(35 /*)
134.49 179.001 R(no host and not AI_PASSIVE: connect to local host */)4.89 E
58.68(36 switch)134.49 189.001 R(\(hintsp->ai_family\) {)4.89 E 58.68(37 case)
134.49 199.001 R(AF_INET:)4.89 E 78.24(38 search[nsearch].host)134.49 209.001 R
4.89(=")4.89 G 19.56(localhost"; /*)344.76 209.001 R(127.0.0.1 */)4.89 E 78.24
(39 search[nsearch].family)134.49 219.001 R 4.89(=A)4.89 G(F_INET;)354.54
219.001 Q 78.24(40 nsearch++;)134.49 229.001 R 78.24(41 break;)134.49 239.001 R
58.68(42 case)134.49 249.001 R(AF_INET6:)4.89 E 78.24(43 search[nsearch].host)
134.49 259.001 R 4.89(=")4.89 G(0::1";)344.76 259.001 Q 78.24
(44 search[nsearch].family)134.49 269.001 R 4.89(=A)4.89 G(F_INET6;)354.54
269.001 Q 78.24(45 nsearch++;)134.49 279.001 R 78.24(46 break;)134.49 289.001 R
58.68(47 case)134.49 299.001 R(AF_UNSPEC:)4.89 E 78.24(48 search[nsearch].host)
134.49 309.001 R 4.89(=")4.89 G 4.89(0::1"; /*)344.76 309.001 R
(IPv6 first, then IPv4 */)4.89 E 78.24(49 search[nsearch].family)134.49 319.001
R 4.89(=A)4.89 G(F_INET6;)354.54 319.001 Q 78.24(50 nsearch++;)134.49 329.001 R
78.24(51 search[nsearch].host)134.49 339.001 R 4.89(=")4.89 G(localhost";)
344.76 339.001 Q 78.24(52 search[nsearch].family)134.49 349.001 R 4.89(=A)4.89
G(F_INET;)354.54 349.001 Q 78.24(53 nsearch++;)134.49 359.001 R 78.24
(54 break;)134.49 369.001 R 58.68(55 })134.49 379.001 R 39.12(56 })134.49
389.001 R 134.6 393.802 129.6 393.802 DL 138.104 393.802 133.104 393.802 DL
143.104 393.802 138.104 393.802 DL 148.104 393.802 143.104 393.802 DL 153.104
393.802 148.104 393.802 DL 158.104 393.802 153.104 393.802 DL 163.104 393.802
158.104 393.802 DL 168.104 393.802 163.104 393.802 DL 173.104 393.802 168.104
393.802 DL 178.104 393.802 173.104 393.802 DL 183.104 393.802 178.104 393.802
DL 188.104 393.802 183.104 393.802 DL 193.104 393.802 188.104 393.802 DL
198.104 393.802 193.104 393.802 DL 203.104 393.802 198.104 393.802 DL 208.104
393.802 203.104 393.802 DL 213.104 393.802 208.104 393.802 DL 218.104 393.802
213.104 393.802 DL 223.104 393.802 218.104 393.802 DL 228.104 393.802 223.104
393.802 DL 233.104 393.802 228.104 393.802 DL 238.104 393.802 233.104 393.802
DL 243.104 393.802 238.104 393.802 DL 248.104 393.802 243.104 393.802 DL
253.104 393.802 248.104 393.802 DL 258.104 393.802 253.104 393.802 DL 263.104
393.802 258.104 393.802 DL 268.104 393.802 263.104 393.802 DL 273.104 393.802
268.104 393.802 DL 278.104 393.802 273.104 393.802 DL 283.104 393.802 278.104
393.802 DL 288.104 393.802 283.104 393.802 DL 293.104 393.802 288.104 393.802
DL 298.104 393.802 293.104 393.802 DL 303.104 393.802 298.104 393.802 DL
308.104 393.802 303.104 393.802 DL 313.104 393.802 308.104 393.802 DL 318.104
393.802 313.104 393.802 DL 323.104 393.802 318.104 393.802 DL 328.104 393.802
323.104 393.802 DL 333.104 393.802 328.104 393.802 DL 338.104 393.802 333.104
393.802 DL 343.104 393.802 338.104 393.802 DL 348.104 393.802 343.104 393.802
DL 353.104 393.802 348.104 393.802 DL 358.104 393.802 353.104 393.802 DL
363.104 393.802 358.104 393.802 DL 368.104 393.802 363.104 393.802 DL 373.104
393.802 368.104 393.802 DL 378.104 393.802 373.104 393.802 DL 383.104 393.802
378.104 393.802 DL 388.104 393.802 383.104 393.802 DL 393.104 393.802 388.104
393.802 DL 398.104 393.802 393.104 393.802 DL 403.104 393.802 398.104 393.802
DL 408.104 393.802 403.104 393.802 DL 413.104 393.802 408.104 393.802 DL
418.104 393.802 413.104 393.802 DL 423.104 393.802 418.104 393.802 DL 428.104
393.802 423.104 393.802 DL 433.104 393.802 428.104 393.802 DL 438.104 393.802
433.104 393.802 DL 443.104 393.802 438.104 393.802 DL 448.104 393.802 443.104
393.802 DL F5(libgai/ga_nsear)450.354 396.302 Q(ch.c)-.162 E/F7 8
/Palatino-Bold@0 SF(Figure 1)205.616 409.802 Q(1.22)-.296 E/F8 8/Courier@0 SF
(ga_nsearch)6 E/F9 8/Palatino-Roman@0 SF
(function: no hostname and not passive.)2 E/F10 7/Courier-Oblique@0 SF
(34\21156)104.28 433.802 Q F3 1.493(For IPv4 we assume the hostname)147.6
433.802 R F4(localhost)3.994 E F3 1.494(will r)3.994 F 1.494
(eturn the loopback addr)-.18 F(ess,)-.18 E 1.032(normally 127.0.0.1.)129.6
445.802 R(Ther)6.032 E 3.532(ei)-.18 G 3.532(sn)251.346 445.802 S 3.532(oc)
264.938 445.802 S 1.031(ommon hostname for the local host with IPv6, so we)
278.37 445.802 R -.18(re)129.6 457.802 S .739(turn the loopback addr).18 F .739
(ess of)-.18 F F4(0::1)3.239 E F3 5.739(.A)C 3.239(sw)310.724 457.802 S .739
(ith the passive case, if no addr)326.543 457.802 R .74(ess family is)-.18 F
(speci\214ed we r)129.6 469.802 Q(eturn two str)-.18 E(uctur)-.08 E
(es: \214rst one for IPv6 and then one for IPv4.)-.18 E(Figur)147.6 493.802 Q
2.828(e1)-.18 G .328(1.23 shows the \214nal part of this function, the)183.498
493.802 R F4(else)2.827 E F3 .327(clause of the original)2.827 F F4(if)2.827 E
F3 2.5(statement. This)129.6 505.802 R
(code is executed when a hostname is speci\214ed.)2.5 E F10(57\21182)104.28
517.802 Q F3(The)147.6 517.802 Q F4(AI_PASSIVE)3.726 E F3 1.226
(\215ag does not matter in this scenario; the hostname needs to be)3.726 F .335
(looked up.)129.6 529.802 R .335(If the caller cr)5.335 F .335
(eates a passive socket, then the r)-.18 F .335(esulting socket addr)-.18 F
.335(ess str)-.18 F(uc-)-.08 E(tur)129.6 541.802 Q 3.412(ew)-.18 G .912
(ill be used in a call to)159.202 541.802 R F4(bind)3.412 E F3 3.412(,b)C .912
(ut if the caller cr)296.458 541.802 R .913(eates an active socket, the socket)
-.18 F(addr)129.6 553.802 Q 1.788(ess str)-.18 F(uctur)-.08 E 4.288(ew)-.18 G
1.788(ill be used in a call to)220.466 553.802 R F4(connect)4.288 E F3 6.788
(.W)C 4.288(ec)388.78 553.802 S -.18(re)402.298 553.802 S 1.788(ate one or two)
.18 F F4(search)4.288 E F3(str)129.6 565.802 Q(uctur)-.08 E .832
(es: one if the addr)-.18 F .833
(ess family is speci\214ed and two if it is not speci\214ed.)-.18 F .833
(As with)5.833 F 1.029(the pr)129.6 577.802 R 1.029
(evious two scenarios, if two str)-.18 F(uctur)-.08 E 1.029(es ar)-.18 F 3.529
(er)-.18 G 1.028(eturned, the \214rst is for IPv6 and the)355.532 577.802 R
(second for IPv4.)129.6 589.802 Q 2.628 -.92(We n)147.6 616.202 T .788(ow r).92
F .788(eturn to our)-.18 F F4(getaddrinfo)3.288 E F3 .788(function, in Figur)
3.288 F 3.289(e1)-.18 G .789(1.24, which starts with a)409.834 616.202 R
(call to)129.6 628.202 Q F4(ga_nsearch)2.5 E F3(.)A/F11 7/Palatino-Roman@0 SF
1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 310 38
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(310)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 138.104 124.2 133.104 124.2 DL 143.104 124.2
138.104 124.2 DL 148.104 124.2 143.104 124.2 DL 153.104 124.2 148.104 124.2 DL
158.104 124.2 153.104 124.2 DL 163.104 124.2 158.104 124.2 DL 168.104 124.2
163.104 124.2 DL 173.104 124.2 168.104 124.2 DL 178.104 124.2 173.104 124.2 DL
183.104 124.2 178.104 124.2 DL 188.104 124.2 183.104 124.2 DL 193.104 124.2
188.104 124.2 DL 198.104 124.2 193.104 124.2 DL 203.104 124.2 198.104 124.2 DL
208.104 124.2 203.104 124.2 DL 213.104 124.2 208.104 124.2 DL 218.104 124.2
213.104 124.2 DL 223.104 124.2 218.104 124.2 DL 228.104 124.2 223.104 124.2 DL
233.104 124.2 228.104 124.2 DL 238.104 124.2 233.104 124.2 DL 243.104 124.2
238.104 124.2 DL 248.104 124.2 243.104 124.2 DL 253.104 124.2 248.104 124.2 DL
258.104 124.2 253.104 124.2 DL 263.104 124.2 258.104 124.2 DL 268.104 124.2
263.104 124.2 DL 273.104 124.2 268.104 124.2 DL 278.104 124.2 273.104 124.2 DL
283.104 124.2 278.104 124.2 DL 288.104 124.2 283.104 124.2 DL 293.104 124.2
288.104 124.2 DL 298.104 124.2 293.104 124.2 DL 303.104 124.2 298.104 124.2 DL
308.104 124.2 303.104 124.2 DL 313.104 124.2 308.104 124.2 DL 318.104 124.2
313.104 124.2 DL 323.104 124.2 318.104 124.2 DL 328.104 124.2 323.104 124.2 DL
333.104 124.2 328.104 124.2 DL 338.104 124.2 333.104 124.2 DL 343.104 124.2
338.104 124.2 DL 348.104 124.2 343.104 124.2 DL 353.104 124.2 348.104 124.2 DL
358.104 124.2 353.104 124.2 DL 363.104 124.2 358.104 124.2 DL 368.104 124.2
363.104 124.2 DL 373.104 124.2 368.104 124.2 DL 378.104 124.2 373.104 124.2 DL
383.104 124.2 378.104 124.2 DL 388.104 124.2 383.104 124.2 DL 393.104 124.2
388.104 124.2 DL 398.104 124.2 393.104 124.2 DL 403.104 124.2 398.104 124.2 DL
408.104 124.2 403.104 124.2 DL 413.104 124.2 408.104 124.2 DL 418.104 124.2
413.104 124.2 DL 423.104 124.2 418.104 124.2 DL 428.104 124.2 423.104 124.2 DL
433.104 124.2 428.104 124.2 DL 438.104 124.2 433.104 124.2 DL 443.104 124.2
438.104 124.2 DL 448.104 124.2 443.104 124.2 DL/F2 9/Palatino-Italic@0 SF
(libgai/ga_nsear)450.354 126.7 Q(ch.c)-.162 E/F3 8.15/Courier@0 SF 19.56(57 })
134.49 133.001 R(else {)4.89 E(/* host is specified */)305.64 133.001 Q 39.12
(58 switch)134.49 143.001 R(\(hintsp->ai_family\) {)4.89 E 39.12(59 case)134.49
153.001 R(AF_INET:)4.89 E 58.68(60 search[nsearch].host)134.49 163.001 R 4.89
(=h)4.89 G(ostname;)325.2 163.001 Q 58.68(61 search[nsearch].family)134.49
173.001 R 4.89(=A)4.89 G(F_INET;)334.98 173.001 Q 58.68(62 nsearch++;)134.49
183.001 R 58.68(63 break;)134.49 193.001 R 39.12(64 case)134.49 203.001 R
(AF_INET6:)4.89 E 58.68(65 search[nsearch].host)134.49 213.001 R 4.89(=h)4.89 G
(ostname;)325.2 213.001 Q 58.68(66 search[nsearch].family)134.49 223.001 R 4.89
(=A)4.89 G(F_INET6;)334.98 223.001 Q 58.68(67 nsearch++;)134.49 233.001 R 58.68
(68 break;)134.49 243.001 R 39.12(69 case)134.49 253.001 R(AF_UNSPEC:)4.89 E
58.68(70 search[nsearch].host)134.49 263.001 R 4.89(=h)4.89 G(ostname;)325.2
263.001 Q 58.68(71 search[nsearch].family)134.49 273.001 R 4.89(=A)4.89 G 4.89
(F_INET6; /*)334.98 273.001 R(IPv6 first */)4.89 E 58.68(72 nsearch++;)134.49
283.001 R 58.68(73 search[nsearch].host)134.49 293.001 R 4.89(=h)4.89 G
(ostname;)325.2 293.001 Q 58.68(74 search[nsearch].family)134.49 303.001 R 4.89
(=A)4.89 G 9.78(F_INET; /*)334.98 303.001 R(then IPv4 */)4.89 E 58.68
(75 nsearch++;)134.49 313.001 R 58.68(76 break;)134.49 323.001 R 39.12(77 })
134.49 333.001 R 19.56(78 })134.49 343.001 R 19.56(79 if)134.49 353.001 R
(\(nsearch < 1 || nsearch > 2\))4.89 E 39.12(80 err_quit\("nsearch)134.49
363.001 R 4.89(=%)4.89 G(d", nsearch\);)290.97 363.001 Q 19.56(81 return)134.49
373.001 R(\(nsearch\);)4.89 E(82 })134.49 383.001 Q 134.6 387.802 129.6 387.802
DL 138.104 387.802 133.104 387.802 DL 143.104 387.802 138.104 387.802 DL
148.104 387.802 143.104 387.802 DL 153.104 387.802 148.104 387.802 DL 158.104
387.802 153.104 387.802 DL 163.104 387.802 158.104 387.802 DL 168.104 387.802
163.104 387.802 DL 173.104 387.802 168.104 387.802 DL 178.104 387.802 173.104
387.802 DL 183.104 387.802 178.104 387.802 DL 188.104 387.802 183.104 387.802
DL 193.104 387.802 188.104 387.802 DL 198.104 387.802 193.104 387.802 DL
203.104 387.802 198.104 387.802 DL 208.104 387.802 203.104 387.802 DL 213.104
387.802 208.104 387.802 DL 218.104 387.802 213.104 387.802 DL 223.104 387.802
218.104 387.802 DL 228.104 387.802 223.104 387.802 DL 233.104 387.802 228.104
387.802 DL 238.104 387.802 233.104 387.802 DL 243.104 387.802 238.104 387.802
DL 248.104 387.802 243.104 387.802 DL 253.104 387.802 248.104 387.802 DL
258.104 387.802 253.104 387.802 DL 263.104 387.802 258.104 387.802 DL 268.104
387.802 263.104 387.802 DL 273.104 387.802 268.104 387.802 DL 278.104 387.802
273.104 387.802 DL 283.104 387.802 278.104 387.802 DL 288.104 387.802 283.104
387.802 DL 293.104 387.802 288.104 387.802 DL 298.104 387.802 293.104 387.802
DL 303.104 387.802 298.104 387.802 DL 308.104 387.802 303.104 387.802 DL
313.104 387.802 308.104 387.802 DL 318.104 387.802 313.104 387.802 DL 323.104
387.802 318.104 387.802 DL 328.104 387.802 323.104 387.802 DL 333.104 387.802
328.104 387.802 DL 338.104 387.802 333.104 387.802 DL 343.104 387.802 338.104
387.802 DL 348.104 387.802 343.104 387.802 DL 353.104 387.802 348.104 387.802
DL 358.104 387.802 353.104 387.802 DL 363.104 387.802 358.104 387.802 DL
368.104 387.802 363.104 387.802 DL 373.104 387.802 368.104 387.802 DL 378.104
387.802 373.104 387.802 DL 383.104 387.802 378.104 387.802 DL 388.104 387.802
383.104 387.802 DL 393.104 387.802 388.104 387.802 DL 398.104 387.802 393.104
387.802 DL 403.104 387.802 398.104 387.802 DL 408.104 387.802 403.104 387.802
DL 413.104 387.802 408.104 387.802 DL 418.104 387.802 413.104 387.802 DL
423.104 387.802 418.104 387.802 DL 428.104 387.802 423.104 387.802 DL 433.104
387.802 428.104 387.802 DL 438.104 387.802 433.104 387.802 DL 443.104 387.802
438.104 387.802 DL 448.104 387.802 443.104 387.802 DL F2(libgai/ga_nsear)
450.354 390.302 Q(ch.c)-.162 E/F4 8/Palatino-Bold@0 SF(Figure 1)223.116 403.802
Q(1.23)-.296 E/F5 8/Courier@0 SF(ga_nsearch)6 E/F6 8/Palatino-Roman@0 SF
(function: hostname speci\214ed.)2 E/F7 9/Helvetica-Bold@0 SF(Call)129.6
446.202 Q/F8 9/Courier-Bold@0 SF(ga_nsearch)2.502 E/F9 7/Courier-Oblique@0 SF
(36)104.28 461.202 Q/F10 10/Palatino-Roman@0 SF 3.005 -.92(We c)147.6 461.202 T
1.165(all our).92 F/F11 10/Courier@0 SF(ga_nsearch)3.664 E F10 1.164
(function, \214lling in our)3.664 F F11(search)3.664 E F10(array)3.664 E 3.664
(,a)-1.11 G 1.164(nd r)444.562 461.202 R 1.164(eturning the)-.18 F
(number of str)129.6 473.202 Q(uctur)-.08 E(es in the array: one or two.)-.18 E
F7(Loop thr)129.6 489.202 Q(ough all the)-.18 E F8(search)2.502 E F7
(structures)2.502 E F9(37)104.28 504.202 Q F10 1.84 -.92(We l)147.6 504.202 T
(oop thr).92 E(ough each)-.18 E F11(search)2.5 E F10(str)2.5 E(uctur)-.08 E 2.5
(et)-.18 G(hat was cr)331.03 504.202 Q(eated by)-.18 E F11(ga_nsearch)2.5 E F10
(.)A F7(Chec)129.6 520.202 Q 2.502(kf)-.18 G(or IPv4 dotted-decimal string)
161.748 520.202 Q F9(39\21144)104.28 535.202 Q F10 1.07(If the \214rst charact\
er of the hostname is a digit, we check whether or not the host-)147.6 535.202
R .038(name is r)129.6 547.202 R .038(eally a dotted-decimal string.)-.18 F
1.878 -.92(We c)5.038 H(all).92 E F11(inet_pton)2.538 E F10 .038
(to do this check and conver)2.538 F(-)-.18 E 2.652(sion. If)129.6 559.202 R
.152(it succeeds but the caller speci\214es an addr)2.652 F .152
(ess family other than)-.18 F F11(AF_INET)2.652 E F10 2.652(,t)C .152(his is)
496.828 559.202 R(an err)129.6 571.202 Q(or)-.18 E(.)-.74 E F9(45\21146)104.28
583.202 Q F10 1.848 -.92(We c)147.6 583.202 T .008(heck that the).92 F F11
(family)2.508 E F10 .008(of the)2.508 F F11(search)2.508 E F10(str)2.508 E
(uctur)-.08 E 2.508(ei)-.18 G 2.508(sa)377.562 583.202 S(lso)389.31 583.202 Q
F11(AF_INET)2.508 E F10 2.508(,b)C .007(ut a mismatch)456.966 583.202 R(her)
129.6 595.202 Q 4.023(eo)-.18 G 1.523(nly causes this)158.253 595.202 R F11
(search)4.023 E F10(str)4.023 E(uctur)-.08 E 4.023(et)-.18 G 4.023(ob)316.578
595.202 S 4.023(ei)331.591 595.202 S(gnor)343.314 595.202 Q 4.023(ed. This)-.18
F 1.523(scenario can happen, for)4.023 F 4.469
(example, if the caller speci\214es a hostname of 192.3.4.5 but no addr)129.6
607.202 R 4.469(ess family)-.18 F(.)-1.11 E F11(ga_nsearch)129.6 619.202 Q F10
(cr)3.562 E 1.062(eates two)-.18 F F11(search)3.562 E F10(str)3.562 E(uctur)
-.08 E 1.062(es: one for IPv6 and one for IPv4.)-.18 F 1.063(The \214rst)6.063
F .154(time thr)129.6 631.202 R .154(ough the)-.18 F F11(for)2.654 E F10 .153
(loop the call to)2.654 F F11(inet_pton)2.653 E F10 .153
(succeeds, but since the)2.653 F F11(family)2.653 E F10 .153(of the)2.653 F F11
(search)129.6 643.202 Q F10(str)3.493 E(uctur)-.08 E 3.493(ei)-.18 G(s)215.186
643.202 Q F11(AF_INET6)3.493 E F10 3.493(,w)C 3.493(ew)285.252 643.202 S .993
(ant to ignor)301.875 643.202 R 3.493(et)-.18 G .993(his str)366.724 643.202 R
(uctur)-.08 E .993(e, and not generate an)-.18 F(err)129.6 655.202 Q(or)-.18 E
(.)-.74 E/F12 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 311 39
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 74.253(1.16 Implementation)-.495
F(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5
E F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(31)506.433 82 Q(1)-.333 E .32 LW
97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6
89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2
115.6 89.2 DL 123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2
127.6 89.2 DL 135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2
139.6 89.2 DL 147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2
151.6 89.2 DL 159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2
163.6 89.2 DL 171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2
175.6 89.2 DL 183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2
187.6 89.2 DL 195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2
199.6 89.2 DL 207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2
211.6 89.2 DL 219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2
223.6 89.2 DL 231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2
235.6 89.2 DL 243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2
247.6 89.2 DL 255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2
259.6 89.2 DL 267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2
271.6 89.2 DL 279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2
283.6 89.2 DL 291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2
295.6 89.2 DL 303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2
307.6 89.2 DL 315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2
319.6 89.2 DL 327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2
331.6 89.2 DL 339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2
343.6 89.2 DL 351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2
355.6 89.2 DL 363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2
367.6 89.2 DL 375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2
379.6 89.2 DL 387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2
391.6 89.2 DL 399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2
403.6 89.2 DL 411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2
415.6 89.2 DL 423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2
427.6 89.2 DL 435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2
439.6 89.2 DL 447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2
451.6 89.2 DL 459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2
463.6 89.2 DL 471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2
475.6 89.2 DL 483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2
487.6 89.2 DL 495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2
499.6 89.2 DL 507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2
511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4 LW 134.6 124.2 129.6 124.2 DL 137.105
124.2 132.105 124.2 DL 142.105 124.2 137.105 124.2 DL 147.105 124.2 142.105
124.2 DL 152.105 124.2 147.105 124.2 DL 157.105 124.2 152.105 124.2 DL 162.105
124.2 157.105 124.2 DL 167.105 124.2 162.105 124.2 DL 172.105 124.2 167.105
124.2 DL 177.105 124.2 172.105 124.2 DL 182.105 124.2 177.105 124.2 DL 187.105
124.2 182.105 124.2 DL 192.105 124.2 187.105 124.2 DL 197.105 124.2 192.105
124.2 DL 202.105 124.2 197.105 124.2 DL 207.105 124.2 202.105 124.2 DL 212.105
124.2 207.105 124.2 DL 217.105 124.2 212.105 124.2 DL 222.105 124.2 217.105
124.2 DL 227.105 124.2 222.105 124.2 DL 232.105 124.2 227.105 124.2 DL 237.105
124.2 232.105 124.2 DL 242.105 124.2 237.105 124.2 DL 247.105 124.2 242.105
124.2 DL 252.105 124.2 247.105 124.2 DL 257.105 124.2 252.105 124.2 DL 262.105
124.2 257.105 124.2 DL 267.105 124.2 262.105 124.2 DL 272.105 124.2 267.105
124.2 DL 277.105 124.2 272.105 124.2 DL 282.105 124.2 277.105 124.2 DL 287.105
124.2 282.105 124.2 DL 292.105 124.2 287.105 124.2 DL 297.105 124.2 292.105
124.2 DL 302.105 124.2 297.105 124.2 DL 307.105 124.2 302.105 124.2 DL 312.105
124.2 307.105 124.2 DL 317.105 124.2 312.105 124.2 DL 322.105 124.2 317.105
124.2 DL 327.105 124.2 322.105 124.2 DL 332.105 124.2 327.105 124.2 DL 337.105
124.2 332.105 124.2 DL 342.105 124.2 337.105 124.2 DL 347.105 124.2 342.105
124.2 DL 352.105 124.2 347.105 124.2 DL 357.105 124.2 352.105 124.2 DL 362.105
124.2 357.105 124.2 DL 367.105 124.2 362.105 124.2 DL 372.105 124.2 367.105
124.2 DL 377.105 124.2 372.105 124.2 DL 382.105 124.2 377.105 124.2 DL 387.105
124.2 382.105 124.2 DL 392.105 124.2 387.105 124.2 DL 397.105 124.2 392.105
124.2 DL 402.105 124.2 397.105 124.2 DL 407.105 124.2 402.105 124.2 DL 412.105
124.2 407.105 124.2 DL 417.105 124.2 412.105 124.2 DL 422.105 124.2 417.105
124.2 DL 427.105 124.2 422.105 124.2 DL 432.105 124.2 427.105 124.2 DL 437.105
124.2 432.105 124.2 DL 442.105 124.2 437.105 124.2 DL 447.105 124.2 442.105
124.2 DL/F3 9/Palatino-Italic@0 SF(libgai/getaddrinfo.c)449.355 126.7 Q/F4 8.15
/Courier@0 SF 39.12(35 /*)134.49 133.001 R
(remainder of function for IPv4/IPv6 */)4.89 E 19.56(36 nsearch)134.49 143.001
R 4.89(=g)4.89 G(a_nsearch\(hostname, &hints, &search[0]\);)222.51 143.001 Q
19.56(37 for)134.49 153.001 R
(\(sptr = &search[0]; sptr < &search[nsearch]; sptr++\) {)4.89 E 58.68(38 /*)
134.49 163.001 R(check for an IPv4 dotted-decimal string */)4.89 E 39.12(39 if)
134.49 173.001 R(\(isdigit\(sptr->host[0]\)\) {)4.89 E 58.68(40 struct)134.49
183.001 R(in_addr inaddr;)4.89 E 58.68(41 if)134.49 200.001 R
(\(inet_pton\(AF_INET, sptr->host, &inaddr\) == 1\) {)4.89 E 78.24(42 if)134.49
210.001 R(\(hints.ai_family != AF_UNSPEC &&)4.89 E 97.8(43 hints.ai_family)
134.49 220.001 R(!= AF_INET\))4.89 E 97.8(44 error\(EAI_ADDRFAMILY\);)134.49
230.001 R 78.24(45 if)134.49 240.001 R(\(sptr->family != AF_INET\))4.89 E 97.8
(46 continue;)134.49 250.001 R(/* ignore */)305.64 250.001 Q 78.24(47 rc)134.49
260.001 R 4.89(=g)4.89 G(a_aistruct\(&aipnext, &hints, &inaddr, AF_INET\);)
256.74 260.001 Q 78.24(48 if)134.49 270.001 R(\(rc != 0\))4.89 E 97.8
(49 error\(rc\);)134.49 280.001 R 78.24(50 continue;)134.49 290.001 R 58.68
(51 })134.49 300.001 R 39.12(52 })134.49 310.001 R 58.68(53 /*)134.49 320.001 R
(check for an IPv6 hex string */)4.89 E 39.12(54 if)134.49 330.001 R
(\(\(isxdigit\(sptr->host[0]\) || sptr->host[0] == ':'\) &&)4.89 E 58.68
(55 \(strchr\(sptr->host,)134.49 340.001 R(':'\) != NULL\)\) {)4.89 E 58.68
(56 struct)134.49 350.001 R(in6_addr in6addr;)4.89 E 58.68(57 if)134.49 367.001
R(\(inet_pton\(AF_INET6, sptr->host, &in6addr\) == 1\) {)4.89 E 78.24(58 if)
134.49 377.001 R(\(hints.ai_family != AF_UNSPEC &&)4.89 E 97.8
(59 hints.ai_family)134.49 387.001 R(!= AF_INET6\))4.89 E 97.8
(60 error\(EAI_ADDRFAMILY\);)134.49 397.001 R 78.24(61 if)134.49 407.001 R
(\(sptr->family != AF_INET6\))4.89 E 97.8(62 continue;)134.49 417.001 R
(/* ignore */)305.64 417.001 Q 78.24(63 rc)134.49 427.001 R 4.89(=g)4.89 G
(a_aistruct\(&aipnext, &hints, &in6addr, AF_INET6\);)256.74 427.001 Q 78.24
(64 if)134.49 437.001 R(\(rc != 0\))4.89 E 97.8(65 error\(rc\);)134.49 447.001
R 78.24(66 continue;)134.49 457.001 R 58.68(67 })134.49 467.001 R 39.12(68 })
134.49 477.001 R 134.6 481.802 129.6 481.802 DL 137.105 481.802 132.105 481.802
DL 142.105 481.802 137.105 481.802 DL 147.105 481.802 142.105 481.802 DL
152.105 481.802 147.105 481.802 DL 157.105 481.802 152.105 481.802 DL 162.105
481.802 157.105 481.802 DL 167.105 481.802 162.105 481.802 DL 172.105 481.802
167.105 481.802 DL 177.105 481.802 172.105 481.802 DL 182.105 481.802 177.105
481.802 DL 187.105 481.802 182.105 481.802 DL 192.105 481.802 187.105 481.802
DL 197.105 481.802 192.105 481.802 DL 202.105 481.802 197.105 481.802 DL
207.105 481.802 202.105 481.802 DL 212.105 481.802 207.105 481.802 DL 217.105
481.802 212.105 481.802 DL 222.105 481.802 217.105 481.802 DL 227.105 481.802
222.105 481.802 DL 232.105 481.802 227.105 481.802 DL 237.105 481.802 232.105
481.802 DL 242.105 481.802 237.105 481.802 DL 247.105 481.802 242.105 481.802
DL 252.105 481.802 247.105 481.802 DL 257.105 481.802 252.105 481.802 DL
262.105 481.802 257.105 481.802 DL 267.105 481.802 262.105 481.802 DL 272.105
481.802 267.105 481.802 DL 277.105 481.802 272.105 481.802 DL 282.105 481.802
277.105 481.802 DL 287.105 481.802 282.105 481.802 DL 292.105 481.802 287.105
481.802 DL 297.105 481.802 292.105 481.802 DL 302.105 481.802 297.105 481.802
DL 307.105 481.802 302.105 481.802 DL 312.105 481.802 307.105 481.802 DL
317.105 481.802 312.105 481.802 DL 322.105 481.802 317.105 481.802 DL 327.105
481.802 322.105 481.802 DL 332.105 481.802 327.105 481.802 DL 337.105 481.802
332.105 481.802 DL 342.105 481.802 337.105 481.802 DL 347.105 481.802 342.105
481.802 DL 352.105 481.802 347.105 481.802 DL 357.105 481.802 352.105 481.802
DL 362.105 481.802 357.105 481.802 DL 367.105 481.802 362.105 481.802 DL
372.105 481.802 367.105 481.802 DL 377.105 481.802 372.105 481.802 DL 382.105
481.802 377.105 481.802 DL 387.105 481.802 382.105 481.802 DL 392.105 481.802
387.105 481.802 DL 397.105 481.802 392.105 481.802 DL 402.105 481.802 397.105
481.802 DL 407.105 481.802 402.105 481.802 DL 412.105 481.802 407.105 481.802
DL 417.105 481.802 412.105 481.802 DL 422.105 481.802 417.105 481.802 DL
427.105 481.802 422.105 481.802 DL 432.105 481.802 427.105 481.802 DL 437.105
481.802 432.105 481.802 DL 442.105 481.802 437.105 481.802 DL 447.105 481.802
442.105 481.802 DL F3(libgai/getaddrinfo.c)449.355 484.302 Q/F5 8
/Palatino-Bold@0 SF(Figure 1)189.812 497.802 Q(1.24)-.296 E/F6 8/Courier@0 SF
(getaddrinfo)6 E/F7 8/Palatino-Roman@0 SF
(function: check for IPv4 or IPv6 addr)2 E(ess string.)-.144 E/F8 9
/Helvetica-Bold@0 SF(Create)129.6 536.202 Q/F9 9/Courier-Bold@0 SF(addrinfo)
2.502 E F8(structure)2.502 E/F10 7/Courier-Oblique@0 SF(47\21152)104.28 551.202
Q/F11 10/Palatino-Roman@0 SF 2.513(Our function)147.6 551.202 R/F12 10
/Courier@0 SF(ga_aistruct)5.013 E F11(cr)5.013 E 2.513(eates an)-.18 F F12
(addrinfo)5.013 E F11(str)5.013 E(uctur)-.08 E 5.013(ea)-.18 G 2.512
(nd adds it to the)437.401 551.202 R(linked list that is being built \(the)
129.6 563.202 Q F12(aipnext)2.5 E F11(pointer\).)2.5 E F8(Chec)129.6 579.202 Q
2.502(kf)-.18 G(or IPv6 ad)161.748 579.202 Q(dress string)-.09 E F10(53\21160)
104.28 594.202 Q F11 .245(If the \214rst character of the hostname is either a\
 hexadecimal digit or a colon and the)147.6 594.202 R 1.397
(string contains a colon, we check whether the hostname is an IPv6 addr)129.6
606.202 R 1.397(ess string by)-.18 F(calling)129.6 618.202 Q F12(inet_pton)
3.272 E F11 5.772(.I)C 3.272(fi)228.064 618.202 S 3.272(ts)237.576 618.202 S
.772(ucceeds but the caller speci\214es an addr)248.348 618.202 R .773
(ess family other than)-.18 F F12(AF_INET6)129.6 630.202 Q F11 2.5(,t)C
(his is an err)185.86 630.202 Q(or)-.18 E(.)-.74 E F10(61\21162)104.28 642.202
Q F11 3.135 -.92(We c)147.6 642.202 T 1.295(heck that the).92 F F12(family)
3.795 E F11 1.295(of the)3.795 F F12(search)3.795 E F11(str)3.795 E(uctur)-.08
E 3.795(ei)-.18 G 3.795(sa)389.145 642.202 S(lso)402.18 642.202 Q F12(AF_INET6)
3.795 E F11 3.795(,b)C 1.295(ut a mis-)478.41 642.202 R(match her)129.6 654.202
Q 2.5(eo)-.18 G(nly causes this)186.58 654.202 Q F12(search)2.5 E F11(str)2.5 E
(uctur)-.08 E 2.5(et)-.18 G 2.5(ob)337.29 654.202 S 2.5(ei)350.78 654.202 S
(gnor)360.98 654.202 Q(ed.)-.18 E/F13 7/Palatino-Roman@0 SF 1.75<a943>233.453
678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 312 40
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(312)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2 9
/Helvetica-Bold@0 SF(Create)129.6 123 Q/F3 9/Courier-Bold@0 SF(addrinfo)2.502 E
F2(structure)2.502 E/F4 7/Courier-Oblique@0 SF(63\21168)104.28 138 Q/F5 10
/Palatino-Roman@0 SF 2.512(Our function)147.6 138 R/F6 10/Courier@0 SF
(ga_aistruct)5.012 E F5(cr)5.012 E 2.513(eates an)-.18 F F6(addrinfo)5.013 E F5
(str)5.013 E(uctur)-.08 E 5.013(ea)-.18 G 2.513(nd adds it to the)437.398 138 R
(linked list that is being built.)129.6 150 Q .175
(The \214rst two tests in the loop \(Figur)147.6 171.6 R 2.675(e1)-.18 G .175
(1.24\) handle an IPv4 dotted-decimal string or)318.93 171.6 R .526
(an IPv6 addr)129.6 183.6 R .526(ess string.)-.18 F .526(The r)5.526 F .526
(emainder of the loop, shown in Figur)-.18 F 3.026(e1)-.18 G .526
(1.25, looks up the)440.982 183.6 R(hostname by calling either)129.6 195.6 Q F6
(gethostbyname)2.5 E F5(or)2.5 E F6(gethostbyname2)2.5 E F5(.)A F2 -2.412
(Initializ e)129.6 211.6 R(resolver \214r)2.502 E(st time)-.135 E F4(70\21171)
104.28 226.6 Q F5 1.84 -.92(We c)147.6 226.6 T(all the r).92 E -1.76
(esolver 's)-.18 F F6(res_init)2.5 E F5
(function if it has not been called befor)2.5 E(e.)-.18 E F2(Call)129.6 242.6 Q
F3(gethostbyname2)2.502 E F2(if tw)2.502 E 2.502(os)-.18 G(ear)257.535 242.6 Q
-.09(ch)-.18 G(es are being perf).09 E(ormed)-.18 E F4(72\21174)104.28 257.6 Q
F5(If)147.6 257.6 Q F6(nsearch)3.316 E F5 .816(is 2, then we ar)3.316 F 3.316
(eg)-.18 G .816(oing thr)286.102 257.6 R .816(ough the)-.18 F F6(for)3.316 E F5
.815(loop twice: once for IPv6 and)3.315 F .828(again for IPv4.)129.6 269.6 R
.828(If the hostname ar)5.828 F .828(gument has an addr)-.18 F .828
(ess in only one of the two fami-)-.18 F .172(lies, we want to r)129.6 281.6 R
.171(eturn only that addr)-.18 F 2.671(ess. For)-.18 F .171(example, our host)
2.671 F F6(solaris)2.671 E F5 .171(in Section 9.2)2.671 F 1.303(has a AAAA r)
129.6 293.6 R(ecor)-.18 E 3.803(da)-.18 G 1.303(nd an A r)229.331 293.6 R(ecor)
-.18 E 3.803(di)-.18 G 3.803(nt)306.323 293.6 S 1.303(he DNS.)319.206 293.6 R
1.303(The \214rst time ar)6.303 F 1.303(ound the loop we)-.18 F .618
(want to \214nd the AAAA r)129.6 305.6 R(ecor)-.18 E .617
(d, and the second time the A r)-.18 F(ecor)-.18 E 3.117(d. But)-.18 F .617
(if the hostname)3.117 F 1.001(has only an A r)129.6 317.6 R(ecor)-.18 E 1.001
(d, we do not want to pr)-.18 F 1.001(ocess that r)-.18 F(ecor)-.18 E 3.501(dt)
-.18 G 1.002(he \214rst time ar)411.633 317.6 R 1.002(ound the)-.18 F .008
(loop when the)129.6 329.6 R F6(family)2.508 E F5 .008(member of the)2.508 F F6
(search)2.508 E F5(str)2.508 E(uctur)-.08 E 2.508(ei)-.18 G(s)384.632 329.6 Q
F6(AF_INET6)2.508 E F5 5.008(.T)C .007(hat is, since we)453.018 329.6 R .369
(know that we will be sear)129.6 341.6 R .369(ching for an A r)-.18 F(ecor)-.18
E 2.869(df)-.18 G .37(or this host, do not sear)346.69 341.6 R .37
(ch for a AAAA)-.18 F -.18(re)129.6 353.6 S(cor).18 E 3.236(du)-.18 G(sing)
167.206 353.6 Q F6(gethostbyname)3.236 E F5 .736(and possibly r)3.236 F .736
(eturn the IPv4-mapped IPv6 addr)-.18 F .736(ess cor)-.18 F(-)-.18 E -.18(re)
129.6 365.6 S .446(sponding to the A r).18 F(ecor)-.18 E 2.946(d. Looking)-.18
F .446(at Figur)2.946 F 2.946(e9)-.18 G .446(.5 the way to sear)346.128 365.6 R
.447(ch for only A r)-.18 F(ecor)-.18 E(ds)-.18 E .796(when the family is)129.6
377.6 R F6(AF_INET)3.296 E F5 .796(and to sear)3.296 F .796(ch for only AAAA r)
-.18 F(ecor)-.18 E .796(ds when the family is)-.18 F F6(AF_INET6)129.6 389.6 Q
F5 5.416(is to call)7.916 F F6(gethostbyname2)7.917 E F5 5.417(instead of)7.917
F F6(gethostbyname)7.917 E F5 7.917(,w)C 5.417(ith the)485.823 389.6 R F6
(RES_USE_INET6)129.6 401.6 Q F5(option of)2.5 E(f.)-.18 E F2(Call)129.6 417.6 Q
F3(gethostbyname)2.502 E F2(if one sear)2.502 E .18 -.09(ch i)-.18 H 2.502(sb)
.09 G(eing perf)294.57 417.6 Q(ormed)-.18 E F4(75\21181)104.28 432.6 Q F5 4.714
(If only one sear)147.6 432.6 R 4.714(ch is being performed, we call)-.18 F F6
(gethostbyname)7.213 E F5 4.713(with the)7.213 F F6(RES_USE_INET6)129.6 444.6 Q
F5 .527(option set if the family is)3.027 F F6(AF_INET6)3.027 E F5 .527
(or the option clear)3.027 F .528(ed if the fam-)-.18 F 2.098(ily is)129.6
456.6 R F6(AF_INET)4.598 E F5 7.098(.F)C 2.097
(or example, if the caller speci\214es a hostname that has only an A)214.484
456.6 R -.18(re)129.6 468.6 S(cor).18 E 1.198(d, but speci\214es a family of)
-.18 F F6(AF_INET6)3.698 E F5 3.698(,w)C 3.699(ew)339.786 468.6 S 1.199
(ant to r)356.615 468.6 R 1.199(eturn the IPv4-mapped IPv6)-.18 F(addr)129.6
480.6 Q(ess.)-.18 E F2(Handle resolver failure)129.6 496.6 Q F4(82\21197)104.28
511.6 Q F5 .857(If the call to the r)147.6 511.6 R .857(esolver failed, but)
-.18 F F6(nsearch)3.357 E F5 .857(is two, this is not an err)3.357 F(or)-.18 E
3.356(,a)-.74 G 3.356(so)483.788 511.6 S .856(ne of)496.844 511.6 R .414
(the passes thr)129.6 523.6 R .414(ough the loop may succeed.)-.18 F(\(W)5.415
E 2.915(ec)-.92 G .415(heck at the end of the loop that at least)345.605 523.6
R(one)129.6 535.6 Q F6(addrinfo)3.01 E F5(str)3.01 E(uctur)-.08 E 3.01(ei)-.18
G 3.01(sb)245.3 535.6 S .51(eing r)258.08 535.6 R 3.01(eturned.\) But)-.18 F
.51(if this was the only call to the r)3.01 F(esolver)-.18 E(we r)129.6 547.6 Q
(eturn an err)-.18 E(or corr)-.18 E(esponding to the r)-.18 E -1.76(esolver 's)
-.18 F F6(h_errno)2.5 E F5(.)A F2(Chec)129.6 563.6 Q 2.502(kf)-.18 G(or ad)
161.748 563.6 Q(dress famil)-.09 E 2.502(ym)-.135 G(ismatc)246.555 563.6 Q(h)
-.09 E F4(98\211100)100.08 578.6 Q F5 .571(If the caller speci\214es an addr)
147.6 578.6 R .571(ess family)-.18 F 3.071(,b)-1.11 G .572(ut the family r)
331.677 578.6 R .572(eturned by the r)-.18 F .572(esolver dif-)-.18 F
(fers, this is an err)129.6 590.6 Q(or)-.18 E(.)-.74 E F2(Sa)129.6 606.6 Q
(ve canonical name)-.135 E F4(101\211106)95.88 621.6 Q F5 1.779
(If the caller speci\214es a hostname and the)147.6 621.6 R F6(AI_CANONNAME)
4.278 E F5 1.778(\215ag, we save the \214rst)4.278 F 2.026(canonical name r)
129.6 633.6 R 2.026(eturned by the r)-.18 F(esolver)-.18 E 7.026(.\()-.74 G
2.026(Recall fr)329.626 633.6 R 2.026(om Figur)-.18 F 4.526(e1)-.18 G 2.026
(1.22 that we call the)424.394 633.6 R -.18(re)129.6 645.6 S .703
(solver for the name).18 F F6(localhost)3.203 E F5 .703
(even of the caller does not specify a hostname.\))3.203 F -.92(We)5.702 G
(duplicate the string r)129.6 657.6 Q(eturned by the r)-.18 E
(esolver and save its pointer in)-.18 E F6(canon)2.5 E F5(.)A/F7 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 313 41
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(313)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL .4 LW 134.6 123 129.6 123 DL 137.105 123 132.105 123
DL 142.105 123 137.105 123 DL 147.105 123 142.105 123 DL 152.105 123 147.105
123 DL 157.105 123 152.105 123 DL 162.105 123 157.105 123 DL 167.105 123
162.105 123 DL 172.105 123 167.105 123 DL 177.105 123 172.105 123 DL 182.105
123 177.105 123 DL 187.105 123 182.105 123 DL 192.105 123 187.105 123 DL
197.105 123 192.105 123 DL 202.105 123 197.105 123 DL 207.105 123 202.105 123
DL 212.105 123 207.105 123 DL 217.105 123 212.105 123 DL 222.105 123 217.105
123 DL 227.105 123 222.105 123 DL 232.105 123 227.105 123 DL 237.105 123
232.105 123 DL 242.105 123 237.105 123 DL 247.105 123 242.105 123 DL 252.105
123 247.105 123 DL 257.105 123 252.105 123 DL 262.105 123 257.105 123 DL
267.105 123 262.105 123 DL 272.105 123 267.105 123 DL 277.105 123 272.105 123
DL 282.105 123 277.105 123 DL 287.105 123 282.105 123 DL 292.105 123 287.105
123 DL 297.105 123 292.105 123 DL 302.105 123 297.105 123 DL 307.105 123
302.105 123 DL 312.105 123 307.105 123 DL 317.105 123 312.105 123 DL 322.105
123 317.105 123 DL 327.105 123 322.105 123 DL 332.105 123 327.105 123 DL
337.105 123 332.105 123 DL 342.105 123 337.105 123 DL 347.105 123 342.105 123
DL 352.105 123 347.105 123 DL 357.105 123 352.105 123 DL 362.105 123 357.105
123 DL 367.105 123 362.105 123 DL 372.105 123 367.105 123 DL 377.105 123
372.105 123 DL 382.105 123 377.105 123 DL 387.105 123 382.105 123 DL 392.105
123 387.105 123 DL 397.105 123 392.105 123 DL 402.105 123 397.105 123 DL
407.105 123 402.105 123 DL 412.105 123 407.105 123 DL 417.105 123 412.105 123
DL 422.105 123 417.105 123 DL 427.105 123 422.105 123 DL 432.105 123 427.105
123 DL 437.105 123 432.105 123 DL 442.105 123 437.105 123 DL 447.105 123
442.105 123 DL/F3 9/Palatino-Italic@0 SF(libgai/getaddrinfo.c)449.355 125.5 Q
/F4 8.15/Courier@0 SF 58.68(69 /*)134.49 131.801 R
(remainder of for\(\) to look up hostname */)4.89 E 39.12(70 if)134.49 141.801
R(\(\(_res.options & RES_INIT\) == 0\))4.89 E 58.68(71 res_init\(\);)134.49
151.801 R(/* need this to set _res.options */)305.64 151.801 Q 39.12(72 if)
134.49 169.801 R(\(nsearch == 2\) {)4.89 E 58.68(73 _res.options)134.49 179.801
R(&= ~RES_USE_INET6;)4.89 E 58.68(74 hptr)134.49 189.801 R 4.89(=g)4.89 G
(ethostbyname2\(sptr->host, sptr->family\);)246.96 189.801 Q 39.12(75 })134.49
199.801 R(else {)4.89 E 58.68(76 if)134.49 209.801 R
(\(sptr->family == AF_INET6\))4.89 E 78.24(77 _res.options)134.49 219.801 R
(|= RES_USE_INET6;)4.89 E 58.68(78 else)134.49 229.801 R 78.24(79 _res.options)
134.49 239.801 R(&= ~RES_USE_INET6;)4.89 E 58.68(80 hptr)134.49 249.801 R 4.89
(=g)4.89 G(ethostbyname\(sptr->host\);)246.96 249.801 Q 39.12(81 })134.49
259.801 R 39.12(82 if)134.49 269.801 R(\(hptr == NULL\) {)4.89 E 58.68(83 if)
134.49 279.801 R(\(nsearch == 2\))4.89 E 78.24(84 continue;)134.49 289.801 R
(/* failure OK if multiple searches */)305.64 289.801 Q 58.68(85 switch)134.49
307.801 R(\(h_errno\) {)4.89 E 58.68(86 case)134.49 317.801 R(HOST_NOT_FOUND:)
4.89 E 78.24(87 error\(EAI_NONAME\);)134.49 327.801 R 58.68(88 case)134.49
337.801 R(TRY_AGAIN:)4.89 E 78.24(89 error\(EAI_AGAIN\);)134.49 347.801 R 58.68
(90 case)134.49 357.801 R(NO_RECOVERY:)4.89 E 78.24(91 error\(EAI_FAIL\);)
134.49 367.801 R 58.68(92 case)134.49 377.801 R(NO_DATA:)4.89 E 78.24
(93 error\(EAI_NODATA\);)134.49 387.801 R 58.68(94 default:)134.49 397.801 R
78.24(95 error\(EAI_NONAME\);)134.49 407.801 R 58.68(96 })134.49 417.801 R
39.12(97 })134.49 427.801 R 58.68(98 /*)134.49 437.801 R
(check for address family mismatch if one specified */)4.89 E 39.12(99 if)
134.49 447.801 R
(\(hints.ai_family != AF_UNSPEC && hints.ai_family != hptr->h_addrtype\))4.89 E
58.68(100 error\(EAI_ADDRFAMILY\);)129.6 457.801 R 58.68(101 /*)129.6 475.801 R
(save canonical name first time */)4.89 E 39.12(102 if)129.6 485.801 R
(\(hostname != NULL && hostname[0] != '\\0' &&)4.89 E 58.68
(103 \(hints.ai_flags)129.6 495.801 R 4.89(&A)4.89 G
(I_CANONNAME\) && canon == NULL\) {)300.75 495.801 Q 58.68(104 if)129.6 505.801
R 4.89(\(\()4.89 G(canon = strdup\(hptr->h_name\)\) == NULL\))237.18 505.801 Q
78.24(105 error\(EAI_MEMORY\);)129.6 515.801 R 39.12(106 })129.6 525.801 R
58.68(107 /*)129.6 535.801 R
(create one addrinfo{} for each returned address */)4.89 E 39.12(108 for)129.6
545.801 R(\(ap = hptr->h_addr_list; *ap != NULL; ap++\) {)4.89 E 58.68(109 rc)
129.6 555.801 R 4.89(=g)4.89 G
(a_aistruct\(&aipnext, &hints, *ap, hptr->h_addrtype\);)237.18 555.801 Q 58.68
(110 if)129.6 565.801 R(\(rc != 0\))4.89 E 78.24(111 error\(rc\);)129.6 575.801
R 39.12(112 })129.6 585.801 R 19.56(113 })129.6 595.801 R 19.56(114 if)129.6
605.801 R(\(aihead == NULL\))4.89 E 39.12(115 error\(EAI_NONAME\);)129.6
615.801 R(/* nothing found */)305.64 615.801 Q 134.6 620.602 129.6 620.602 DL
137.105 620.602 132.105 620.602 DL 142.105 620.602 137.105 620.602 DL 147.105
620.602 142.105 620.602 DL 152.105 620.602 147.105 620.602 DL 157.105 620.602
152.105 620.602 DL 162.105 620.602 157.105 620.602 DL 167.105 620.602 162.105
620.602 DL 172.105 620.602 167.105 620.602 DL 177.105 620.602 172.105 620.602
DL 182.105 620.602 177.105 620.602 DL 187.105 620.602 182.105 620.602 DL
192.105 620.602 187.105 620.602 DL 197.105 620.602 192.105 620.602 DL 202.105
620.602 197.105 620.602 DL 207.105 620.602 202.105 620.602 DL 212.105 620.602
207.105 620.602 DL 217.105 620.602 212.105 620.602 DL 222.105 620.602 217.105
620.602 DL 227.105 620.602 222.105 620.602 DL 232.105 620.602 227.105 620.602
DL 237.105 620.602 232.105 620.602 DL 242.105 620.602 237.105 620.602 DL
247.105 620.602 242.105 620.602 DL 252.105 620.602 247.105 620.602 DL 257.105
620.602 252.105 620.602 DL 262.105 620.602 257.105 620.602 DL 267.105 620.602
262.105 620.602 DL 272.105 620.602 267.105 620.602 DL 277.105 620.602 272.105
620.602 DL 282.105 620.602 277.105 620.602 DL 287.105 620.602 282.105 620.602
DL 292.105 620.602 287.105 620.602 DL 297.105 620.602 292.105 620.602 DL
302.105 620.602 297.105 620.602 DL 307.105 620.602 302.105 620.602 DL 312.105
620.602 307.105 620.602 DL 317.105 620.602 312.105 620.602 DL 322.105 620.602
317.105 620.602 DL 327.105 620.602 322.105 620.602 DL 332.105 620.602 327.105
620.602 DL 337.105 620.602 332.105 620.602 DL 342.105 620.602 337.105 620.602
DL 347.105 620.602 342.105 620.602 DL 352.105 620.602 347.105 620.602 DL
357.105 620.602 352.105 620.602 DL 362.105 620.602 357.105 620.602 DL 367.105
620.602 362.105 620.602 DL 372.105 620.602 367.105 620.602 DL 377.105 620.602
372.105 620.602 DL 382.105 620.602 377.105 620.602 DL 387.105 620.602 382.105
620.602 DL 392.105 620.602 387.105 620.602 DL 397.105 620.602 392.105 620.602
DL 402.105 620.602 397.105 620.602 DL 407.105 620.602 402.105 620.602 DL
412.105 620.602 407.105 620.602 DL 417.105 620.602 412.105 620.602 DL 422.105
620.602 417.105 620.602 DL 427.105 620.602 422.105 620.602 DL 432.105 620.602
427.105 620.602 DL 437.105 620.602 432.105 620.602 DL 442.105 620.602 437.105
620.602 DL 447.105 620.602 442.105 620.602 DL F3(libgai/getaddrinfo.c)449.355
623.102 Q/F5 8/Palatino-Bold@0 SF(Figure 1)223.88 636.602 Q(1.25)-.296 E/F6 8
/Courier@0 SF(getaddrinfo)6 E/F7 8/Palatino-Roman@0 SF
(function: lookup hostname.)2 E/F8 7/Palatino-Roman@0 SF 1.75<a943>233.453 678
S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 314 42
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(314)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2 9
/Helvetica-Bold@0 SF(Create one)129.6 123 Q/F3 9/Courier-Bold@0 SF(addrinfo)
2.502 E F2(structure per ad)2.502 E(dress)-.09 E/F4 7/Courier-Oblique@0 SF
(107\211112)95.88 138 Q/F5 10/Palatino-Roman@0 SF 1.069(For each addr)147.6 138
R 1.069(ess r)-.18 F 1.069(eturned by the r)-.18 F 1.069(esolver in the)-.18 F
/F6 10/Courier@0 SF(h_addr_list)3.569 E F5(array)3.569 E 3.57(,w)-1.11 G 3.57
(ec)476.97 138 S 1.07(all our)489.77 138 R F6(ga_aistruct)129.6 150 Q F5 .023
(function to cr)2.524 F .023(eate an)-.18 F F6(addrinfo)2.523 E F5(str)2.523 E
(uctur)-.08 E 2.523(ea)-.18 G .023(nd append it to the linked list)388.612 150
R(of str)129.6 162 Q(uctur)-.08 E(es being cr)-.18 E(eated.)-.18 E F2(Chec)
129.6 178 Q 2.502(kf)-.18 G(or no matc)161.748 178 Q(hes)-.09 E F4(114\211115)
95.88 193 Q F5 .677(If the head of the linked list of)147.6 193 R F6(addrinfo)
3.177 E F5(str)3.178 E(uctur)-.08 E .678(es is still a null pointer)-.18 F
3.178(,a)-.74 G .678(ll itera-)487.362 193 R(tions thr)129.6 205 Q(ough the)
-.18 E F6(for)2.5 E F5(loop failed.)2.5 E(Figur)147.6 229 Q 2.5(e1)-.18 G
(1.26 shows the \214nal part of the)183.17 229 Q F6(getaddrinfo)2.5 E F5
(function.)2.5 E .4 LW 134.6 242.2 129.6 242.2 DL 137.105 242.2 132.105 242.2
DL 142.105 242.2 137.105 242.2 DL 147.105 242.2 142.105 242.2 DL 152.105 242.2
147.105 242.2 DL 157.105 242.2 152.105 242.2 DL 162.105 242.2 157.105 242.2 DL
167.105 242.2 162.105 242.2 DL 172.105 242.2 167.105 242.2 DL 177.105 242.2
172.105 242.2 DL 182.105 242.2 177.105 242.2 DL 187.105 242.2 182.105 242.2 DL
192.105 242.2 187.105 242.2 DL 197.105 242.2 192.105 242.2 DL 202.105 242.2
197.105 242.2 DL 207.105 242.2 202.105 242.2 DL 212.105 242.2 207.105 242.2 DL
217.105 242.2 212.105 242.2 DL 222.105 242.2 217.105 242.2 DL 227.105 242.2
222.105 242.2 DL 232.105 242.2 227.105 242.2 DL 237.105 242.2 232.105 242.2 DL
242.105 242.2 237.105 242.2 DL 247.105 242.2 242.105 242.2 DL 252.105 242.2
247.105 242.2 DL 257.105 242.2 252.105 242.2 DL 262.105 242.2 257.105 242.2 DL
267.105 242.2 262.105 242.2 DL 272.105 242.2 267.105 242.2 DL 277.105 242.2
272.105 242.2 DL 282.105 242.2 277.105 242.2 DL 287.105 242.2 282.105 242.2 DL
292.105 242.2 287.105 242.2 DL 297.105 242.2 292.105 242.2 DL 302.105 242.2
297.105 242.2 DL 307.105 242.2 302.105 242.2 DL 312.105 242.2 307.105 242.2 DL
317.105 242.2 312.105 242.2 DL 322.105 242.2 317.105 242.2 DL 327.105 242.2
322.105 242.2 DL 332.105 242.2 327.105 242.2 DL 337.105 242.2 332.105 242.2 DL
342.105 242.2 337.105 242.2 DL 347.105 242.2 342.105 242.2 DL 352.105 242.2
347.105 242.2 DL 357.105 242.2 352.105 242.2 DL 362.105 242.2 357.105 242.2 DL
367.105 242.2 362.105 242.2 DL 372.105 242.2 367.105 242.2 DL 377.105 242.2
372.105 242.2 DL 382.105 242.2 377.105 242.2 DL 387.105 242.2 382.105 242.2 DL
392.105 242.2 387.105 242.2 DL 397.105 242.2 392.105 242.2 DL 402.105 242.2
397.105 242.2 DL 407.105 242.2 402.105 242.2 DL 412.105 242.2 407.105 242.2 DL
417.105 242.2 412.105 242.2 DL 422.105 242.2 417.105 242.2 DL 427.105 242.2
422.105 242.2 DL 432.105 242.2 427.105 242.2 DL 437.105 242.2 432.105 242.2 DL
442.105 242.2 437.105 242.2 DL 447.105 242.2 442.105 242.2 DL/F7 9
/Palatino-Italic@0 SF(libgai/getaddrinfo.c)449.355 244.7 Q/F8 8.15/Courier@0 SF
39.12(116 /*)129.6 251.001 R(return canonical name */)4.89 E 19.56(117 if)129.6
261.001 R(\(hostname != NULL && hostname[0] != '\\0' &&)4.89 E 39.12
(118 hints.ai_flags)129.6 271.001 R 4.89(&A)4.89 G(I_CANONNAME\) {)276.3
271.001 Q 39.12(119 if)129.6 281.001 R(\(canon != NULL\))4.89 E 58.68
(120 aihead->ai_canonname)129.6 291.001 R 4.89(=c)4.89 G 9.78(anon; /*)325.2
291.001 R(strdup'ed earlier */)4.89 E 39.12(121 else)129.6 301.001 R({)4.89 E
58.68(122 if)129.6 311.001 R 4.89(\(\()4.89 G
(aihead->ai_canonname = strdup\(search[0].host\)\) == NULL\))237.18 311.001 Q
78.24(123 error\(EAI_MEMORY\);)129.6 321.001 R 39.12(124 })129.6 331.001 R
19.56(125 })129.6 341.001 R 39.12(126 /*)129.6 351.001 R
(now process the service name */)4.89 E 19.56(127 if)129.6 361.001 R
(\(servname != NULL && servname[0] != '\\0'\) {)4.89 E 39.12(128 if)129.6
371.001 R 4.89(\(\()4.89 G(rc = ga_serv\(aihead, &hints, servname\)\) != 0\))
217.62 371.001 Q 58.68(129 error\(rc\);)129.6 381.001 R 19.56(130 })129.6
391.001 R 19.56(131 *result)129.6 401.001 R 4.89(=a)4.89 G 48.9(ihead; /*)
222.51 401.001 R(pointer to first structure in linked list */)4.89 E 19.56
(132 return)129.6 411.001 R(\(0\);)4.89 E 9.78(133 bad:)129.6 428.001 R 19.56
(134 freeaddrinfo\(aihead\);)129.6 438.001 R(/* free any alloc'ed memory */)
305.64 438.001 Q 19.56(135 return)129.6 448.001 R(\(error\);)4.89 E(136 })129.6
458.001 Q 134.6 462.802 129.6 462.802 DL 137.105 462.802 132.105 462.802 DL
142.105 462.802 137.105 462.802 DL 147.105 462.802 142.105 462.802 DL 152.105
462.802 147.105 462.802 DL 157.105 462.802 152.105 462.802 DL 162.105 462.802
157.105 462.802 DL 167.105 462.802 162.105 462.802 DL 172.105 462.802 167.105
462.802 DL 177.105 462.802 172.105 462.802 DL 182.105 462.802 177.105 462.802
DL 187.105 462.802 182.105 462.802 DL 192.105 462.802 187.105 462.802 DL
197.105 462.802 192.105 462.802 DL 202.105 462.802 197.105 462.802 DL 207.105
462.802 202.105 462.802 DL 212.105 462.802 207.105 462.802 DL 217.105 462.802
212.105 462.802 DL 222.105 462.802 217.105 462.802 DL 227.105 462.802 222.105
462.802 DL 232.105 462.802 227.105 462.802 DL 237.105 462.802 232.105 462.802
DL 242.105 462.802 237.105 462.802 DL 247.105 462.802 242.105 462.802 DL
252.105 462.802 247.105 462.802 DL 257.105 462.802 252.105 462.802 DL 262.105
462.802 257.105 462.802 DL 267.105 462.802 262.105 462.802 DL 272.105 462.802
267.105 462.802 DL 277.105 462.802 272.105 462.802 DL 282.105 462.802 277.105
462.802 DL 287.105 462.802 282.105 462.802 DL 292.105 462.802 287.105 462.802
DL 297.105 462.802 292.105 462.802 DL 302.105 462.802 297.105 462.802 DL
307.105 462.802 302.105 462.802 DL 312.105 462.802 307.105 462.802 DL 317.105
462.802 312.105 462.802 DL 322.105 462.802 317.105 462.802 DL 327.105 462.802
322.105 462.802 DL 332.105 462.802 327.105 462.802 DL 337.105 462.802 332.105
462.802 DL 342.105 462.802 337.105 462.802 DL 347.105 462.802 342.105 462.802
DL 352.105 462.802 347.105 462.802 DL 357.105 462.802 352.105 462.802 DL
362.105 462.802 357.105 462.802 DL 367.105 462.802 362.105 462.802 DL 372.105
462.802 367.105 462.802 DL 377.105 462.802 372.105 462.802 DL 382.105 462.802
377.105 462.802 DL 387.105 462.802 382.105 462.802 DL 392.105 462.802 387.105
462.802 DL 397.105 462.802 392.105 462.802 DL 402.105 462.802 397.105 462.802
DL 407.105 462.802 402.105 462.802 DL 412.105 462.802 407.105 462.802 DL
417.105 462.802 412.105 462.802 DL 422.105 462.802 417.105 462.802 DL 427.105
462.802 422.105 462.802 DL 432.105 462.802 427.105 462.802 DL 437.105 462.802
432.105 462.802 DL 442.105 462.802 437.105 462.802 DL 447.105 462.802 442.105
462.802 DL F7(libgai/getaddrinfo.c)449.355 465.302 Q/F9 8/Palatino-Bold@0 SF
(Figure 1)217.476 478.802 Q(1.26)-.296 E/F10 8/Courier@0 SF(getaddrinfo)6 E/F11
8/Palatino-Roman@0 SF(function: pr)2 E(ocess service name.)-.144 E F2
(Return canonical name)129.6 506.802 Q F4(116\211125)95.88 521.802 Q F5 1.265
(If the caller speci\214es a hostname and the)147.6 521.802 R F6(AI_CANONNAME)
3.765 E F5 1.265(\215ag, and if we saved a)3.765 F 2.768
(copy to the canonical name in our)129.6 533.802 R F6(canon)5.269 E F5(pointer)
5.269 E 5.269(,t)-.74 G 2.769(hat pointer is r)378.705 533.802 R 2.769
(eturned in the)-.18 F F6(ai_canonname)129.6 545.802 Q F5 1.739
(member of the \214rst)4.24 F F6(addrinfo)4.239 E F5(str)4.239 E(uctur)-.08 E
4.239(e. If)-.18 F 1.739(no canonical name was)4.239 F .408(found by the r)
129.6 557.802 R .408(esolver \(per)-.18 F .408(haps the hostname was an addr)
-.18 F .408(ess string\), then a copy of the)-.18 F(hostname ar)129.6 569.802 Q
(gument is r)-.18 E(eturned instead.)-.18 E F2(Pr)129.6 585.802 Q(ocess ser)
-.18 E(vice name).09 E F4(126\211130)95.88 600.802 Q F5 1.242
(If the caller speci\214es a service name, it is now pr)147.6 600.802 R 1.241
(ocessed by calling our)-.18 F F6(ga_serv)3.741 E F5(function.)129.6 612.802 Q
F2(Return pointer to linked list)129.6 628.802 Q F4(131\211132)95.88 643.802 Q
F5 .039(The pointer to the head of the linked list of)147.6 643.802 R F6
(addrinfo)2.539 E F5(str)2.54 E(uctur)-.08 E .04(es that have been cr)-.18 F
(e-)-.18 E(ated is r)129.6 655.802 Q(eturned, along with a function r)-.18 E
(eturn value of 0.)-.18 E/F12 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 315 43
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(315)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 9/Helvetica-Bold@0 SF(Err)129.6 123 Q(or return)
-.18 E/F4 7/Courier-Oblique@0 SF(133\211135)95.88 138 Q/F5 10/Palatino-Roman@0
SF 1.134(If an err)147.6 138 R 1.134(or was encounter)-.18 F(ed,)-.18 E/F6 10
/Courier@0 SF(freeaddrinfo)3.634 E F5 1.134(is called to fr)3.634 F 1.134
(ee all the memory that)-.18 F(was allocated, and the r)129.6 150 Q
(eturn value is the)-.18 E F6(EAI_)2.5 E/F7 10/Palatino-Italic@0 SF(xxx)A F5
(value.)2.5 E(Our)147.6 186 Q F6(ga_serv)3.604 E F5 1.104
(function, which was called fr)3.604 F 1.104(om Figur)-.18 F 3.604(e1)-.18 G
1.104(1.26 to pr)401.372 186 R 1.105(ocess the service)-.18 F(name ar)129.6 198
Q(gument, is shown in Figur)-.18 E 2.5(e1)-.18 G(1.27.)293.23 198 Q F3(Chec)
129.6 214 Q 2.502(kf)-.18 G(or por)161.748 214 Q 2.502(tn).18 G(umber string)
198.837 214 Q F4(12\21127)104.28 229 Q F5 .589(If the \214rst character of the\
 service name is a digit, we assume the service name is a)147.6 229 R 1.008
(port number and call)129.6 241 R F6(atoi)3.508 E F5 1.008
(to convert it to binary)3.508 F 6.008(.I)-1.11 G 3.508(ft)367.51 241 S 1.008
(he caller speci\214es a socket type)377.608 241 R(\()129.6 253 Q F6
(SOCK_STREAM)A F5(or)4.303 E F6(SOCK_DGRAM)4.303 E F5 1.803(\), then our)B F6
(ga_port)4.303 E F5 1.802(function is called once for that)4.303 F 1.377
(socket type.)129.6 265 R 1.378(But if no socket type is speci\214ed, our)6.377
F F6(ga_port)3.878 E F5 1.378(function is called twice,)3.878 F
(once for TCP and once for UDP)129.6 277 Q 5(.\()-1.29 G(Recall Figur)278.39
277 Q 2.5(e1)-.18 G(1.2.\))343.19 277 Q F3 -.972 -.72(Tr y)129.6 293 T/F8 9
/Courier-Bold@0 SF(getservbyname)3.222 E F3 -.18(fo)2.502 G 2.502(rT).18 G(CP)
237.996 293 Q F4(28\21136)104.28 308 Q F5 .067
(If no socket type is speci\214ed, or a TCP socket is speci\214ed,)147.6 308 R
F6(getservbyname)2.567 E F5 .067(is called)2.567 F .566(with a second ar)129.6
320 R .566(gument of)-.18 F F6("tcp")3.066 E F5 5.566(.I)C 3.066(ft)294.406 320
S .566(his succeeds, our)304.062 320 R F6(ga_port)3.067 E F5 .567
(function is called.)3.067 F(If)5.567 E .142
(this call fails, that is OK, as the service name could be valid for UDP)129.6
332 R 5.142(.W)-1.29 G 2.642(ek)446.984 332 S .142(eep a counter)459.976 332 R
.105(of the number of times that)129.6 344 R F6(ga_port)2.605 E F5 -.18(re)
2.605 G .105(turns success and r).18 F .105(eturn an err)-.18 F .106
(or only if this is 0)-.18 F(at the end of the function.)129.6 356 Q F3 -.972
-.72(Tr y)129.6 372 T F8(getservbyname)3.222 E F3 -.18(fo)2.502 G 2.502(rU).18
G(DP)238.995 372 Q F4(37\21144)104.28 387 Q F5 .254
(If no socket type is speci\214ed, or a UDP socket is speci\214ed, we call)
147.6 387 R F6(getservbyname)2.754 E F5(with a second ar)129.6 399 Q(gument of)
-.18 E F6("udp")2.5 E F5 5(.I)C 2.5(ft)291.01 399 S(his succeeds, we call our)
300.1 399 Q F6(ga_port)2.5 E F5(function.)2.5 E F3(Chec)129.6 415 Q 2.502(kf)
-.18 G(or err)161.748 415 Q(or)-.18 E F4(45\21151)104.28 430 Q F5(If our)147.6
430 Q F6(nfound)2.5 E F5(counter is nonzer)2.5 E(o, we had success.)-.18 E
(Otherwise an err)5 E(or is r)-.18 E(eturned.)-.18 E(Our)147.6 466 Q F6
(ga_port)5.331 E F5 2.832(function, which we show in Figur)5.331 F 5.332(e1)
-.18 G 2.832(1.28, was called fr)395.782 466 R 2.832(om Fig-)-.18 F(ur)129.6
478 Q 2.5(e1)-.18 G(1.27 each time a port number was found.)151.14 478 Q F3
(Loop thr)129.6 494 Q(ough all)-.18 E F8(addrinfo)2.502 E F3(structures)2.502 E
F4(33)104.28 509 Q F5 4.077 -.92(We l)147.6 509 T 2.237(oop thr).92 F 2.237
(ough all the)-.18 F F6(addrinfo)4.737 E F5(str)4.737 E(uctur)-.08 E 2.237
(es that wer)-.18 F 4.737(ec)-.18 G -.18(re)419.753 509 S 2.237
(ated by the calls to).18 F F6(ga_aistruct)129.6 521 Q F5 3.635(in Figur)6.135
F 3.635(es 1)-.18 F 3.635(1.24 and 1)-.55 F 6.135(1.25. The)-.55 F F6(AI_CLONE)
6.135 E F5 3.635(\215ag is always set by)6.135 F F6(ga_aistruct)129.6 533 Q F5
.408(when no socket type is speci\214ed by the caller)2.908 F 5.408(.T)-.74 G
.408(hat is an indication that)413.94 533 R(this)129.6 545 Q F6(addrinfo)2.5 E
F5(str)2.5 E(uctur)-.08 E 2.5(em)-.18 G
(ight need to be cloned for both TCP and UDP)249.85 545 Q(.)-1.29 E F3(Chec)
129.6 561 Q(k)-.18 E F8(AI_CLONE)2.502 E F3<8d61>2.502 E(g)-.09 E F4(34\21142)
104.28 576 Q F5 1.433(If the)147.6 576 R F6(AI_CLONE)3.933 E F5 1.434
(\215ag is set and if the socket type is nonzer)3.933 F 1.434(o, another)-.18 F
F6(addrinfo)3.934 E F5(str)129.6 588 Q(uctur)-.08 E 3.465(ei)-.18 G 3.465(sc)
175.665 588 S .965(loned fr)187.81 588 R .965(om this one by our)-.18 F F6
(ga_clone)3.465 E F5 3.465(function. W)3.465 F 3.465(es)-.92 G .965
(how an example of)432.485 588 R(this shortly)129.6 600 Q(.)-1.11 E F3(Set por)
129.6 616 Q 2.502(tn).18 G(umber in soc)171.693 616 Q(ket ad)-.18 E
(dress structure)-.09 E F4(44\21147)104.28 631 Q F5 .973
(The port number in the socket addr)147.6 631 R .973(ess str)-.18 F(uctur)-.08
E 3.473(ei)-.18 G 3.473(ss)372.962 631 S .973(et and our counter)384.915 631 R
F6(nfound)3.473 E F5(is)3.473 E(incr)129.6 643 Q(emented.)-.18 E/F9 7
/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 316 44
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(316)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 123 129.6 123 DL 136.1 123 131.1 123 DL 141.1 123 136.1 123 DL 146.1
123 141.1 123 DL 151.1 123 146.1 123 DL 156.1 123 151.1 123 DL 161.1 123 156.1
123 DL 166.1 123 161.1 123 DL 171.1 123 166.1 123 DL 176.1 123 171.1 123 DL
181.1 123 176.1 123 DL 186.1 123 181.1 123 DL 191.1 123 186.1 123 DL 196.1 123
191.1 123 DL 201.1 123 196.1 123 DL 206.1 123 201.1 123 DL 211.1 123 206.1 123
DL 216.1 123 211.1 123 DL 221.1 123 216.1 123 DL 226.1 123 221.1 123 DL 231.1
123 226.1 123 DL 236.1 123 231.1 123 DL 241.1 123 236.1 123 DL 246.1 123 241.1
123 DL 251.1 123 246.1 123 DL 256.1 123 251.1 123 DL 261.1 123 256.1 123 DL
266.1 123 261.1 123 DL 271.1 123 266.1 123 DL 276.1 123 271.1 123 DL 281.1 123
276.1 123 DL 286.1 123 281.1 123 DL 291.1 123 286.1 123 DL 296.1 123 291.1 123
DL 301.1 123 296.1 123 DL 306.1 123 301.1 123 DL 311.1 123 306.1 123 DL 316.1
123 311.1 123 DL 321.1 123 316.1 123 DL 326.1 123 321.1 123 DL 331.1 123 326.1
123 DL 336.1 123 331.1 123 DL 341.1 123 336.1 123 DL 346.1 123 341.1 123 DL
351.1 123 346.1 123 DL 356.1 123 351.1 123 DL 361.1 123 356.1 123 DL 366.1 123
361.1 123 DL 371.1 123 366.1 123 DL 376.1 123 371.1 123 DL 381.1 123 376.1 123
DL 386.1 123 381.1 123 DL 391.1 123 386.1 123 DL 396.1 123 391.1 123 DL 401.1
123 396.1 123 DL 406.1 123 401.1 123 DL 411.1 123 406.1 123 DL 416.1 123 411.1
123 DL 421.1 123 416.1 123 DL 426.1 123 421.1 123 DL 431.1 123 426.1 123 DL
436.1 123 431.1 123 DL 441.1 123 436.1 123 DL 446.1 123 441.1 123 DL 451.1 123
446.1 123 DL 456.1 123 451.1 123 DL 461.1 123 456.1 123 DL/F2 9
/Palatino-Italic@0 SF(libgai/ga_serv)463.35 125.5 Q(.c)-.495 E/F3 8.15
/Courier@0 SF 4.89(5i)139.38 131.801 S(nt)154.05 131.801 Q 4.89(6g)139.38
141.801 S(a_serv\(struct addrinfo *aihead, const struct addrinfo *hintsp,)
154.05 141.801 Q 44.01(7c)139.38 151.801 S(onst char *serv\))193.17 151.801 Q
4.89(8{)139.38 161.801 S 24.45(9i)139.38 171.801 S 19.56(nt port,)173.61
171.801 R(rc, nfound;)4.89 E 19.56(10 struct)134.49 181.801 R(servent *sptr;)
4.89 E 19.56(11 nfound)134.49 198.801 R 4.89(=0)4.89 G(;)217.62 198.801 Q 19.56
(12 if)134.49 208.801 R(\(isdigit\(serv[0]\)\) {)4.89 E
(/* check for port number string first */)305.64 208.801 Q 39.12(13 port)134.49
218.801 R 4.89(=h)4.89 G(tons\(atoi\(serv\)\);)227.4 218.801 Q 39.12(14 if)
134.49 228.801 R(\(hintsp->ai_socktype\) {)4.89 E 78.24(15 /*)134.49 238.801 R
(caller specifies socket type */)4.89 E 58.68(16 if)134.49 248.801 R 4.89(\(\()
4.89 G(rc = ga_port\(aihead, port, hintsp->ai_socktype\)\) < 0\))237.18 248.801
Q 78.24(17 return)134.49 258.801 R(\(EAI_MEMORY\);)4.89 E 58.68(18 nfound)
134.49 268.801 R(+= rc;)4.89 E 39.12(19 })134.49 278.801 R(else {)4.89 E 78.24
(20 /*)134.49 288.801 R(caller does not specify socket type */)4.89 E 58.68
(21 if)134.49 298.801 R 4.89(\(\()4.89 G
(rc = ga_port\(aihead, port, SOCK_STREAM\)\) < 0\))237.18 298.801 Q 78.24
(22 return)134.49 308.801 R(\(EAI_MEMORY\);)4.89 E 58.68(23 nfound)134.49
318.801 R(+= rc;)4.89 E 58.68(24 if)134.49 328.801 R 4.89(\(\()4.89 G
(rc = ga_port\(aihead, port, SOCK_DGRAM\)\) < 0\))237.18 328.801 Q 78.24
(25 return)134.49 338.801 R(\(EAI_MEMORY\);)4.89 E 58.68(26 nfound)134.49
348.801 R(+= rc;)4.89 E 39.12(27 })134.49 358.801 R 19.56(28 })134.49 368.801 R
(else {)4.89 E 58.68(29 /*)134.49 378.801 R(try service name, TCP then UDP */)
4.89 E 39.12(30 if)134.49 388.801 R
(\(hintsp->ai_socktype == 0 || hintsp->ai_socktype == SOCK_STREAM\) {)4.89 E
58.68(31 if)134.49 398.801 R 4.89(\(\()4.89 G
(sptr = getservbyname\(serv, "tcp"\)\) != NULL\) {)237.18 398.801 Q 78.24
(32 if)134.49 408.801 R 4.89(\(\()4.89 G
(rc = ga_port\(aihead, sptr->s_port, SOCK_STREAM\)\) < 0\))256.74 408.801 Q
97.8(33 return)134.49 418.801 R(\(EAI_MEMORY\);)4.89 E 78.24(34 nfound)134.49
428.801 R(+= rc;)4.89 E 58.68(35 })134.49 438.801 R 39.12(36 })134.49 448.801 R
39.12(37 if)134.49 458.801 R
(\(hintsp->ai_socktype == 0 || hintsp->ai_socktype == SOCK_DGRAM\) {)4.89 E
58.68(38 if)134.49 468.801 R 4.89(\(\()4.89 G
(sptr = getservbyname\(serv, "udp"\)\) != NULL\) {)237.18 468.801 Q 78.24
(39 if)134.49 478.801 R 4.89(\(\()4.89 G
(rc = ga_port\(aihead, sptr->s_port, SOCK_DGRAM\)\) < 0\))256.74 478.801 Q 97.8
(40 return)134.49 488.801 R(\(EAI_MEMORY\);)4.89 E 78.24(41 nfound)134.49
498.801 R(+= rc;)4.89 E 58.68(42 })134.49 508.801 R 39.12(43 })134.49 518.801 R
19.56(44 })134.49 528.801 R 19.56(45 if)134.49 545.801 R(\(nfound == 0\) {)4.89
E 39.12(46 if)134.49 555.801 R(\(hintsp->ai_socktype == 0\))4.89 E 58.68
(47 return)134.49 565.801 R 14.67(\(EAI_NONAME\); /*)4.89 F
(all calls to getservbyname\(\) failed */)4.89 E 39.12(48 else)134.49 575.801 R
58.68(49 return)134.49 585.801 R 9.78(\(EAI_SERVICE\); /*)4.89 F
(service not supported for socket type */)4.89 E 19.56(50 })134.49 595.801 R
19.56(51 return)134.49 605.801 R(\(0\);)4.89 E(52 })134.49 615.801 Q 134.6
620.602 129.6 620.602 DL 136.1 620.602 131.1 620.602 DL 141.1 620.602 136.1
620.602 DL 146.1 620.602 141.1 620.602 DL 151.1 620.602 146.1 620.602 DL 156.1
620.602 151.1 620.602 DL 161.1 620.602 156.1 620.602 DL 166.1 620.602 161.1
620.602 DL 171.1 620.602 166.1 620.602 DL 176.1 620.602 171.1 620.602 DL 181.1
620.602 176.1 620.602 DL 186.1 620.602 181.1 620.602 DL 191.1 620.602 186.1
620.602 DL 196.1 620.602 191.1 620.602 DL 201.1 620.602 196.1 620.602 DL 206.1
620.602 201.1 620.602 DL 211.1 620.602 206.1 620.602 DL 216.1 620.602 211.1
620.602 DL 221.1 620.602 216.1 620.602 DL 226.1 620.602 221.1 620.602 DL 231.1
620.602 226.1 620.602 DL 236.1 620.602 231.1 620.602 DL 241.1 620.602 236.1
620.602 DL 246.1 620.602 241.1 620.602 DL 251.1 620.602 246.1 620.602 DL 256.1
620.602 251.1 620.602 DL 261.1 620.602 256.1 620.602 DL 266.1 620.602 261.1
620.602 DL 271.1 620.602 266.1 620.602 DL 276.1 620.602 271.1 620.602 DL 281.1
620.602 276.1 620.602 DL 286.1 620.602 281.1 620.602 DL 291.1 620.602 286.1
620.602 DL 296.1 620.602 291.1 620.602 DL 301.1 620.602 296.1 620.602 DL 306.1
620.602 301.1 620.602 DL 311.1 620.602 306.1 620.602 DL 316.1 620.602 311.1
620.602 DL 321.1 620.602 316.1 620.602 DL 326.1 620.602 321.1 620.602 DL 331.1
620.602 326.1 620.602 DL 336.1 620.602 331.1 620.602 DL 341.1 620.602 336.1
620.602 DL 346.1 620.602 341.1 620.602 DL 351.1 620.602 346.1 620.602 DL 356.1
620.602 351.1 620.602 DL 361.1 620.602 356.1 620.602 DL 366.1 620.602 361.1
620.602 DL 371.1 620.602 366.1 620.602 DL 376.1 620.602 371.1 620.602 DL 381.1
620.602 376.1 620.602 DL 386.1 620.602 381.1 620.602 DL 391.1 620.602 386.1
620.602 DL 396.1 620.602 391.1 620.602 DL 401.1 620.602 396.1 620.602 DL 406.1
620.602 401.1 620.602 DL 411.1 620.602 406.1 620.602 DL 416.1 620.602 411.1
620.602 DL 421.1 620.602 416.1 620.602 DL 426.1 620.602 421.1 620.602 DL 431.1
620.602 426.1 620.602 DL 436.1 620.602 431.1 620.602 DL 441.1 620.602 436.1
620.602 DL 446.1 620.602 441.1 620.602 DL 451.1 620.602 446.1 620.602 DL 456.1
620.602 451.1 620.602 DL 461.1 620.602 456.1 620.602 DL F2(libgai/ga_serv)
463.35 623.102 Q(.c)-.495 E/F4 8/Palatino-Bold@0 SF(Figure 1)266.34 636.602 Q
(1.27)-.296 E/F5 8/Courier@0 SF(ga_serv)6 E/F6 8/Palatino-Roman@0 SF(function.)
2 E/F7 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75
E(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 317 45
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(317)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL .4 LW 134.6 123 129.6 123 DL 135.614 123 130.614 123
DL 140.614 123 135.614 123 DL 145.614 123 140.614 123 DL 150.614 123 145.614
123 DL 155.614 123 150.614 123 DL 160.614 123 155.614 123 DL 165.614 123
160.614 123 DL 170.614 123 165.614 123 DL 175.614 123 170.614 123 DL 180.614
123 175.614 123 DL 185.614 123 180.614 123 DL 190.614 123 185.614 123 DL
195.614 123 190.614 123 DL 200.614 123 195.614 123 DL 205.614 123 200.614 123
DL 210.614 123 205.614 123 DL 215.614 123 210.614 123 DL 220.614 123 215.614
123 DL 225.614 123 220.614 123 DL 230.614 123 225.614 123 DL 235.614 123
230.614 123 DL 240.614 123 235.614 123 DL 245.614 123 240.614 123 DL 250.614
123 245.614 123 DL 255.614 123 250.614 123 DL 260.614 123 255.614 123 DL
265.614 123 260.614 123 DL 270.614 123 265.614 123 DL 275.614 123 270.614 123
DL 280.614 123 275.614 123 DL 285.614 123 280.614 123 DL 290.614 123 285.614
123 DL 295.614 123 290.614 123 DL 300.614 123 295.614 123 DL 305.614 123
300.614 123 DL 310.614 123 305.614 123 DL 315.614 123 310.614 123 DL 320.614
123 315.614 123 DL 325.614 123 320.614 123 DL 330.614 123 325.614 123 DL
335.614 123 330.614 123 DL 340.614 123 335.614 123 DL 345.614 123 340.614 123
DL 350.614 123 345.614 123 DL 355.614 123 350.614 123 DL 360.614 123 355.614
123 DL 365.614 123 360.614 123 DL 370.614 123 365.614 123 DL 375.614 123
370.614 123 DL 380.614 123 375.614 123 DL 385.614 123 380.614 123 DL 390.614
123 385.614 123 DL 395.614 123 390.614 123 DL 400.614 123 395.614 123 DL
405.614 123 400.614 123 DL 410.614 123 405.614 123 DL 415.614 123 410.614 123
DL 420.614 123 415.614 123 DL 425.614 123 420.614 123 DL 430.614 123 425.614
123 DL 435.614 123 430.614 123 DL 440.614 123 435.614 123 DL 445.614 123
440.614 123 DL 450.614 123 445.614 123 DL 455.614 123 450.614 123 DL 460.614
123 455.614 123 DL/F3 9/Palatino-Italic@0 SF(libgai/ga_port.c)462.864 125.5 Q
/F4 8.15/Courier@0 SF(27 int)134.49 131.801 Q
(28 ga_port\(struct addrinfo *aihead, int port, int socktype\))134.49 141.801 Q
39.12(29 /*)134.49 151.801 R(port must be in network byte order */)4.89 E(30 {)
134.49 161.801 Q 19.56(31 int nfound)134.49 171.801 R 4.89(=0)4.89 G(;)256.74
171.801 Q 19.56(32 struct)134.49 181.801 R(addrinfo *ai;)4.89 E 19.56(33 for)
134.49 198.801 R(\(ai = aihead; ai != NULL; ai = ai->ai_next\) {)4.89 E 39.12
(34 if)134.49 208.801 R(\(ai->ai_flags & AI_CLONE\) {)4.89 E 58.68(35 if)134.49
218.801 R(\(ai->ai_socktype != 0\) {)4.89 E 78.24(36 if)134.49 228.801 R 4.89
(\(\()4.89 G(ai = ga_clone\(ai\)\) == NULL\))256.74 228.801 Q 97.8(37 return)
134.49 238.801 R 14.67(\(-1\); /*)4.89 F(memory allocation error */)4.89 E
78.24(38 /*)134.49 248.801 R
(ai points to newly cloned entry, which is what we want */)4.89 E 58.68(39 })
134.49 258.801 R 39.12(40 })134.49 268.801 R
(else if \(ai->ai_socktype != socktype\))4.89 E 58.68(41 continue;)134.49
278.801 R(/* ignore if mismatch on socket type */)305.64 278.801 Q 39.12
(42 ai->ai_socktype)134.49 295.801 R 4.89(=s)4.89 G(ocktype;)281.19 295.801 Q
39.12(43 switch)134.49 312.801 R(\(ai->ai_family\) {)4.89 E 39.12(44 case)
134.49 322.801 R(AF_INET:)4.89 E 58.68(45 \(\(struct)134.49 332.801 R
(sockaddr_in *\) ai->ai_addr\)->sin_port = port;)4.89 E 58.68(46 nfound++;)
134.49 342.801 R 58.68(47 break;)134.49 352.801 R 39.12(48 case)134.49 362.801
R(AF_INET6:)4.89 E 58.68(49 \(\(struct)134.49 372.801 R
(sockaddr_in6 *\) ai->ai_addr\)->sin6_port = port;)4.89 E 58.68(50 nfound++;)
134.49 382.801 R 58.68(51 break;)134.49 392.801 R 39.12(52 })134.49 402.801 R
19.56(53 })134.49 412.801 R 19.56(54 return)134.49 422.801 R(\(nfound\);)4.89 E
(55 })134.49 432.801 Q 134.6 437.602 129.6 437.602 DL 135.614 437.602 130.614
437.602 DL 140.614 437.602 135.614 437.602 DL 145.614 437.602 140.614 437.602
DL 150.614 437.602 145.614 437.602 DL 155.614 437.602 150.614 437.602 DL
160.614 437.602 155.614 437.602 DL 165.614 437.602 160.614 437.602 DL 170.614
437.602 165.614 437.602 DL 175.614 437.602 170.614 437.602 DL 180.614 437.602
175.614 437.602 DL 185.614 437.602 180.614 437.602 DL 190.614 437.602 185.614
437.602 DL 195.614 437.602 190.614 437.602 DL 200.614 437.602 195.614 437.602
DL 205.614 437.602 200.614 437.602 DL 210.614 437.602 205.614 437.602 DL
215.614 437.602 210.614 437.602 DL 220.614 437.602 215.614 437.602 DL 225.614
437.602 220.614 437.602 DL 230.614 437.602 225.614 437.602 DL 235.614 437.602
230.614 437.602 DL 240.614 437.602 235.614 437.602 DL 245.614 437.602 240.614
437.602 DL 250.614 437.602 245.614 437.602 DL 255.614 437.602 250.614 437.602
DL 260.614 437.602 255.614 437.602 DL 265.614 437.602 260.614 437.602 DL
270.614 437.602 265.614 437.602 DL 275.614 437.602 270.614 437.602 DL 280.614
437.602 275.614 437.602 DL 285.614 437.602 280.614 437.602 DL 290.614 437.602
285.614 437.602 DL 295.614 437.602 290.614 437.602 DL 300.614 437.602 295.614
437.602 DL 305.614 437.602 300.614 437.602 DL 310.614 437.602 305.614 437.602
DL 315.614 437.602 310.614 437.602 DL 320.614 437.602 315.614 437.602 DL
325.614 437.602 320.614 437.602 DL 330.614 437.602 325.614 437.602 DL 335.614
437.602 330.614 437.602 DL 340.614 437.602 335.614 437.602 DL 345.614 437.602
340.614 437.602 DL 350.614 437.602 345.614 437.602 DL 355.614 437.602 350.614
437.602 DL 360.614 437.602 355.614 437.602 DL 365.614 437.602 360.614 437.602
DL 370.614 437.602 365.614 437.602 DL 375.614 437.602 370.614 437.602 DL
380.614 437.602 375.614 437.602 DL 385.614 437.602 380.614 437.602 DL 390.614
437.602 385.614 437.602 DL 395.614 437.602 390.614 437.602 DL 400.614 437.602
395.614 437.602 DL 405.614 437.602 400.614 437.602 DL 410.614 437.602 405.614
437.602 DL 415.614 437.602 410.614 437.602 DL 420.614 437.602 415.614 437.602
DL 425.614 437.602 420.614 437.602 DL 430.614 437.602 425.614 437.602 DL
435.614 437.602 430.614 437.602 DL 440.614 437.602 435.614 437.602 DL 445.614
437.602 440.614 437.602 DL 450.614 437.602 445.614 437.602 DL 455.614 437.602
450.614 437.602 DL 460.614 437.602 455.614 437.602 DL F3(libgai/ga_port.c)
462.864 440.102 Q/F5 8/Palatino-Bold@0 SF(Figure 1)266.34 453.602 Q(1.28)-.296
E/F6 8/Courier@0 SF(ga_port)6 E/F7 8/Palatino-Roman@0 SF(function.)2 E/F8 10
/Palatino-Roman@0 SF .335(Consider an example.)147.6 486.002 R .335(In Figur)
5.335 F 2.835(e1)-.18 G .335(1.1 we assumed a call to)297.715 486.002 R/F9 10
/Courier@0 SF(getaddrinfo)2.835 E F8 .335(for a host)2.835 F .442
(with two IP addr)129.6 498.002 R .442(esses, a service name of)-.18 F F9
(domain)2.942 E F8 .443(\(port 53 for both TCP and UDP\), and)2.943 F 2.821
(no speci\214cation of the socket type.)129.6 510.002 R 2.821(The loop in our)
7.821 F F9(getaddrinfo)5.321 E F8 2.82(function \(Fig-)5.32 F(ur)129.6 522.002
Q 5.517(e1)-.18 G 3.017(1.25\) cr)154.157 522.002 R 3.017(eates two)-.18 F F9
(addrinfo)5.517 E F8(str)5.517 E(uctur)-.08 E 3.018(es, one for each IP addr)
-.18 F 3.018(ess r)-.18 F 3.018(eturned by)-.18 F F9(gethostbyname)129.6
534.002 Q F8 6.146(.T)C(he)222.376 534.002 Q F9(AI_CLONE)3.646 E F8 1.146
(\215ag is also set in each str)3.646 F(uctur)-.08 E 1.145
(e, because no socket)-.18 F(type is speci\214ed.)129.6 546.002 Q 1.84 -.92
(We s)5 H(how the r).92 E(esulting linked list in Figur)-.18 E 2.5(e1)-.18 G
(1.29.)402.32 546.002 Q F9(ga_serv)147.6 558.002 Q F8 1.267(is called fr)3.766
F 1.267(om Figur)-.18 F 3.767(e1)-.18 G 3.767(1.26. Since)296.204 558.002 R
(the)3.767 E F9(domain)3.767 E F8 1.267(service name is valid for)3.767 F 1.098
(both TCP and UDP)129.6 570.002 R(,)-1.29 E F9(getservbyname)3.598 E F8 1.098
(is called two times, and)3.598 F F9(ga_port)3.597 E F8 1.097(is called two)
3.597 F .702(times: \214rst with a \214nal ar)129.6 582.002 R .702(gument of)
-.18 F F9(SOCK_STREAM)3.202 E F8 .702(and again with a \214nal ar)3.202 F .703
(gument of)-.18 F F9(SOCK_DGRAM)129.6 594.002 Q F8 6.18(.T)C 1.18
(he \214rst time)204.41 594.002 R F9(ga_port)3.68 E F8 1.179
(is called it starts with the linked list shown in)3.679 F(Figur)129.6 606.002
Q 2.736(e1)-.18 G 2.736(1.29. In)165.406 606.002 R(Figur)2.736 E 2.736(e1)-.18
G .236(1.28 the)238.374 606.002 R F9(AI_CLONE)2.736 E F8 .236
(\215ag is set for both str)2.736 F(uctur)-.08 E .236(es, but the socket)-.18 F
.008(type is 0.)129.6 618.002 R(Ther)5.008 E(efor)-.18 E 2.508(ea)-.18 G .008
(ll that happens to each)224.052 618.002 R F9(addrinfo)2.508 E F8(str)2.508 E
(uctur)-.08 E 2.508(et)-.18 G .008(he \214rst time)422.178 618.002 R F9
(ga_port)2.507 E F8 .647(is called is to set the)129.6 630.002 R F9
(ai_socktype)3.147 E F8 .647(member to)3.147 F F9(SOCK_STREAM)3.147 E F8 .647
(and the port number in)3.147 F 1.093(the socket addr)129.6 642.002 R 1.092
(ess str)-.18 F(uctur)-.08 E 3.592(et)-.18 G 3.592(o5)262.8 642.002 S 3.592
(3. The)276.852 642.002 R F9(AI_CLONE)3.592 E F8 1.092(\215ag r)3.592 F 1.092
(emains set.)-.18 F 1.092(This gives us the)6.092 F(linked list shown in Figur)
129.6 654.002 Q 2.5(e1)-.18 G(1.30.)255 654.002 Q/F10 7/Palatino-Roman@0 SF
1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 318 46
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(318)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL
353.4 200.2 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL CL ST/F2 8/Palatino-Roman@0 SF
(socket type 0)301.652 157.36 Q/F3 8/Courier@0 SF(AI_CLONE)305.4 167.36 Q 436.2
200.2 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL CL ST F2(socket type 0)384.452 157.36
Q F3(AI_CLONE)388.2 167.36 Q 270.6 135.4 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL
ST(aihead)227.4 117.76 Q/F4 8/Courier-Bold@0 SF(addrinfo{})300.6 117.76 Q
(addrinfo{})383.4 117.76 Q 295.8 128.2 267 128.2 DL 295.8 128.2 MT -5.04 1.656
RL 0 -3.384 RL CL BL 295.8 128.2 MT -5.04 1.656 RL 0 -3.384 RL CL ST 349.8 193
353.4 193 DL 353.4 193 MT -3.6 0 RL -2.4 0 -1.2 0 3.6 0 RC 4.8 0 7.2 -2.4 7.2
-7.2 RC 0 -4.8 0 -13.2 0 -25.2 RC 0 -12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2
-7.2 RC 4.8 0 7.8 0 9 0 RC 1.8 0 RL ST 378.6 128.2 MT -5.04 1.656 RL 0 -3.384
RL CL BL 378.6 128.2 MT -5.04 1.656 RL 0 -3.384 RL CL ST 353.4 257.8 MT 0 -36
RL -57.6 0 RL 0 36 RL CL ST F2(206.62.226.35)301.6 236.56 Q 436.2 257.8 MT 0
-36 RL -57.6 0 RL 0 36 RL CL ST(206.62.226.66)384.4 236.56 Q F4(sockaddr_in{})
293.4 218.56 Q(sockaddr_in{})376.2 218.56 Q 299.4 185.8 295.8 185.8 DL 295.8
185.8 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2 RC 0 7.2 0 12.6
0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 295.8 229 MT -5.04 1.656 RL 0
-3.384 RL CL BL 295.8 229 MT -5.04 1.656 RL 0 -3.384 RL CL ST 382.2 185.8 378.6
185.8 DL 378.6 185.8 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2
RC 0 7.2 0 12.6 0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 378.6 229 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 378.6 229 MT -5.04 1.656 RL 0 -3.384 RL CL ST
/F5 8/Palatino-Bold@0 SF(Figure 1)200.248 275.8 Q(1.29)-.296 E F3(addrinfo)6 E
F2(str)2 E(uctur)-.064 E(es when)-.144 E F3(ga_port)2 E F2
(is called \214rst time.)2 E 353.4 389 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL CL ST
F3(SOCK_STREAM)298.2 346.16 Q(AI_CLONE)305.4 356.16 Q 436.2 389 MT 0 -79.2 RL
-57.6 0 RL 0 79.2 RL CL ST(SOCK_STREAM)381 346.16 Q(AI_CLONE)388.2 356.16 Q
270.6 324.2 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aihead)227.4 306.56 Q F4
(addrinfo{})300.6 306.56 Q(addrinfo{})383.4 306.56 Q 295.8 317 267 317 DL 295.8
317 MT -5.04 1.656 RL 0 -3.384 RL CL BL 295.8 317 MT -5.04 1.656 RL 0 -3.384 RL
CL ST 349.8 381.8 353.4 381.8 DL 353.4 381.8 MT -3.6 0 RL -2.4 0 -1.2 0 3.6 0
RC 4.8 0 7.2 -2.4 7.2 -7.2 RC 0 -4.8 0 -13.2 0 -25.2 RC 0 -12 0 -20.4 0 -25.2
RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 4.8 0 7.8 0 9 0 RC 1.8 0 RL ST 378.6 317 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 378.6 317 MT -5.04 1.656 RL 0 -3.384 RL CL ST
353.4 446.6 MT 0 -36 RL -57.6 0 RL 0 36 RL CL ST F2(206.62.226.35)301.6 425.36
Q(port 53)312.128 435.36 Q 436.2 446.6 MT 0 -36 RL -57.6 0 RL 0 36 RL CL ST
(206.62.226.66)384.4 425.36 Q(port 53)394.928 435.36 Q F4(sockaddr_in{})293.4
407.36 Q(sockaddr_in{})376.2 407.36 Q 299.4 374.6 295.8 374.6 DL 295.8 374.6 MT
-5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2 RC 0 7.2 0 12.6 0 16.2
RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 295.8 417.8 MT -5.04 1.656 RL 0 -3.384
RL CL BL 295.8 417.8 MT -5.04 1.656 RL 0 -3.384 RL CL ST 382.2 374.6 378.6
374.6 DL 378.6 374.6 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2
RC 0 7.2 0 12.6 0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 378.6 417.8 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 378.6 417.8 MT -5.04 1.656 RL 0 -3.384 RL CL
ST F5(Figure 1)214.672 464.6 Q(1.30)-.296 E F3(addrinfo)6 E F2(str)2 E(uctur)
-.064 E(es after \214rst call to)-.144 E F3(ga_port)2 E F2(.)A 270.6 577.8 MT 0
-79.2 RL -57.6 0 RL 0 79.2 RL CL ST F3(SOCK_STREAM)215.4 534.96 Q(AI_CLONE)
222.6 544.96 Q 353.4 577.8 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL CL ST(SOCK_DGRAM)
300.6 534.96 Q 436.2 577.8 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL CL ST
(SOCK_STREAM)381 534.96 Q(AI_CLONE)388.2 544.96 Q 519 577.8 MT 0 -79.2 RL -57.6
0 RL 0 79.2 RL CL ST(SOCK_DGRAM)466.2 534.96 Q 187.8 513 MT 0 -14.4 RL -57.6 0
RL 0 14.4 RL CL ST(aihead)144.6 495.36 Q F4(addrinfo{})217.8 495.36 Q
(addrinfo{})300.6 495.36 Q(addrinfo{})383.4 495.36 Q(addrinfo{})466.2 495.36 Q
213 505.8 184.2 505.8 DL 213 505.8 MT -5.04 1.656 RL 0 -3.384 RL CL BL 213
505.8 MT -5.04 1.656 RL 0 -3.384 RL CL ST 267 570.6 270.6 570.6 DL 270.6 570.6
MT -3.6 0 RL -2.4 0 -1.2 0 3.6 0 RC 4.8 0 7.2 -2.4 7.2 -7.2 RC 0 -4.8 0 -13.2 0
-25.2 RC 0 -12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 4.8 0 7.8 0 9 0
RC 1.8 0 RL ST 295.8 505.8 MT -5.04 1.656 RL 0 -3.384 RL CL BL 295.8 505.8 MT
-5.04 1.656 RL 0 -3.384 RL CL ST 349.8 570.6 353.4 570.6 DL 353.4 570.6 MT -3.6
0 RL -2.4 0 -1.2 0 3.6 0 RC 4.8 0 7.2 -2.4 7.2 -7.2 RC 0 -4.8 0 -13.2 0 -25.2
RC 0 -12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 4.8 0 7.8 0 9 0 RC 1.8
0 RL ST 378.6 505.8 MT -5.04 1.656 RL 0 -3.384 RL CL BL 378.6 505.8 MT -5.04
1.656 RL 0 -3.384 RL CL ST 432.6 570.6 436.2 570.6 DL 436.2 570.6 MT -3.6 0 RL
-2.4 0 -1.2 0 3.6 0 RC 4.8 0 7.2 -2.4 7.2 -7.2 RC 0 -4.8 0 -13.2 0 -25.2 RC 0
-12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 4.8 0 7.8 0 9 0 RC 1.8 0 RL
ST 461.4 505.8 MT -5.04 1.656 RL 0 -3.384 RL CL BL 461.4 505.8 MT -5.04 1.656
RL 0 -3.384 RL CL ST 270.6 635.4 MT 0 -36 RL -57.6 0 RL 0 36 RL CL ST F2
(206.62.226.35)218.8 614.16 Q(port 53)229.328 624.16 Q 353.4 635.4 MT 0 -36 RL
-57.6 0 RL 0 36 RL CL ST(206.62.226.35)301.6 614.16 Q(port 53)312.128 624.16 Q
436.2 635.4 MT 0 -36 RL -57.6 0 RL 0 36 RL CL ST(206.62.226.66)384.4 614.16 Q
(port 53)394.928 624.16 Q 519 635.4 MT 0 -36 RL -57.6 0 RL 0 36 RL CL ST
(206.62.226.66)467.2 614.16 Q(port 53)477.728 624.16 Q F4(sockaddr_in{})210.6
596.16 Q(sockaddr_in{})293.4 596.16 Q(sockaddr_in{})376.2 596.16 Q
(sockaddr_in{})459 596.16 Q 216.6 563.4 213 563.4 DL 213 563.4 MT -5.4 0 RL
-3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2 RC 0 7.2 0 12.6 0 16.2 RC 0 3.6
1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 213 606.6 MT -5.04 1.656 RL 0 -3.384 RL CL BL
213 606.6 MT -5.04 1.656 RL 0 -3.384 RL CL ST 299.4 563.4 295.8 563.4 DL 295.8
563.4 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0 16.2 RC 0 7.2 0 12.6
0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 295.8 606.6 MT -5.04 1.656 RL 0
-3.384 RL CL BL 295.8 606.6 MT -5.04 1.656 RL 0 -3.384 RL CL ST 382.2 563.4
378.6 563.4 DL 378.6 563.4 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4 5.4 RC 0 3.6 0 9 0
16.2 RC 0 7.2 0 12.6 0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4 0 RL ST 378.6 606.6
MT -5.04 1.656 RL 0 -3.384 RL CL BL 378.6 606.6 MT -5.04 1.656 RL 0 -3.384 RL
CL ST 465 563.4 461.4 563.4 DL 461.4 563.4 MT -5.4 0 RL -3.6 0 -5.4 1.8 -5.4
5.4 RC 0 3.6 0 9 0 16.2 RC 0 7.2 0 12.6 0 16.2 RC 0 3.6 1.8 5.4 5.4 5.4 RC 5.4
0 RL ST 461.4 606.6 MT -5.04 1.656 RL 0 -3.384 RL CL BL 461.4 606.6 MT -5.04
1.656 RL 0 -3.384 RL CL ST F5(Figure 1)209.328 653.4 Q(1.31)-.296 E F3
(addrinfo)6 E F2(str)2 E(uctur)-.064 E(es after second call to)-.144 E F3
(ga_port)2 E F2(.)A/F6 7/Palatino-Roman@0 SF 1.75<a943>233.453 676 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 319 47
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(319)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF 1.72(But the second time)
147.6 123 R/F4 10/Courier@0 SF(ga_port)4.221 E F3 1.721
(is called \(with a \214nal ar)4.221 F 1.721(gument of)-.18 F F4(SOCK_DGRAM)
4.221 E F3(\),)A .347(since the)129.6 135 R F4(AI_CLONE)2.847 E F3 .347
(\215ag is set and the socket type is not 0,)2.847 F F4(ga_clone)2.846 E F3
.346(is called for each)2.846 F F4(addrinfo)129.6 147 Q F3(str)4.026 E(uctur)
-.08 E 4.026(e. The)-.18 F F4(ai_socktype)4.026 E F3 1.527
(member in each of the newly cloned str)4.026 F(uc-)-.08 E(tur)129.6 159 Q .865
(es is set to)-.18 F F4(SOCK_DGRAM)3.365 E F3 .864
(and we end up with the linked list shown in Figur)3.365 F 3.364(e1)-.18 G
(1.31.)499.6 159 Q .102(In this \214gur)129.6 171 R 2.602(et)-.18 G .102
(he second)192.286 171 R F4(addrinfo)2.602 E F3(str)2.602 E(uctur)-.08 E 2.602
(ea)-.18 G .102(nd its socket addr)336.854 171 R .103(ess str)-.18 F(uctur)-.08
E 2.603(ea)-.18 G .463 -.18(re c)478.907 171 T(loned).18 E(fr)129.6 183 Q 2.754
(om the \214rst set of str)-.18 F(uctur)-.08 E 2.754(es, and the fourth)-.18 F
F4(addrinfo)5.254 E F3(str)5.254 E(uctur)-.08 E 5.254(ea)-.18 G 2.753
(nd its socket)459.004 183 R(addr)129.6 195 Q(ess str)-.18 E(uctur)-.08 E 2.5
(ea)-.18 G .36 -.18(re c)213.55 195 T(loned fr).18 E(om the thir)-.18 E 2.5(ds)
-.18 G(et of str)325.51 195 Q(uctur)-.08 E(es.)-.18 E(Figur)147.6 219 Q 3.214
(e1)-.18 G .714(1.32 shows our)183.884 219 R F4(ga_clone)3.214 E F3 .714
(function, which was called fr)3.214 F .714(om Figur)-.18 F 3.215(e1)-.18 G
.715(1.28 to)490.165 219 R .212(clone a new)129.6 231 R F4(addrinfo)2.712 E F3
(str)2.712 E(uctur)-.08 E 2.712(ea)-.18 G .211(nd its socket addr)283.22 231 R
.211(ess str)-.18 F(uctur)-.08 E 2.711(ef)-.18 G -.18(ro)424.146 231 S 2.711
(ma).18 G 2.711(ne)449.917 231 S .211(xisting set of)463.238 231 R(str)129.6
243 Q(uctur)-.08 E(es.)-.18 E .4 LW 134.6 256.2 129.6 256.2 DL 136.942 256.2
131.942 256.2 DL 141.942 256.2 136.942 256.2 DL 146.942 256.2 141.942 256.2 DL
151.942 256.2 146.942 256.2 DL 156.942 256.2 151.942 256.2 DL 161.942 256.2
156.942 256.2 DL 166.942 256.2 161.942 256.2 DL 171.942 256.2 166.942 256.2 DL
176.942 256.2 171.942 256.2 DL 181.942 256.2 176.942 256.2 DL 186.942 256.2
181.942 256.2 DL 191.942 256.2 186.942 256.2 DL 196.942 256.2 191.942 256.2 DL
201.942 256.2 196.942 256.2 DL 206.942 256.2 201.942 256.2 DL 211.942 256.2
206.942 256.2 DL 216.942 256.2 211.942 256.2 DL 221.942 256.2 216.942 256.2 DL
226.942 256.2 221.942 256.2 DL 231.942 256.2 226.942 256.2 DL 236.942 256.2
231.942 256.2 DL 241.942 256.2 236.942 256.2 DL 246.942 256.2 241.942 256.2 DL
251.942 256.2 246.942 256.2 DL 256.942 256.2 251.942 256.2 DL 261.942 256.2
256.942 256.2 DL 266.942 256.2 261.942 256.2 DL 271.942 256.2 266.942 256.2 DL
276.942 256.2 271.942 256.2 DL 281.942 256.2 276.942 256.2 DL 286.942 256.2
281.942 256.2 DL 291.942 256.2 286.942 256.2 DL 296.942 256.2 291.942 256.2 DL
301.942 256.2 296.942 256.2 DL 306.942 256.2 301.942 256.2 DL 311.942 256.2
306.942 256.2 DL 316.942 256.2 311.942 256.2 DL 321.942 256.2 316.942 256.2 DL
326.942 256.2 321.942 256.2 DL 331.942 256.2 326.942 256.2 DL 336.942 256.2
331.942 256.2 DL 341.942 256.2 336.942 256.2 DL 346.942 256.2 341.942 256.2 DL
351.942 256.2 346.942 256.2 DL 356.942 256.2 351.942 256.2 DL 361.942 256.2
356.942 256.2 DL 366.942 256.2 361.942 256.2 DL 371.942 256.2 366.942 256.2 DL
376.942 256.2 371.942 256.2 DL 381.942 256.2 376.942 256.2 DL 386.942 256.2
381.942 256.2 DL 391.942 256.2 386.942 256.2 DL 396.942 256.2 391.942 256.2 DL
401.942 256.2 396.942 256.2 DL 406.942 256.2 401.942 256.2 DL 411.942 256.2
406.942 256.2 DL 416.942 256.2 411.942 256.2 DL 421.942 256.2 416.942 256.2 DL
426.942 256.2 421.942 256.2 DL 431.942 256.2 426.942 256.2 DL 436.942 256.2
431.942 256.2 DL 441.942 256.2 436.942 256.2 DL 446.942 256.2 441.942 256.2 DL
451.942 256.2 446.942 256.2 DL 456.942 256.2 451.942 256.2 DL/F5 9
/Palatino-Italic@0 SF(libgai/ga_clone.c)459.192 258.7 Q/F6 8.15/Courier@0 SF
4.89(5s)139.38 265.001 S(truct addrinfo *)154.05 265.001 Q 4.89(6g)139.38
275.001 S(a_clone\(struct addrinfo *ai\))154.05 275.001 Q 4.89(7{)139.38
285.001 S 24.45(8s)139.38 295.001 S(truct addrinfo *new;)173.61 295.001 Q 24.45
(9i)139.38 313.001 S 4.89(f\(\()173.61 313.001 S
(new = calloc\(1, sizeof\(struct addrinfo\)\)\) == NULL\))198.06 313.001 Q
78.24(10 return)134.49 323.001 R(\(NULL\);)4.89 E 19.56(11 new->ai_next)134.49
341.001 R 4.89(=a)4.89 G(i->ai_next;)246.96 341.001 Q 19.56(12 ai->ai_next)
134.49 351.001 R 4.89(=n)4.89 G(ew;)242.07 351.001 Q 19.56(13 new->ai_flags)
134.49 369.001 R 4.89(=0)4.89 G 48.9(;/)251.85 369.001 S 4.89(*m)310.53 369.001
S(ake sure AI_CLONE is off */)325.2 369.001 Q 19.56(14 new->ai_family)134.49
379.001 R 4.89(=a)4.89 G(i->ai_family;)256.74 379.001 Q 19.56
(15 new->ai_socktype)134.49 389.001 R 4.89(=a)4.89 G(i->ai_socktype;)266.52
389.001 Q 19.56(16 new->ai_protocol)134.49 399.001 R 4.89(=a)4.89 G
(i->ai_protocol;)266.52 399.001 Q 19.56(17 new->ai_canonname)134.49 409.001 R
4.89(=N)4.89 G(ULL;)271.41 409.001 Q 19.56(18 new->ai_addrlen)134.49 419.001 R
4.89(=a)4.89 G(i->ai_addrlen;)261.63 419.001 Q 19.56(19 if)134.49 429.001 R
4.89(\(\()4.89 G(new->ai_addr = malloc\(ai->ai_addrlen\)\) == NULL\))198.06
429.001 Q 39.12(20 return)134.49 439.001 R(\(NULL\);)4.89 E 19.56
(21 memcpy\(new->ai_addr,)134.49 449.001 R(ai->ai_addr, ai->ai_addrlen\);)4.89
E 19.56(22 return)134.49 467.001 R(\(new\);)4.89 E(23 })134.49 477.001 Q 134.6
481.802 129.6 481.802 DL 136.942 481.802 131.942 481.802 DL 141.942 481.802
136.942 481.802 DL 146.942 481.802 141.942 481.802 DL 151.942 481.802 146.942
481.802 DL 156.942 481.802 151.942 481.802 DL 161.942 481.802 156.942 481.802
DL 166.942 481.802 161.942 481.802 DL 171.942 481.802 166.942 481.802 DL
176.942 481.802 171.942 481.802 DL 181.942 481.802 176.942 481.802 DL 186.942
481.802 181.942 481.802 DL 191.942 481.802 186.942 481.802 DL 196.942 481.802
191.942 481.802 DL 201.942 481.802 196.942 481.802 DL 206.942 481.802 201.942
481.802 DL 211.942 481.802 206.942 481.802 DL 216.942 481.802 211.942 481.802
DL 221.942 481.802 216.942 481.802 DL 226.942 481.802 221.942 481.802 DL
231.942 481.802 226.942 481.802 DL 236.942 481.802 231.942 481.802 DL 241.942
481.802 236.942 481.802 DL 246.942 481.802 241.942 481.802 DL 251.942 481.802
246.942 481.802 DL 256.942 481.802 251.942 481.802 DL 261.942 481.802 256.942
481.802 DL 266.942 481.802 261.942 481.802 DL 271.942 481.802 266.942 481.802
DL 276.942 481.802 271.942 481.802 DL 281.942 481.802 276.942 481.802 DL
286.942 481.802 281.942 481.802 DL 291.942 481.802 286.942 481.802 DL 296.942
481.802 291.942 481.802 DL 301.942 481.802 296.942 481.802 DL 306.942 481.802
301.942 481.802 DL 311.942 481.802 306.942 481.802 DL 316.942 481.802 311.942
481.802 DL 321.942 481.802 316.942 481.802 DL 326.942 481.802 321.942 481.802
DL 331.942 481.802 326.942 481.802 DL 336.942 481.802 331.942 481.802 DL
341.942 481.802 336.942 481.802 DL 346.942 481.802 341.942 481.802 DL 351.942
481.802 346.942 481.802 DL 356.942 481.802 351.942 481.802 DL 361.942 481.802
356.942 481.802 DL 366.942 481.802 361.942 481.802 DL 371.942 481.802 366.942
481.802 DL 376.942 481.802 371.942 481.802 DL 381.942 481.802 376.942 481.802
DL 386.942 481.802 381.942 481.802 DL 391.942 481.802 386.942 481.802 DL
396.942 481.802 391.942 481.802 DL 401.942 481.802 396.942 481.802 DL 406.942
481.802 401.942 481.802 DL 411.942 481.802 406.942 481.802 DL 416.942 481.802
411.942 481.802 DL 421.942 481.802 416.942 481.802 DL 426.942 481.802 421.942
481.802 DL 431.942 481.802 426.942 481.802 DL 436.942 481.802 431.942 481.802
DL 441.942 481.802 436.942 481.802 DL 446.942 481.802 441.942 481.802 DL
451.942 481.802 446.942 481.802 DL 456.942 481.802 451.942 481.802 DL F5
(libgai/ga_clone.c)459.192 484.302 Q/F7 8/Palatino-Bold@0 SF(Figure 1)263.94
497.802 Q(1.32)-.296 E/F8 8/Courier@0 SF(ga_clone)6 E/F9 8/Palatino-Roman@0 SF
(function.)2 E/F10 9/Helvetica-Bold@0 SF(Allocate)129.6 525.802 Q/F11 9
/Courier-Bold@0 SF(addrinfo)2.502 E F10(structure and inser)2.502 E 2.502(ti)
.18 G(nto linked list)302.517 525.802 Q/F12 7/Courier-Oblique@0 SF(9\21112)
108.48 540.802 Q F3 5.152(An)147.6 540.802 S(ew)166.352 540.802 Q F4(addrinfo)
5.152 E F3(str)5.152 E(uctur)-.08 E 5.152(ei)-.18 G 5.152(sa)285.538 540.802 S
2.652(llocated and its)299.93 540.802 R F4(ai_next)5.152 E F3 2.653
(pointer is set to the)5.152 F F4(ai_next)129.6 552.802 Q F3 .568
(pointer of the entry being cloned \(i.e., what will be the pr)3.068 F .568
(evious entry on the)-.18 F 3.866(list\). The)129.6 564.802 R 1.366
(next pointer of the entry being cloned becomes the new str)3.866 F(uctur)-.08
E 3.867(ej)-.18 G 1.367(ust allo-)482.593 564.802 R(cated.)129.6 576.802 Q F10
-2.412(Initializ e)129.6 592.802 R(fr)2.502 E(om c)-.18 E(loned entr)-.18 E(y)
.09 E F12(13\21122)104.28 607.802 Q F3 .01(All the \214elds in the new)147.6
607.802 R F4(addrinfo)2.509 E F3(str)2.509 E(uctur)-.08 E 2.509(ea)-.18 G .369
-.18(re c)353.486 607.802 T .009(opied fr).18 F .009(om the entry being cloned)
-.18 F .43(with the exception of)129.6 619.802 R F4(ai_flags)2.93 E F3 2.93(,w)
C .431(hich is set to 0, and)288.72 619.802 R F4(ai_canonname)2.931 E F3 2.931
(,w)C .431(hich is set to)463.657 619.802 R 3.15(an)129.6 631.802 S .65
(ull pointer)143.57 631.802 R 5.65(.A)-.74 G .65(pointer to the newly cr)209.11
631.802 R .65(eated str)-.18 F(uctur)-.08 E 3.15(ei)-.18 G 3.15(st)384.98
631.802 S .65(he r)395.63 631.802 R .65(eturn value of the func-)-.18 F(tion.)
129.6 643.802 Q/F13 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 320 48
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(320)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF(Our)147.6 123 Q/F3 10/Courier@0 SF(ga_unix)4.846 E F2
2.347(function, which we shown in Figur)4.846 F 4.847(e1)-.18 G 2.347
(1.33, was called fr)397.722 123 R 2.347(om Fig-)-.18 F(ur)129.6 135 Q 2.5(e1)
-.18 G(1.20 to completely pr)151.14 135 Q(ocess a Unix domain pathname.)-.18 E
.4 LW 134.6 148.2 129.6 148.2 DL 138.598 148.2 133.598 148.2 DL 143.598 148.2
138.598 148.2 DL 148.598 148.2 143.598 148.2 DL 153.598 148.2 148.598 148.2 DL
158.598 148.2 153.598 148.2 DL 163.598 148.2 158.598 148.2 DL 168.598 148.2
163.598 148.2 DL 173.598 148.2 168.598 148.2 DL 178.598 148.2 173.598 148.2 DL
183.598 148.2 178.598 148.2 DL 188.598 148.2 183.598 148.2 DL 193.598 148.2
188.598 148.2 DL 198.598 148.2 193.598 148.2 DL 203.598 148.2 198.598 148.2 DL
208.598 148.2 203.598 148.2 DL 213.598 148.2 208.598 148.2 DL 218.598 148.2
213.598 148.2 DL 223.598 148.2 218.598 148.2 DL 228.598 148.2 223.598 148.2 DL
233.598 148.2 228.598 148.2 DL 238.598 148.2 233.598 148.2 DL 243.598 148.2
238.598 148.2 DL 248.598 148.2 243.598 148.2 DL 253.598 148.2 248.598 148.2 DL
258.598 148.2 253.598 148.2 DL 263.598 148.2 258.598 148.2 DL 268.598 148.2
263.598 148.2 DL 273.598 148.2 268.598 148.2 DL 278.598 148.2 273.598 148.2 DL
283.598 148.2 278.598 148.2 DL 288.598 148.2 283.598 148.2 DL 293.598 148.2
288.598 148.2 DL 298.598 148.2 293.598 148.2 DL 303.598 148.2 298.598 148.2 DL
308.598 148.2 303.598 148.2 DL 313.598 148.2 308.598 148.2 DL 318.598 148.2
313.598 148.2 DL 323.598 148.2 318.598 148.2 DL 328.598 148.2 323.598 148.2 DL
333.598 148.2 328.598 148.2 DL 338.598 148.2 333.598 148.2 DL 343.598 148.2
338.598 148.2 DL 348.598 148.2 343.598 148.2 DL 353.598 148.2 348.598 148.2 DL
358.598 148.2 353.598 148.2 DL 363.598 148.2 358.598 148.2 DL 368.598 148.2
363.598 148.2 DL 373.598 148.2 368.598 148.2 DL 378.598 148.2 373.598 148.2 DL
383.598 148.2 378.598 148.2 DL 388.598 148.2 383.598 148.2 DL 393.598 148.2
388.598 148.2 DL 398.598 148.2 393.598 148.2 DL 403.598 148.2 398.598 148.2 DL
408.598 148.2 403.598 148.2 DL 413.598 148.2 408.598 148.2 DL 418.598 148.2
413.598 148.2 DL 423.598 148.2 418.598 148.2 DL 428.598 148.2 423.598 148.2 DL
433.598 148.2 428.598 148.2 DL 438.598 148.2 433.598 148.2 DL 443.598 148.2
438.598 148.2 DL 448.598 148.2 443.598 148.2 DL 453.598 148.2 448.598 148.2 DL
458.598 148.2 453.598 148.2 DL/F4 9/Palatino-Italic@0 SF(libgai/ga_unix.c)
460.848 150.7 Q/F5 8.15/Courier@0 SF 4.89(3i)139.38 157.001 S(nt)154.05 157.001
Q 4.89(4g)139.38 167.001 S
(a_unix\(const char *path, struct addrinfo *hintsp, struct addrinfo **result\))
154.05 167.001 Q 4.89(5{)139.38 177.001 S 24.45(6i)139.38 187.001 S 19.56
(nt rc;)173.61 187.001 R 24.45(7s)139.38 197.001 S
(truct addrinfo *aihead, **aipnext;)173.61 197.001 Q 24.45(8a)139.38 215.001 S
(ihead = NULL;)173.61 215.001 Q 24.45(9a)139.38 225.001 S(ipnext = &aihead;)
173.61 225.001 Q 19.56(10 if)134.49 243.001 R
(\(hintsp->ai_family != AF_UNSPEC && hintsp->ai_family != AF_LOCAL\))4.89 E
39.12(11 return)134.49 253.001 R(\(EAI_ADDRFAMILY\);)4.89 E 19.56(12 if)134.49
271.001 R(\(hintsp->ai_socktype == 0\) {)4.89 E 58.68(13 /*)134.49 281.001 R
(no socket type specified: return stream then dgram */)4.89 E 39.12
(14 hintsp->ai_socktype)134.49 291.001 R 4.89(=S)4.89 G(OCK_STREAM;)300.75
291.001 Q 39.12(15 if)134.49 301.001 R 4.89(\(\()4.89 G
(rc = ga_aistruct\(&aipnext, hintsp, path, AF_LOCAL\)\) != 0\))217.62 301.001 Q
58.68(16 return)134.49 311.001 R(\(rc\);)4.89 E 39.12(17 hintsp->ai_socktype)
134.49 321.001 R 4.89(=S)4.89 G(OCK_DGRAM;)300.75 321.001 Q 19.56(18 })134.49
331.001 R 19.56(19 if)134.49 341.001 R 4.89(\(\()4.89 G
(rc = ga_aistruct\(&aipnext, hintsp, path, AF_LOCAL\)\) != 0\))198.06 341.001 Q
39.12(20 return)134.49 351.001 R(\(rc\);)4.89 E 19.56(21 if)134.49 369.001 R
(\(hintsp->ai_flags & AI_CANONNAME\) {)4.89 E 39.12(22 struct)134.49 379.001 R
(utsname myname;)4.89 E 39.12(23 if)134.49 397.001 R(\(uname\(&myname\) < 0\))
4.89 E 58.68(24 return)134.49 407.001 R(\(EAI_SYSTEM\);)4.89 E 39.12(25 if)
134.49 417.001 R 4.89(\(\()4.89 G
(aihead->ai_canonname = strdup\(myname.nodename\)\) == NULL\))217.62 417.001 Q
58.68(26 return)134.49 427.001 R(\(EAI_MEMORY\);)4.89 E 19.56(27 })134.49
437.001 R 19.56(28 *result)134.49 447.001 R 4.89(=a)4.89 G 48.9(ihead; /*)
222.51 447.001 R(pointer to first structure in linked list */)4.89 E 19.56
(29 return)134.49 457.001 R(\(0\);)4.89 E(30 })134.49 467.001 Q 134.6 471.802
129.6 471.802 DL 138.598 471.802 133.598 471.802 DL 143.598 471.802 138.598
471.802 DL 148.598 471.802 143.598 471.802 DL 153.598 471.802 148.598 471.802
DL 158.598 471.802 153.598 471.802 DL 163.598 471.802 158.598 471.802 DL
168.598 471.802 163.598 471.802 DL 173.598 471.802 168.598 471.802 DL 178.598
471.802 173.598 471.802 DL 183.598 471.802 178.598 471.802 DL 188.598 471.802
183.598 471.802 DL 193.598 471.802 188.598 471.802 DL 198.598 471.802 193.598
471.802 DL 203.598 471.802 198.598 471.802 DL 208.598 471.802 203.598 471.802
DL 213.598 471.802 208.598 471.802 DL 218.598 471.802 213.598 471.802 DL
223.598 471.802 218.598 471.802 DL 228.598 471.802 223.598 471.802 DL 233.598
471.802 228.598 471.802 DL 238.598 471.802 233.598 471.802 DL 243.598 471.802
238.598 471.802 DL 248.598 471.802 243.598 471.802 DL 253.598 471.802 248.598
471.802 DL 258.598 471.802 253.598 471.802 DL 263.598 471.802 258.598 471.802
DL 268.598 471.802 263.598 471.802 DL 273.598 471.802 268.598 471.802 DL
278.598 471.802 273.598 471.802 DL 283.598 471.802 278.598 471.802 DL 288.598
471.802 283.598 471.802 DL 293.598 471.802 288.598 471.802 DL 298.598 471.802
293.598 471.802 DL 303.598 471.802 298.598 471.802 DL 308.598 471.802 303.598
471.802 DL 313.598 471.802 308.598 471.802 DL 318.598 471.802 313.598 471.802
DL 323.598 471.802 318.598 471.802 DL 328.598 471.802 323.598 471.802 DL
333.598 471.802 328.598 471.802 DL 338.598 471.802 333.598 471.802 DL 343.598
471.802 338.598 471.802 DL 348.598 471.802 343.598 471.802 DL 353.598 471.802
348.598 471.802 DL 358.598 471.802 353.598 471.802 DL 363.598 471.802 358.598
471.802 DL 368.598 471.802 363.598 471.802 DL 373.598 471.802 368.598 471.802
DL 378.598 471.802 373.598 471.802 DL 383.598 471.802 378.598 471.802 DL
388.598 471.802 383.598 471.802 DL 393.598 471.802 388.598 471.802 DL 398.598
471.802 393.598 471.802 DL 403.598 471.802 398.598 471.802 DL 408.598 471.802
403.598 471.802 DL 413.598 471.802 408.598 471.802 DL 418.598 471.802 413.598
471.802 DL 423.598 471.802 418.598 471.802 DL 428.598 471.802 423.598 471.802
DL 433.598 471.802 428.598 471.802 DL 438.598 471.802 433.598 471.802 DL
443.598 471.802 438.598 471.802 DL 448.598 471.802 443.598 471.802 DL 453.598
471.802 448.598 471.802 DL 458.598 471.802 453.598 471.802 DL F4
(libgai/ga_unix.c)460.848 474.302 Q/F6 8/Palatino-Bold@0 SF(Figure 1)266.34
487.802 Q(1.33)-.296 E/F7 8/Courier@0 SF(ga_unix)6 E/F8 8/Palatino-Roman@0 SF
(function.)2 E/F9 9/Courier-Bold@0 SF(ga_aistruct)129.6 515.802 Q/F10 9
/Helvetica-Bold@0 SF(creates structures)2.502 E/F11 7/Courier-Oblique@0 SF
(10\21120)104.28 530.802 Q F2 .642
(If a socket type is not speci\214ed, we call our)147.6 530.802 R F3
(ga_aistruct)3.142 E F2 .642(function twice to cr)3.142 F(eate)-.18 E(two)129.6
542.802 Q F3(addrinfo)2.968 E F2(str)2.968 E(uctur)-.08 E .468
(es: one with a socket type of)-.18 F F3(SOCK_STREAM)2.969 E F2 .469
(and another with a)2.969 F 2.534(socket type of)129.6 554.802 R F3(SOCK_DGRAM)
5.033 E F2 7.533(.B)C 2.533(ut if the caller speci\214es a nonzer)277.003
554.802 R 5.033(os)-.18 G 2.533(ocket type, our)448.464 554.802 R F3
(ga_aistruct)129.6 566.802 Q F2 .58(function is called only once, cr)3.08 F .58
(eating one)-.18 F F3(addrinfo)3.08 E F2(str)3.08 E(uctur)-.08 E 3.08(ew)-.18 G
.58(ith that)487.19 566.802 R(socket type.)129.6 578.802 Q F10
(Return canonical name)129.6 594.802 Q F11(21\21127)104.28 609.802 Q F2 .8
(If the)147.6 609.802 R F3(AI_CANONNAME)3.3 E F2 .799
(\215ag was speci\214ed by the caller)3.3 F 3.299(,w)-.74 G 3.299(ec)402.485
609.802 S(all)415.014 609.802 Q F3(uname)3.299 E F2 .799(to obtain the)3.299 F
(system name and r)129.6 621.802 Q(eturn the)-.18 E F3(nodename)2.5 E F2
(member \(Section 9.7\) as the canonical name.)2.5 E 3.392 -.92(We e)147.6
633.802 T 1.552(xplain the).92 F F3(aihead)4.052 E F2(and)4.052 E F3(aipnext)
4.052 E F2 1.552(pointers with the)4.052 F F3(ga_aistruct)4.052 E F2(function,)
4.052 E(which we describe next.)129.6 645.802 Q/F12 7/Palatino-Roman@0 SF 1.75
<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 321 49
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(321)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 10/Palatino-Roman@0 SF(Our)147.6 123 Q/F4 10
/Courier@0 SF(ga_aistruct)3.89 E F3 1.39(function was called fr)3.89 F 1.39
(om Figur)-.18 F 1.39(es 1)-.18 F 1.39(1.24 and 1)-.55 F 1.39(1.25 to cr)-.55 F
1.39(eate an)-.18 F F4(addrinfo)129.6 135 Q F3(str)4.141 E(uctur)-.08 E 4.141
(ef)-.18 G 1.641(or an IPv4 or IPv6 addr)228.902 135 R 1.641(ess, and fr)-.18 F
1.642(om Figur)-.18 F 4.142(e1)-.18 G 1.642(1.33 to cr)444.084 135 R 1.642
(eate an)-.18 F F4(addrinfo)129.6 147 Q F3(str)2.683 E(uctur)-.08 E 2.683(ef)
-.18 G .183(or a Unix domain socket.)225.986 147 R 2.023 -.92(We s)5.183 H .182
(how the \214rst part of the function in).92 F(Figur)129.6 159 Q 2.5(e1)-.18 G
(1.34.)165.17 159 Q .4 LW 134.6 172.2 129.6 172.2 DL 137.447 172.2 132.447
172.2 DL 142.447 172.2 137.447 172.2 DL 147.447 172.2 142.447 172.2 DL 152.447
172.2 147.447 172.2 DL 157.447 172.2 152.447 172.2 DL 162.447 172.2 157.447
172.2 DL 167.447 172.2 162.447 172.2 DL 172.447 172.2 167.447 172.2 DL 177.447
172.2 172.447 172.2 DL 182.447 172.2 177.447 172.2 DL 187.447 172.2 182.447
172.2 DL 192.447 172.2 187.447 172.2 DL 197.447 172.2 192.447 172.2 DL 202.447
172.2 197.447 172.2 DL 207.447 172.2 202.447 172.2 DL 212.447 172.2 207.447
172.2 DL 217.447 172.2 212.447 172.2 DL 222.447 172.2 217.447 172.2 DL 227.447
172.2 222.447 172.2 DL 232.447 172.2 227.447 172.2 DL 237.447 172.2 232.447
172.2 DL 242.447 172.2 237.447 172.2 DL 247.447 172.2 242.447 172.2 DL 252.447
172.2 247.447 172.2 DL 257.447 172.2 252.447 172.2 DL 262.447 172.2 257.447
172.2 DL 267.447 172.2 262.447 172.2 DL 272.447 172.2 267.447 172.2 DL 277.447
172.2 272.447 172.2 DL 282.447 172.2 277.447 172.2 DL 287.447 172.2 282.447
172.2 DL 292.447 172.2 287.447 172.2 DL 297.447 172.2 292.447 172.2 DL 302.447
172.2 297.447 172.2 DL 307.447 172.2 302.447 172.2 DL 312.447 172.2 307.447
172.2 DL 317.447 172.2 312.447 172.2 DL 322.447 172.2 317.447 172.2 DL 327.447
172.2 322.447 172.2 DL 332.447 172.2 327.447 172.2 DL 337.447 172.2 332.447
172.2 DL 342.447 172.2 337.447 172.2 DL 347.447 172.2 342.447 172.2 DL 352.447
172.2 347.447 172.2 DL 357.447 172.2 352.447 172.2 DL 362.447 172.2 357.447
172.2 DL 367.447 172.2 362.447 172.2 DL 372.447 172.2 367.447 172.2 DL 377.447
172.2 372.447 172.2 DL 382.447 172.2 377.447 172.2 DL 387.447 172.2 382.447
172.2 DL 392.447 172.2 387.447 172.2 DL 397.447 172.2 392.447 172.2 DL 402.447
172.2 397.447 172.2 DL 407.447 172.2 402.447 172.2 DL 412.447 172.2 407.447
172.2 DL 417.447 172.2 412.447 172.2 DL 422.447 172.2 417.447 172.2 DL 427.447
172.2 422.447 172.2 DL 432.447 172.2 427.447 172.2 DL 437.447 172.2 432.447
172.2 DL 442.447 172.2 437.447 172.2 DL 447.447 172.2 442.447 172.2 DL/F5 9
/Palatino-Italic@0 SF(libgai/ga_aistruct.c)449.697 174.7 Q/F6 8.15/Courier@0 SF
4.89(5i)139.38 181.001 S(nt)154.05 181.001 Q 4.89(6g)139.38 191.001 S
(a_aistruct\(struct addrinfo ***paipnext, const struct addrinfo *hintsp,)154.05
191.001 Q 63.57(7c)139.38 201.001 S(onst void *addr, int family\))212.73
201.001 Q 4.89(8{)139.38 211.001 S 24.45(9s)139.38 221.001 S
(truct addrinfo *ai;)173.61 221.001 Q 19.56(10 if)134.49 238.001 R 4.89(\(\()
4.89 G(ai = calloc\(1, sizeof\(struct addrinfo\)\)\) == NULL\))198.06 238.001 Q
78.24(11 return)134.49 248.001 R(\(EAI_MEMORY\);)4.89 E 19.56(12 ai->ai_next)
134.49 258.001 R 4.89(=N)4.89 G(ULL;)242.07 258.001 Q 19.56
(13 ai->ai_canonname)134.49 268.001 R 4.89(=N)4.89 G(ULL;)266.52 268.001 Q
19.56(14 **paipnext)134.49 278.001 R 4.89(=a)4.89 G(i;)237.18 278.001 Q 19.56
(15 *paipnext)134.49 288.001 R 4.89(=&)4.89 G(ai->ai_next;)232.29 288.001 Q
19.56(16 if)134.49 305.001 R 4.89(\(\()4.89 G
(ai->ai_socktype = hintsp->ai_socktype\) == 0\))198.06 305.001 Q 39.12
(17 ai->ai_flags)134.49 315.001 R(|= AI_CLONE;)4.89 E 19.56(18 ai->ai_protocol)
134.49 332.001 R 4.89(=h)4.89 G(intsp->ai_protocol;)261.63 332.001 Q 134.6
336.802 129.6 336.802 DL 137.447 336.802 132.447 336.802 DL 142.447 336.802
137.447 336.802 DL 147.447 336.802 142.447 336.802 DL 152.447 336.802 147.447
336.802 DL 157.447 336.802 152.447 336.802 DL 162.447 336.802 157.447 336.802
DL 167.447 336.802 162.447 336.802 DL 172.447 336.802 167.447 336.802 DL
177.447 336.802 172.447 336.802 DL 182.447 336.802 177.447 336.802 DL 187.447
336.802 182.447 336.802 DL 192.447 336.802 187.447 336.802 DL 197.447 336.802
192.447 336.802 DL 202.447 336.802 197.447 336.802 DL 207.447 336.802 202.447
336.802 DL 212.447 336.802 207.447 336.802 DL 217.447 336.802 212.447 336.802
DL 222.447 336.802 217.447 336.802 DL 227.447 336.802 222.447 336.802 DL
232.447 336.802 227.447 336.802 DL 237.447 336.802 232.447 336.802 DL 242.447
336.802 237.447 336.802 DL 247.447 336.802 242.447 336.802 DL 252.447 336.802
247.447 336.802 DL 257.447 336.802 252.447 336.802 DL 262.447 336.802 257.447
336.802 DL 267.447 336.802 262.447 336.802 DL 272.447 336.802 267.447 336.802
DL 277.447 336.802 272.447 336.802 DL 282.447 336.802 277.447 336.802 DL
287.447 336.802 282.447 336.802 DL 292.447 336.802 287.447 336.802 DL 297.447
336.802 292.447 336.802 DL 302.447 336.802 297.447 336.802 DL 307.447 336.802
302.447 336.802 DL 312.447 336.802 307.447 336.802 DL 317.447 336.802 312.447
336.802 DL 322.447 336.802 317.447 336.802 DL 327.447 336.802 322.447 336.802
DL 332.447 336.802 327.447 336.802 DL 337.447 336.802 332.447 336.802 DL
342.447 336.802 337.447 336.802 DL 347.447 336.802 342.447 336.802 DL 352.447
336.802 347.447 336.802 DL 357.447 336.802 352.447 336.802 DL 362.447 336.802
357.447 336.802 DL 367.447 336.802 362.447 336.802 DL 372.447 336.802 367.447
336.802 DL 377.447 336.802 372.447 336.802 DL 382.447 336.802 377.447 336.802
DL 387.447 336.802 382.447 336.802 DL 392.447 336.802 387.447 336.802 DL
397.447 336.802 392.447 336.802 DL 402.447 336.802 397.447 336.802 DL 407.447
336.802 402.447 336.802 DL 412.447 336.802 407.447 336.802 DL 417.447 336.802
412.447 336.802 DL 422.447 336.802 417.447 336.802 DL 427.447 336.802 422.447
336.802 DL 432.447 336.802 427.447 336.802 DL 437.447 336.802 432.447 336.802
DL 442.447 336.802 437.447 336.802 DL 447.447 336.802 442.447 336.802 DL F5
(libgai/ga_aistruct.c)449.697 339.302 Q/F7 8/Palatino-Bold@0 SF(Figure 1)
239.452 352.802 Q(1.34)-.296 E/F8 8/Courier@0 SF(ga_aistruct)6 E/F9 8
/Palatino-Roman@0 SF(function: \214rst part.)2 E/F10 9/Helvetica-Bold@0 SF
(Allocate)129.6 380.802 Q/F11 9/Courier-Bold@0 SF(addrinfo)2.502 E F10
(structure and ad)2.502 E 2.502(dt)-.09 G 2.502(ol)294.237 380.802 S
(inked list)304.74 380.802 Q/F12 7/Courier-Oblique@0 SF(10\21115)104.28 395.802
Q F3(An)147.6 395.802 Q F4(addrinfo)3.487 E F3(str)3.487 E(uctur)-.08 E 3.487
(ei)-.18 G 3.487(sa)262.261 395.802 S .988
(llocated and added to the linked list being built.)274.988 395.802 R -.9(Tw)
5.988 G(o).9 E 1.091(pointers ar)129.6 407.802 R 3.591(eu)-.18 G 1.091
(sed to build the linked list:)192.812 407.802 R F4(aihead)3.591 E F3(and)3.591
E F4(aipnext)3.591 E F3 6.09(.B)C 1.09(oth wer)436.31 407.802 R 3.59(ea)-.18 G
(llocated)484.72 407.802 Q .108(and initialized in Figur)129.6 419.802 R 2.609
(e1)-.18 G .109(1.20 for an IPv4 or an IPv6 socket, or in Figur)243.294 419.802
R 2.609(e1)-.18 G .109(1.33 for a Unix)454.863 419.802 R 1.54(domain socket.)
129.6 431.802 R F4(aihead)6.54 E F3 1.54(is initialized to a null pointer and)
4.04 F F4(aipnext)4.04 E F3 1.54(is initialized to)4.04 F(point to)129.6
443.802 Q F4(aihead)2.5 E F3 5(.W)C 2.5(es)219.36 443.802 S(how this in Figur)
230.89 443.802 Q 2.5(e1)-.18 G(1.35.)318.54 443.802 Q 312 480.202 MT 0 -14.4 RL
-57.6 0 RL 0 14.4 RL CL .32 LW ST F8(aihead)268.8 462.562 Q 312 545.002 MT 0
-14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aipnext)266.4 527.362 Q/F13 8
/Courier-Oblique@0 SF(NULL)314 474.762 Q 258 537.802 254.4 537.802 DL 254.4
537.802 MT -7.2 0 RL -4.8 0 -7.2 -2.4 -7.2 -7.2 RC 0 -4.8 0 -13.2 0 -25.2 RC 0
-12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 7.2 0 RL ST 254.4 473.002 MT
-5.04 1.656 RL 0 -3.384 RL CL BL 254.4 473.002 MT -5.04 1.656 RL 0 -3.384 RL CL
ST F7(Figure 1)237.692 563.002 Q(1.35)-.296 E F9
(Initialization of linked list pointers.)6 E F4(aihead)129.6 587.002 Q F3 1.144
(always points to the \214rst)3.644 F F4(addrinfo)3.645 E F3(str)3.645 E(uctur)
-.08 E 3.645(eo)-.18 G 3.645(nt)386.745 587.002 S 1.145(he linked list \(ther)
399.47 587.002 R(efor)-.18 E 3.645(ei)-.18 G(ts)512.1 587.002 Q .599
(datatype is)129.6 599.002 R F4 -2.902(struct addrinfo *)3.099 F F3(\).)A F4
(aipnext)5.598 E F3 .598(normally points to the)3.098 F F4(ai_next)3.098 E F3
(member)3.098 E .655(of the last str)129.6 611.002 R(uctur)-.08 E 3.155(eo)-.18
G 3.156(nt)225.44 611.002 S .656(he linked list \(ther)237.676 611.002 R(efor)
-.18 E 3.156(ei)-.18 G .656(ts datatype is)348.35 611.002 R F4 -2.844
(struct addrinfo **)3.156 F F3(\).)A 2.565 -.92(We u)129.6 623.002 T .725
(se the quali\214er `).92 F(`normally')-.37 E 3.225('w)-.37 G .725(ith r)
284.925 623.002 R(egar)-.18 E 3.225(dt)-.18 G(o)335.625 623.002 Q F4(aipnext)
3.225 E F3 .725(because upon initialization it)3.225 F -.18(re)129.6 635.002 S
.234(ally points to).18 F F4(aihead)2.734 E F3 2.734(,b)C .235
(ut after the \214rst str)245.926 635.002 R(uctur)-.08 E 2.735(ei)-.18 G 2.735
(sa)363.19 635.002 S .235(llocated and placed onto the list,)375.165 635.002 R
(it always points to the)129.6 647.002 Q F4(ai_next)2.5 E F3(member)2.5 E(.)
-.74 E/F14 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)
-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 322 50
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(322)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2
10/Palatino-Roman@0 SF .46(Returning to our)147.6 123 R/F3 10/Courier@0 SF
(ga_aistruct)2.96 E F2 .46(function, after a new str)2.96 F(uctur)-.08 E 2.96
(ei)-.18 G 2.96(sa)435.67 123 S .46(llocated the two)447.87 123 R(statements)
129.6 135 Q/F4 8.15/Courier@0 SF(**paipnext = ai;)147.6 151 Q
(*paipnext = &ai->ai_next;)147.6 161 Q F2(ar)129.6 179 Q 3.362(ee)-.18 G 3.362
(xecuted. The)151.312 179 R .862(\214rst statement sets the)3.362 F F3(ai_next)
3.362 E F2 .862(pointer of the last str)3.362 F(uctur)-.08 E 3.363(eo)-.18 G
3.363(nt)496.547 179 S(he)508.99 179 Q 1.095(list \(or)129.6 191 R F3(aihead)
3.595 E F2 1.095(if this new str)3.595 F(uctur)-.08 E 3.595(ei)-.18 G 3.595(st)
300.845 191 S 1.095(he \214rst on the list\) to point to the newly allo-)311.94
191 R .44(cated str)129.6 203 R(uctur)-.08 E .44
(e, and the second statement sets)-.18 F F3(aipnext)2.94 E F2 .44
(to point to the)2.94 F F3(ai_next)2.94 E F2(mem-)2.94 E 1.485
(ber of the newly allocated str)129.6 215 R(uctur)-.08 E 3.984(e. The)-.18 F
1.484(extra level of indir)3.984 F 1.484(ection is needed in both)-.18 F 1.174
(statements because the addr)129.6 227 R 1.174(ess of)-.18 F F3(aipnext)3.674 E
F2 1.175(is an ar)3.675 F 1.175(gument to the function \(see Exer)-.18 F(-)-.18
E 1.874(cise 1)129.6 239 R 4.374(1.4\). When)-.55 F 1.874(the \214rst str)4.374
F(uctur)-.08 E 4.374(ei)-.18 G 4.374(sa)297.904 239 S 1.874
(dded to the list, we have the data str)311.518 239 R(uctur)-.08 E(es)-.18 E
(shown in Figur)129.6 251 Q 2.5(e1)-.18 G(1.36.)208.58 251 Q 402 352.2 MT 0
-79.2 RL -57.6 0 RL 0 79.2 RL CL ST/F5 8/Palatino-Roman@0 SF(\214rst)366.2
304.36 Q(str)357.324 314.36 Q(uctur)-.064 E(e)-.144 E 402 352.2 MT 0 -14.4 RL
-57.6 0 RL 0 14.4 RL CL ST/F6 8/Courier@0 SF(ai_next)356.4 346.76 Q 304.8 287.4
MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aihead)261.6 269.76 Q 304.8 352.2 MT 0
-14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aipnext)259.2 334.56 Q 344.4 280.2 301.2
280.2 DL 344.4 280.2 MT -5.04 1.656 RL 0 -3.384 RL CL BL 344.4 280.2 MT -5.04
1.656 RL 0 -3.384 RL CL ST 344.4 345 301.2 345 DL 344.4 345 MT -5.04 1.656 RL 0
-3.384 RL CL BL 344.4 345 MT -5.04 1.656 RL 0 -3.384 RL CL ST/F7 8
/Courier-Bold@0 SF(addrinfo{})349.2 269.76 Q/F8 8/Courier-Oblique@0 SF(NULL)404
346.76 Q/F9 8/Palatino-Bold@0 SF(Figure 1)233.864 370.2 Q(1.36)-.296 E F5
(Linked list after \214rst str)6 E(uctur)-.064 E 2(ea)-.144 G(dded.)394.84
370.2 Q F2 .655(When our)129.6 394.2 R F3(ga_aistruct)3.155 E F2 .655
(function is called the next time to allocate a second str)3.155 F(uctur)-.08 E
(e)-.18 E(and add it to the list, we have the data str)129.6 406.2 Q(uctur)-.08
E(es shown in Figur)-.18 E 2.5(e1)-.18 G(1.37.)426.37 406.2 Q 353.4 507.4 MT 0
-79.2 RL -57.6 0 RL 0 79.2 RL CL ST F5(\214rst)317.6 459.56 Q(str)308.724
469.56 Q(uctur)-.064 E(e)-.144 E 353.4 507.4 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL
CL ST F6(ai_next)307.8 501.96 Q 450.6 507.4 MT 0 -79.2 RL -57.6 0 RL 0 79.2 RL
CL ST F5(second)409.456 459.56 Q(str)405.924 469.56 Q(uctur)-.064 E(e)-.144 E
450.6 507.4 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL ST F6(ai_next)405 501.96 Q
256.2 442.6 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aihead)213 424.96 Q 256.2
507.4 MT 0 -14.4 RL -57.6 0 RL 0 14.4 RL CL ST(aipnext)210.6 489.76 Q 295.8
435.4 252.6 435.4 DL 295.8 435.4 MT -5.04 1.656 RL 0 -3.384 RL CL BL 295.8
435.4 MT -5.04 1.656 RL 0 -3.384 RL CL ST 349.8 500.2 353.4 500.2 DL 353.4
500.2 MT 2.7 0 RL 1.8 0 5.1 0 9.9 0 RC 4.8 0 7.2 -2.4 7.2 -7.2 RC 0 -4.8 0
-13.2 0 -25.2 RC 0 -12 0 -20.4 0 -25.2 RC 0 -4.8 2.4 -7.2 7.2 -7.2 RC 4.8 0 8.1
0 9.9 0 RC 2.7 0 RL ST 393 435.4 MT -5.04 1.656 RL 0 -3.384 RL CL BL 393 435.4
MT -5.04 1.656 RL 0 -3.384 RL CL ST 256.2 500.2 252.6 500.2 DL 256.2 500.2 MT
4.932 0 RL 3.288 0 6.588 2.4 9.9 7.2 RC 3.312 4.8 6.612 9.6 9.9 14.4 RC 3.288
4.8 6.576 7.2 9.864 7.2 RC 3.288 0 14.532 0 33.732 0 RC 19.2 0 30.444 0 33.732
0 RC 3.288 0 6.576 -2.4 9.864 -7.2 RC 3.288 -4.8 6.588 -9.6 9.9 -14.4 RC 3.312
-4.8 6.624 -7.2 9.936 -7.2 RC 4.968 0 RL ST 393 500.2 MT -5.04 1.656 RL 0
-3.384 RL CL BL 393 500.2 MT -5.04 1.656 RL 0 -3.384 RL CL ST F7(addrinfo{})
300.6 424.96 Q(addrinfo{})397.8 424.96 Q F8(NULL)452.6 501.96 Q F9(Figure 1)
228.52 547 Q(1.37)-.296 E F5(Linked list after second str)6 E(uctur)-.064 E 2
(ea)-.144 G(dded.)400.184 547 Q/F10 9/Helvetica-Bold@0 SF(Set soc)129.6 575 Q
(ket type)-.18 E/F11 7/Courier-Oblique@0 SF(16\21117)104.28 590 Q F2(The)147.6
590 Q F3(ai_socktype)3.586 E F2 1.086(member is set to the socket type pr)3.586
F 1.085(ovided by the caller and if)-.18 F(this is 0, the)129.6 602 Q F3
(AI_CLONE)2.5 E F2(\215ag is set.)2.5 E(Figur)147.6 626 Q 3.714(e1)-.18 G 1.214
(1.38 shows the second part of the function: a)184.384 626 R F3(switch)3.714 E
F2 1.215(with one)3.715 F F3(case)3.715 E F2(per)3.715 E(addr)129.6 638 Q
(ess family to allocate a socket addr)-.18 E(ess str)-.18 E(uctur)-.08 E 2.5
(ea)-.18 G(nd initialize it.)366.59 638 Q/F12 7/Palatino-Roman@0 SF 1.75<a943>
233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 323 51
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(323)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL .4 LW 134.6 123 129.6 123 DL 137.447 123 132.447 123
DL 142.447 123 137.447 123 DL 147.447 123 142.447 123 DL 152.447 123 147.447
123 DL 157.447 123 152.447 123 DL 162.447 123 157.447 123 DL 167.447 123
162.447 123 DL 172.447 123 167.447 123 DL 177.447 123 172.447 123 DL 182.447
123 177.447 123 DL 187.447 123 182.447 123 DL 192.447 123 187.447 123 DL
197.447 123 192.447 123 DL 202.447 123 197.447 123 DL 207.447 123 202.447 123
DL 212.447 123 207.447 123 DL 217.447 123 212.447 123 DL 222.447 123 217.447
123 DL 227.447 123 222.447 123 DL 232.447 123 227.447 123 DL 237.447 123
232.447 123 DL 242.447 123 237.447 123 DL 247.447 123 242.447 123 DL 252.447
123 247.447 123 DL 257.447 123 252.447 123 DL 262.447 123 257.447 123 DL
267.447 123 262.447 123 DL 272.447 123 267.447 123 DL 277.447 123 272.447 123
DL 282.447 123 277.447 123 DL 287.447 123 282.447 123 DL 292.447 123 287.447
123 DL 297.447 123 292.447 123 DL 302.447 123 297.447 123 DL 307.447 123
302.447 123 DL 312.447 123 307.447 123 DL 317.447 123 312.447 123 DL 322.447
123 317.447 123 DL 327.447 123 322.447 123 DL 332.447 123 327.447 123 DL
337.447 123 332.447 123 DL 342.447 123 337.447 123 DL 347.447 123 342.447 123
DL 352.447 123 347.447 123 DL 357.447 123 352.447 123 DL 362.447 123 357.447
123 DL 367.447 123 362.447 123 DL 372.447 123 367.447 123 DL 377.447 123
372.447 123 DL 382.447 123 377.447 123 DL 387.447 123 382.447 123 DL 392.447
123 387.447 123 DL 397.447 123 392.447 123 DL 402.447 123 397.447 123 DL
407.447 123 402.447 123 DL 412.447 123 407.447 123 DL 417.447 123 412.447 123
DL 422.447 123 417.447 123 DL 427.447 123 422.447 123 DL 432.447 123 427.447
123 DL 437.447 123 432.447 123 DL 442.447 123 437.447 123 DL 447.447 123
442.447 123 DL/F3 9/Palatino-Italic@0 SF(libgai/ga_aistruct.c)449.697 125.5 Q
/F4 8.15/Courier@0 SF 19.56(19 switch)134.49 131.801 R
(\(\(ai->ai_family = family\)\) {)4.89 E 19.56(20 case)134.49 141.801 R
(AF_INET:{)4.89 E 58.68(21 struct)134.49 151.801 R(sockaddr_in *sinptr;)4.89 E
78.24(22 /*)134.49 165.801 R
(allocate sockaddr_in{} and fill in all but port */)4.89 E 58.68(23 if)134.49
175.801 R 4.89(\(\()4.89 G
(sinptr = calloc\(1, sizeof\(struct sockaddr_in\)\)\) == NULL\))237.18 175.801
Q 117.36(24 return)134.49 185.801 R(\(EAI_MEMORY\);)4.89 E(25 #ifdef)134.49
195.801 Q(HAVE_SOCKADDR_SA_LEN)9.78 E 58.68(26 sinptr->sin_len)134.49 205.801 R
4.89(=s)4.89 G(izeof\(struct sockaddr_in\);)300.75 205.801 Q(27 #endif)134.49
215.801 Q 58.68(28 sinptr->sin_family)134.49 225.801 R 4.89(=A)4.89 G(F_INET;)
315.42 225.801 Q 58.68(29 memcpy\(&sinptr->sin_addr,)134.49 235.801 R
(addr, sizeof\(struct in_addr\)\);)4.89 E 58.68(30 ai->ai_addr)134.49 245.801 R
4.89(=\()4.89 G(struct sockaddr *\) sinptr;)281.19 245.801 Q 58.68
(31 ai->ai_addrlen)134.49 255.801 R 4.89(=s)4.89 G
(izeof\(struct sockaddr_in\);)295.86 255.801 Q 58.68(32 break;)134.49 265.801 R
39.12(33 })134.49 275.801 R 19.56(34 case)134.49 285.801 R(AF_INET6:{)4.89 E
58.68(35 struct)134.49 295.801 R(sockaddr_in6 *sin6ptr;)4.89 E 78.24(36 /*)
134.49 309.801 R(allocate sockaddr_in6{} and fill in all but port */)4.89 E
58.68(37 if)134.49 319.801 R 4.89(\(\()4.89 G
(sin6ptr = calloc\(1, sizeof\(struct sockaddr_in6\)\)\) == NULL\))237.18
319.801 Q 117.36(38 return)134.49 329.801 R(\(EAI_MEMORY\);)4.89 E(39 #ifdef)
134.49 339.801 Q(HAVE_SOCKADDR_SA_LEN)9.78 E 58.68(40 sin6ptr->sin6_len)134.49
349.801 R 4.89(=s)4.89 G(izeof\(struct sockaddr_in6\);)310.53 349.801 Q
(41 #endif)134.49 359.801 Q 58.68(42 sin6ptr->sin6_family)134.49 369.801 R 4.89
(=A)4.89 G(F_INET6;)325.2 369.801 Q 58.68(43 memcpy\(&sin6ptr->sin6_addr,)
134.49 379.801 R(addr, sizeof\(struct in6_addr\)\);)4.89 E 58.68
(44 ai->ai_addr)134.49 389.801 R 4.89(=\()4.89 G(struct sockaddr *\) sin6ptr;)
281.19 389.801 Q 58.68(45 ai->ai_addrlen)134.49 399.801 R 4.89(=s)4.89 G
(izeof\(struct sockaddr_in6\);)295.86 399.801 Q 58.68(46 break;)134.49 409.801
R 39.12(47 })134.49 419.801 R 19.56(48 case)134.49 429.801 R(AF_LOCAL:{)4.89 E
58.68(49 struct)134.49 439.801 R(sockaddr_un *unp;)4.89 E 78.24(50 /*)134.49
453.801 R(allocate sockaddr_un{} and fill in */)4.89 E 58.68(51 if)134.49
463.801 R(\(strlen\(addr\) >= sizeof\(unp->sun_path\)\))4.89 E 78.24
(52 return\(EAI_SERVICE\);)134.49 473.801 R 58.68(53 if)134.49 483.801 R 4.89
(\(\()4.89 G(unp = calloc\(1, sizeof\(struct sockaddr_un\)\)\) == NULL\))237.18
483.801 Q 78.24(54 return\(EAI_MEMORY\);)134.49 493.801 R 58.68
(55 unp->sun_family)134.49 507.801 R 4.89(=A)4.89 G(F_LOCAL;)300.75 507.801 Q
58.68(56 strcpy\(unp->sun_path,)134.49 517.801 R(addr\);)4.89 E(57 #ifdef)
134.49 527.801 Q(HAVE_SOCKADDR_SA_LEN)9.78 E 58.68(58 unp->sun_len)134.49
537.801 R 4.89(=S)4.89 G(UN_LEN\(unp\);)286.08 537.801 Q(59 #endif)134.49
547.801 Q 58.68(60 ai->ai_addr)134.49 557.801 R 4.89(=\()4.89 G
(struct sockaddr *\) unp;)281.19 557.801 Q 58.68(61 ai->ai_addrlen)134.49
567.801 R 4.89(=s)4.89 G(izeof\(struct sockaddr_un\);)295.86 567.801 Q 58.68
(62 if)134.49 577.801 R(\(hintsp->ai_flags & AI_PASSIVE\))4.89 E 78.24
(63 unlink\(unp->sun_path\);)134.49 587.801 R(/* OK if this fails */)9.78 E
58.68(64 break;)134.49 597.801 R 39.12(65 })134.49 607.801 R 19.56(66 })134.49
617.801 R 19.56(67 return)134.49 627.801 R(\(0\);)4.89 E(68 })134.49 637.801 Q
134.6 642.602 129.6 642.602 DL 137.447 642.602 132.447 642.602 DL 142.447
642.602 137.447 642.602 DL 147.447 642.602 142.447 642.602 DL 152.447 642.602
147.447 642.602 DL 157.447 642.602 152.447 642.602 DL 162.447 642.602 157.447
642.602 DL 167.447 642.602 162.447 642.602 DL 172.447 642.602 167.447 642.602
DL 177.447 642.602 172.447 642.602 DL 182.447 642.602 177.447 642.602 DL
187.447 642.602 182.447 642.602 DL 192.447 642.602 187.447 642.602 DL 197.447
642.602 192.447 642.602 DL 202.447 642.602 197.447 642.602 DL 207.447 642.602
202.447 642.602 DL 212.447 642.602 207.447 642.602 DL 217.447 642.602 212.447
642.602 DL 222.447 642.602 217.447 642.602 DL 227.447 642.602 222.447 642.602
DL 232.447 642.602 227.447 642.602 DL 237.447 642.602 232.447 642.602 DL
242.447 642.602 237.447 642.602 DL 247.447 642.602 242.447 642.602 DL 252.447
642.602 247.447 642.602 DL 257.447 642.602 252.447 642.602 DL 262.447 642.602
257.447 642.602 DL 267.447 642.602 262.447 642.602 DL 272.447 642.602 267.447
642.602 DL 277.447 642.602 272.447 642.602 DL 282.447 642.602 277.447 642.602
DL 287.447 642.602 282.447 642.602 DL 292.447 642.602 287.447 642.602 DL
297.447 642.602 292.447 642.602 DL 302.447 642.602 297.447 642.602 DL 307.447
642.602 302.447 642.602 DL 312.447 642.602 307.447 642.602 DL 317.447 642.602
312.447 642.602 DL 322.447 642.602 317.447 642.602 DL 327.447 642.602 322.447
642.602 DL 332.447 642.602 327.447 642.602 DL 337.447 642.602 332.447 642.602
DL 342.447 642.602 337.447 642.602 DL 347.447 642.602 342.447 642.602 DL
352.447 642.602 347.447 642.602 DL 357.447 642.602 352.447 642.602 DL 362.447
642.602 357.447 642.602 DL 367.447 642.602 362.447 642.602 DL 372.447 642.602
367.447 642.602 DL 377.447 642.602 372.447 642.602 DL 382.447 642.602 377.447
642.602 DL 387.447 642.602 382.447 642.602 DL 392.447 642.602 387.447 642.602
DL 397.447 642.602 392.447 642.602 DL 402.447 642.602 397.447 642.602 DL
407.447 642.602 402.447 642.602 DL 412.447 642.602 407.447 642.602 DL 417.447
642.602 412.447 642.602 DL 422.447 642.602 417.447 642.602 DL 427.447 642.602
422.447 642.602 DL 432.447 642.602 427.447 642.602 DL 437.447 642.602 432.447
642.602 DL 442.447 642.602 437.447 642.602 DL 447.447 642.602 442.447 642.602
DL F3(libgai/ga_aistruct.c)449.697 645.102 Q/F5 8/Palatino-Bold@0 SF(Figure 1)
234.108 656.202 Q(1.38)-.296 E/F6 8/Courier@0 SF(ga_aistruct)6 E/F7 8
/Palatino-Roman@0 SF(function: second part.)2 E/F8 7/Palatino-Roman@0 SF 1.75
<a943>233.453 676 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)
-.126 E(eserved)-.126 E EP
%%Page: 324 52
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(324)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL/F2 9
/Helvetica-Bold@0 SF(Allocate IPv4 soc)129.6 123 Q(ket ad)-.18 E
(dress structure and initializ)-.09 E(e).09 E/F3 7/Courier-Oblique@0 SF
(20\21133)104.28 138 Q/F4 10/Palatino-Roman@0 SF(A)147.6 138 Q/F5 10/Courier@0
SF(sockaddr_in)3.264 E F4(str)3.264 E(uctur)-.08 E 3.264(ei)-.18 G 3.264(sa)
273.772 138 S .764(llocated and the)286.276 138 R F5(ai_addr)3.264 E F4 .763
(pointer in the)3.263 F F5(addrinfo)3.263 E F4(str)129.6 150 Q(uctur)-.08 E
2.686(ei)-.18 G 2.686(ss)174.886 150 S .187(et to point to it.)186.052 150 R
.187(The IP addr)5.187 F .187(ess, addr)-.18 F .187(ess family)-.18 F 2.687(,a)
-1.11 G .187(nd length members of the)405.142 150 R 2.24(socket addr)129.6 162
R 2.24(ess str)-.18 F(uctur)-.08 E 4.739(ea)-.18 G 2.599 -.18(re a)250.519 162
T 2.239(ll initialized.).18 F 2.239(The port number is not initialized until)
7.239 F F5(ga_serv)129.6 174 Q F4(is called, which in turn calls)2.5 E F5
(ga_port)2.5 E F4(.)A F2(Allocate IPv6 soc)129.6 190 Q(ket ad)-.18 E
(dress structure and initializ)-.09 E(e).09 E F3(34\21147)104.28 205 Q F4(A)
147.6 205 Q F5(sockaddr_in6)2.5 E F4(str)2.5 E(uctur)-.08 E 2.5(ei)-.18 G 2.5
(sa)277.48 205 S(llocated and initialized, similar to the IPv4 case.)289.22 205
Q F2(Allocate Unix domain soc)129.6 221 Q(ket ad)-.18 E
(dress structure and initializ)-.09 E(e).09 E F3(48\21165)104.28 236 Q F4(A)
147.6 236 Q F5(sockaddr_un)3.396 E F4(str)3.396 E(uctur)-.08 E 3.396(ei)-.18 G
3.396(sa)274.168 236 S .896(llocated and initialized.)286.804 236 R .897
(The addr)5.896 F .897(ess is a pathname)-.18 F .144(and if the)129.6 248 R F5
(AI_PASSIVE)2.644 E F4 .144(\215ag was speci\214ed by the caller)2.644 F 2.644
(,w)-.74 G 2.644(et)385.7 248 S .144(ry to)396.394 248 R F5(unlink)2.644 E F4
.144(the pathname)2.644 F 2.181(to pr)129.6 260 R 2.181(event an err)-.18 F
2.181(or r)-.18 F 2.181(eturn when the caller calls)-.18 F F5(bind)4.681 E F4
7.181(.B)C 2.181(ut it is not an err)396.83 260 R 2.182(or if the)-.18 F F5
(unlink)129.6 272 Q F4(fails.)2.5 E(Our)147.6 296 Q F5(ga_echeck)4.332 E F4
1.832(function, which we show in Figur)4.332 F 4.332(e1)-.18 G 1.831
(1.39, was called fr)399.786 296 R 1.831(om Fig-)-.18 F(ur)129.6 308 Q 2.5(e1)
-.18 G(1.20 to perform some initial err)151.14 308 Q(or checking on the caller)
-.18 E('s ar).74 E(guments.)-.18 E .4 LW 134.6 321.2 129.6 321.2 DL 137.784
321.2 132.784 321.2 DL 142.784 321.2 137.784 321.2 DL 147.784 321.2 142.784
321.2 DL 152.784 321.2 147.784 321.2 DL 157.784 321.2 152.784 321.2 DL 162.784
321.2 157.784 321.2 DL 167.784 321.2 162.784 321.2 DL 172.784 321.2 167.784
321.2 DL 177.784 321.2 172.784 321.2 DL 182.784 321.2 177.784 321.2 DL 187.784
321.2 182.784 321.2 DL 192.784 321.2 187.784 321.2 DL 197.784 321.2 192.784
321.2 DL 202.784 321.2 197.784 321.2 DL 207.784 321.2 202.784 321.2 DL 212.784
321.2 207.784 321.2 DL 217.784 321.2 212.784 321.2 DL 222.784 321.2 217.784
321.2 DL 227.784 321.2 222.784 321.2 DL 232.784 321.2 227.784 321.2 DL 237.784
321.2 232.784 321.2 DL 242.784 321.2 237.784 321.2 DL 247.784 321.2 242.784
321.2 DL 252.784 321.2 247.784 321.2 DL 257.784 321.2 252.784 321.2 DL 262.784
321.2 257.784 321.2 DL 267.784 321.2 262.784 321.2 DL 272.784 321.2 267.784
321.2 DL 277.784 321.2 272.784 321.2 DL 282.784 321.2 277.784 321.2 DL 287.784
321.2 282.784 321.2 DL 292.784 321.2 287.784 321.2 DL 297.784 321.2 292.784
321.2 DL 302.784 321.2 297.784 321.2 DL 307.784 321.2 302.784 321.2 DL 312.784
321.2 307.784 321.2 DL 317.784 321.2 312.784 321.2 DL 322.784 321.2 317.784
321.2 DL 327.784 321.2 322.784 321.2 DL 332.784 321.2 327.784 321.2 DL 337.784
321.2 332.784 321.2 DL 342.784 321.2 337.784 321.2 DL 347.784 321.2 342.784
321.2 DL 352.784 321.2 347.784 321.2 DL 357.784 321.2 352.784 321.2 DL 362.784
321.2 357.784 321.2 DL 367.784 321.2 362.784 321.2 DL 372.784 321.2 367.784
321.2 DL 377.784 321.2 372.784 321.2 DL 382.784 321.2 377.784 321.2 DL 387.784
321.2 382.784 321.2 DL 392.784 321.2 387.784 321.2 DL 397.784 321.2 392.784
321.2 DL 402.784 321.2 397.784 321.2 DL 407.784 321.2 402.784 321.2 DL 412.784
321.2 407.784 321.2 DL 417.784 321.2 412.784 321.2 DL 422.784 321.2 417.784
321.2 DL 427.784 321.2 422.784 321.2 DL 432.784 321.2 427.784 321.2 DL 437.784
321.2 432.784 321.2 DL 442.784 321.2 437.784 321.2 DL 447.784 321.2 442.784
321.2 DL 452.784 321.2 447.784 321.2 DL/F6 9/Palatino-Italic@0 SF
(libgai/ga_echeck.c)455.034 323.7 Q/F7 8.15/Courier@0 SF 4.89(5i)139.38 330.001
S(nt)154.05 330.001 Q 4.89(6g)139.38 340.001 S
(a_echeck\(const char *hostname, const char *servname,)154.05 340.001 Q 53.79
(7i)139.38 350.001 S(nt flags, int family, int socktype, int protocol\))202.95
350.001 Q 4.89(8{)139.38 360.001 S 24.45(9i)139.38 370.001 S 4.89(f\()173.61
370.001 S(flags & ~\(AI_PASSIVE | AI_CANONNAME\)\))188.28 370.001 Q 39.12
(10 return)134.49 380.001 R 4.89(\(EAI_BADFLAGS\); /*)4.89 F
(unknown flag bits */)4.89 E 19.56(11 if)134.49 397.001 R
(\(hostname == NULL || hostname[0] == '\\0'\) {)4.89 E 39.12(12 if)134.49
407.001 R(\(servname == NULL || servname[0] == '\\0'\))4.89 E 58.68(13 return)
134.49 417.001 R 14.67(\(EAI_NONAME\); /*)4.89 F
(host or service must be specified */)4.89 E 19.56(14 })134.49 427.001 R 19.56
(15 switch)134.49 437.001 R(\(family\) {)4.89 E 19.56(16 case)134.49 447.001 R
(AF_UNSPEC:)4.89 E 39.12(17 break;)134.49 457.001 R 19.56(18 case)134.49
467.001 R(AF_INET:)4.89 E 39.12(19 if)134.49 477.001 R(\(socktype != 0 &&)4.89
E 58.68(20 \(socktype)134.49 487.001 R(!= SOCK_STREAM &&)4.89 E 63.57
(21 socktype)134.49 497.001 R(!= SOCK_DGRAM &&)4.89 E 63.57(22 socktype)134.49
507.001 R(!= SOCK_RAW\)\))4.89 E 58.68(23 return)134.49 517.001 R 4.89
(\(EAI_SOCKTYPE\); /*)4.89 F(invalid socket type */)4.89 E 39.12(24 break;)
134.49 527.001 R 19.56(25 case)134.49 537.001 R(AF_INET6:)4.89 E 39.12(26 if)
134.49 547.001 R(\(socktype != 0 &&)4.89 E 58.68(27 \(socktype)134.49 557.001 R
(!= SOCK_STREAM &&)4.89 E 63.57(28 socktype)134.49 567.001 R(!= SOCK_DGRAM &&)
4.89 E 63.57(29 socktype)134.49 577.001 R(!= SOCK_RAW\)\))4.89 E 58.68
(30 return)134.49 587.001 R 4.89(\(EAI_SOCKTYPE\); /*)4.89 F
(invalid socket type */)4.89 E 39.12(31 break;)134.49 597.001 R 19.56(32 case)
134.49 607.001 R(AF_LOCAL:)4.89 E 39.12(33 if)134.49 617.001 R
(\(socktype != 0 &&)4.89 E 58.68(34 \(socktype)134.49 627.001 R
(!= SOCK_STREAM &&)4.89 E 63.57(35 socktype)134.49 637.001 R(!= SOCK_DGRAM\)\))
4.89 E 58.68(36 return)134.49 647.001 R 4.89(\(EAI_SOCKTYPE\); /*)4.89 F
(invalid socket type */)4.89 E 39.12(37 break;)134.49 657.001 R/F8 7
/Palatino-Roman@0 SF 1.75<a943>233.453 676 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 325 53
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(325)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 8.15/Courier@0 SF 19.56(38 default:)134.49 121 R
39.12(39 return)134.49 131 R 14.67(\(EAI_FAMILY\); /*)4.89 F
(unknown protocol family */)4.89 E 19.56(40 })134.49 141 R 19.56(41 return)
134.49 151 R(\(0\);)4.89 E(42 })134.49 161 Q .4 LW 134.6 165.801 129.6 165.801
DL 137.784 165.801 132.784 165.801 DL 142.784 165.801 137.784 165.801 DL
147.784 165.801 142.784 165.801 DL 152.784 165.801 147.784 165.801 DL 157.784
165.801 152.784 165.801 DL 162.784 165.801 157.784 165.801 DL 167.784 165.801
162.784 165.801 DL 172.784 165.801 167.784 165.801 DL 177.784 165.801 172.784
165.801 DL 182.784 165.801 177.784 165.801 DL 187.784 165.801 182.784 165.801
DL 192.784 165.801 187.784 165.801 DL 197.784 165.801 192.784 165.801 DL
202.784 165.801 197.784 165.801 DL 207.784 165.801 202.784 165.801 DL 212.784
165.801 207.784 165.801 DL 217.784 165.801 212.784 165.801 DL 222.784 165.801
217.784 165.801 DL 227.784 165.801 222.784 165.801 DL 232.784 165.801 227.784
165.801 DL 237.784 165.801 232.784 165.801 DL 242.784 165.801 237.784 165.801
DL 247.784 165.801 242.784 165.801 DL 252.784 165.801 247.784 165.801 DL
257.784 165.801 252.784 165.801 DL 262.784 165.801 257.784 165.801 DL 267.784
165.801 262.784 165.801 DL 272.784 165.801 267.784 165.801 DL 277.784 165.801
272.784 165.801 DL 282.784 165.801 277.784 165.801 DL 287.784 165.801 282.784
165.801 DL 292.784 165.801 287.784 165.801 DL 297.784 165.801 292.784 165.801
DL 302.784 165.801 297.784 165.801 DL 307.784 165.801 302.784 165.801 DL
312.784 165.801 307.784 165.801 DL 317.784 165.801 312.784 165.801 DL 322.784
165.801 317.784 165.801 DL 327.784 165.801 322.784 165.801 DL 332.784 165.801
327.784 165.801 DL 337.784 165.801 332.784 165.801 DL 342.784 165.801 337.784
165.801 DL 347.784 165.801 342.784 165.801 DL 352.784 165.801 347.784 165.801
DL 357.784 165.801 352.784 165.801 DL 362.784 165.801 357.784 165.801 DL
367.784 165.801 362.784 165.801 DL 372.784 165.801 367.784 165.801 DL 377.784
165.801 372.784 165.801 DL 382.784 165.801 377.784 165.801 DL 387.784 165.801
382.784 165.801 DL 392.784 165.801 387.784 165.801 DL 397.784 165.801 392.784
165.801 DL 402.784 165.801 397.784 165.801 DL 407.784 165.801 402.784 165.801
DL 412.784 165.801 407.784 165.801 DL 417.784 165.801 412.784 165.801 DL
422.784 165.801 417.784 165.801 DL 427.784 165.801 422.784 165.801 DL 432.784
165.801 427.784 165.801 DL 437.784 165.801 432.784 165.801 DL 442.784 165.801
437.784 165.801 DL 447.784 165.801 442.784 165.801 DL 452.784 165.801 447.784
165.801 DL/F4 9/Palatino-Italic@0 SF(libgai/ga_echeck.c)455.034 168.301 Q/F5 8
/Palatino-Bold@0 SF(Figure 1)261.54 181.801 Q(1.39)-.296 E/F6 8/Courier@0 SF
(ga_echeck)6 E/F7 8/Palatino-Roman@0 SF(function.)2 E/F8 7/Courier-Oblique@0 SF
(9\21114)108.48 205.801 Q/F9 10/Palatino-Roman@0 SF(The \215ags ar)147.6
205.801 Q 2.5(ev)-.18 G
(eri\214ed and either a hostname or a service name must be speci\214ed.)211.93
205.801 Q F8(15\21141)104.28 217.801 Q F9 .808(Depending on the addr)147.6
217.801 R .808(ess family)-.18 F 3.308(,o)-1.11 G .808
(nly certain types of sockets ar)308.49 217.801 R 3.309(es)-.18 G .809
(upported, and)455.241 217.801 R(this veri\214es the socket type.)129.6 229.801
Q 2.423 -.92(We d)147.6 241.801 T 3.083(on).92 G .583(ot check the caller)
185.026 241.801 R('s).74 E/F10 10/Courier@0 SF(ai_protocol)3.082 E F9 .582
(hint, if any)3.082 F 3.082(,a)-1.11 G 3.082(sf)404.404 241.801 S .582
(ew applications specify)415.056 241.801 R 1.001
(this value \(which becomes the thir)129.6 253.801 R 3.502(da)-.18 G -.18(rg)
300.698 253.801 S 1.002(ument to socket\).).18 F 1.002
(Should an invalid combina-)6.002 F 5.344
(tion be speci\214ed, such as a socket type of)129.6 265.801 R F10(SOCK_DGRAM)
7.844 E F9 5.344(and a pr)7.844 F 5.343(otocol of)-.18 F F10(IPPROTO_TCP)129.6
277.801 Q F9 2.696(,t)C .196(he pr)204.056 277.801 R .196(otocol hint is r)-.18
F .197(eturned to the caller in Figur)-.18 F 2.697(e1)-.18 G .197
(1.34 and if the caller)430.272 277.801 R(uses this value in a call to)129.6
289.801 Q F10(socket)2.5 E F9 2.5(,a)C 2.5(ne)290.72 289.801 S(rr)303.83
289.801 Q(or of)-.18 E F10(EPROTONOSUPPORT)2.5 E F9(will be r)2.5 E(eturned.)
-.18 E 3.338 -.92(We h)147.6 313.801 T 1.498(ave \214nished with the).92 F F10
(getaddrinfo)3.997 E F9 1.497(function, and all the internal functions)3.997 F
1.777(that it calls.)129.6 325.801 R(Figur)6.777 E 4.277(e1)-.18 G 1.777
(1.40 shows the)227.788 325.801 R F10(freeaddrinfo)4.278 E F9 1.778
(function, which r)4.278 F 1.778(eleases all the)-.18 F .02
(memory in the linked list.)129.6 337.801 R 1.86 -.92(We c)5.02 H .02
(alled this function fr).92 F .02(om Figur)-.18 F 2.52(e1)-.18 G .02
(1.26 if an err)411.55 337.801 R .02(or occurr)-.18 F(ed,)-.18 E
(and the user also calls it to r)129.6 349.801 Q(elease a linked list of str)
-.18 E(uctur)-.08 E(es.)-.18 E 134.6 363.001 129.6 363.001 DL 135.26 363.001
130.26 363.001 DL 140.26 363.001 135.26 363.001 DL 145.26 363.001 140.26
363.001 DL 150.26 363.001 145.26 363.001 DL 155.26 363.001 150.26 363.001 DL
160.26 363.001 155.26 363.001 DL 165.26 363.001 160.26 363.001 DL 170.26
363.001 165.26 363.001 DL 175.26 363.001 170.26 363.001 DL 180.26 363.001
175.26 363.001 DL 185.26 363.001 180.26 363.001 DL 190.26 363.001 185.26
363.001 DL 195.26 363.001 190.26 363.001 DL 200.26 363.001 195.26 363.001 DL
205.26 363.001 200.26 363.001 DL 210.26 363.001 205.26 363.001 DL 215.26
363.001 210.26 363.001 DL 220.26 363.001 215.26 363.001 DL 225.26 363.001
220.26 363.001 DL 230.26 363.001 225.26 363.001 DL 235.26 363.001 230.26
363.001 DL 240.26 363.001 235.26 363.001 DL 245.26 363.001 240.26 363.001 DL
250.26 363.001 245.26 363.001 DL 255.26 363.001 250.26 363.001 DL 260.26
363.001 255.26 363.001 DL 265.26 363.001 260.26 363.001 DL 270.26 363.001
265.26 363.001 DL 275.26 363.001 270.26 363.001 DL 280.26 363.001 275.26
363.001 DL 285.26 363.001 280.26 363.001 DL 290.26 363.001 285.26 363.001 DL
295.26 363.001 290.26 363.001 DL 300.26 363.001 295.26 363.001 DL 305.26
363.001 300.26 363.001 DL 310.26 363.001 305.26 363.001 DL 315.26 363.001
310.26 363.001 DL 320.26 363.001 315.26 363.001 DL 325.26 363.001 320.26
363.001 DL 330.26 363.001 325.26 363.001 DL 335.26 363.001 330.26 363.001 DL
340.26 363.001 335.26 363.001 DL 345.26 363.001 340.26 363.001 DL 350.26
363.001 345.26 363.001 DL 355.26 363.001 350.26 363.001 DL 360.26 363.001
355.26 363.001 DL 365.26 363.001 360.26 363.001 DL 370.26 363.001 365.26
363.001 DL 375.26 363.001 370.26 363.001 DL 380.26 363.001 375.26 363.001 DL
385.26 363.001 380.26 363.001 DL 390.26 363.001 385.26 363.001 DL 395.26
363.001 390.26 363.001 DL 400.26 363.001 395.26 363.001 DL 405.26 363.001
400.26 363.001 DL 410.26 363.001 405.26 363.001 DL 415.26 363.001 410.26
363.001 DL 420.26 363.001 415.26 363.001 DL 425.26 363.001 420.26 363.001 DL
430.26 363.001 425.26 363.001 DL 435.26 363.001 430.26 363.001 DL 440.26
363.001 435.26 363.001 DL 445.26 363.001 440.26 363.001 DL F4(libgai/fr)447.51
365.501 Q(eeaddrinfo.c)-.162 E F3 4.89(1#)139.38 371.802 S 14.67
(include "gai_hdr.h")154.05 371.802 R 4.89(2v)139.38 388.802 S(oid)154.05
388.802 Q 4.89(3f)139.38 398.802 S(reeaddrinfo\(struct addrinfo *aihead\))
154.05 398.802 Q 4.89(4{)139.38 408.802 S 24.45(5s)139.38 418.802 S
(truct addrinfo *ai, *ainext;)173.61 418.802 Q 24.45(6f)139.38 435.802 S
(or \(ai = aihead; ai != NULL; ai = ainext\) {)173.61 435.802 Q 44.01(7i)139.38
445.802 S 4.89(f\()193.17 445.802 S(ai->ai_addr != NULL\))207.84 445.802 Q
63.57(8f)139.38 455.802 S 4.89(ree\(ai->ai_addr\); /*)212.73 455.802 R
(socket address structure */)4.89 E 44.01(9i)139.38 472.802 S 4.89(f\()193.17
472.802 S(ai->ai_canonname != NULL\))207.84 472.802 Q 58.68
(10 free\(ai->ai_canonname\);)134.49 482.802 R 39.12(11 ainext)134.49 499.802 R
4.89(=a)4.89 G 9.78(i->ai_next; /*)237.18 499.802 R
(can't fetch ai_next after free\(\) */)4.89 E 39.12(12 free\(ai\);)134.49
509.802 R(/* the addrinfo{} itself */)305.64 509.802 Q 19.56(13 })134.49
519.802 R(14 })134.49 529.802 Q 134.6 534.603 129.6 534.603 DL 135.26 534.603
130.26 534.603 DL 140.26 534.603 135.26 534.603 DL 145.26 534.603 140.26
534.603 DL 150.26 534.603 145.26 534.603 DL 155.26 534.603 150.26 534.603 DL
160.26 534.603 155.26 534.603 DL 165.26 534.603 160.26 534.603 DL 170.26
534.603 165.26 534.603 DL 175.26 534.603 170.26 534.603 DL 180.26 534.603
175.26 534.603 DL 185.26 534.603 180.26 534.603 DL 190.26 534.603 185.26
534.603 DL 195.26 534.603 190.26 534.603 DL 200.26 534.603 195.26 534.603 DL
205.26 534.603 200.26 534.603 DL 210.26 534.603 205.26 534.603 DL 215.26
534.603 210.26 534.603 DL 220.26 534.603 215.26 534.603 DL 225.26 534.603
220.26 534.603 DL 230.26 534.603 225.26 534.603 DL 235.26 534.603 230.26
534.603 DL 240.26 534.603 235.26 534.603 DL 245.26 534.603 240.26 534.603 DL
250.26 534.603 245.26 534.603 DL 255.26 534.603 250.26 534.603 DL 260.26
534.603 255.26 534.603 DL 265.26 534.603 260.26 534.603 DL 270.26 534.603
265.26 534.603 DL 275.26 534.603 270.26 534.603 DL 280.26 534.603 275.26
534.603 DL 285.26 534.603 280.26 534.603 DL 290.26 534.603 285.26 534.603 DL
295.26 534.603 290.26 534.603 DL 300.26 534.603 295.26 534.603 DL 305.26
534.603 300.26 534.603 DL 310.26 534.603 305.26 534.603 DL 315.26 534.603
310.26 534.603 DL 320.26 534.603 315.26 534.603 DL 325.26 534.603 320.26
534.603 DL 330.26 534.603 325.26 534.603 DL 335.26 534.603 330.26 534.603 DL
340.26 534.603 335.26 534.603 DL 345.26 534.603 340.26 534.603 DL 350.26
534.603 345.26 534.603 DL 355.26 534.603 350.26 534.603 DL 360.26 534.603
355.26 534.603 DL 365.26 534.603 360.26 534.603 DL 370.26 534.603 365.26
534.603 DL 375.26 534.603 370.26 534.603 DL 380.26 534.603 375.26 534.603 DL
385.26 534.603 380.26 534.603 DL 390.26 534.603 385.26 534.603 DL 395.26
534.603 390.26 534.603 DL 400.26 534.603 395.26 534.603 DL 405.26 534.603
400.26 534.603 DL 410.26 534.603 405.26 534.603 DL 415.26 534.603 410.26
534.603 DL 420.26 534.603 415.26 534.603 DL 425.26 534.603 420.26 534.603 DL
430.26 534.603 425.26 534.603 DL 435.26 534.603 430.26 534.603 DL 440.26
534.603 435.26 534.603 DL 445.26 534.603 440.26 534.603 DL F4(libgai/fr)447.51
537.103 Q(eeaddrinfo.c)-.162 E F5(Figure 1)237.052 550.603 Q(1.40)-.296 E F6
(freeaddrinfo)6 E F7(function: \214rst part.)2 E F8(6\21113)108.48 574.603 Q F9
1.319(The linked list of)147.6 574.603 R F10(addrinfo)3.819 E F9(str)3.819 E
(uctur)-.08 E 1.319(es is traversed.)-.18 F 1.319(If a socket addr)6.319 F 1.32
(ess str)-.18 F(uctur)-.08 E(e)-.18 E .617(has been allocated, it is fr)129.6
586.603 R 3.116(eed. If)-.18 F 3.116(ac)3.116 G .616
(anonical name string has been allocated, it is fr)290.152 586.603 R(eed.)-.18
E(Finally)129.6 598.603 Q 3.13(,t)-1.11 G(he)168.05 598.603 Q F10(addrinfo)3.13
E F9(str)3.13 E(uctur)-.08 E 3.13(ei)-.18 G .63(tself is fr)278.65 598.603 R
3.13(eed. W)-.18 F 3.13(em)-.92 G .63(ust be car)367.34 598.603 R .63
(eful to save the contents)-.18 F .773(of the str)129.6 610.603 R(uctur)-.08 E
(e's)-.18 E F10(ai_next)3.273 E F9 .773(pointer befor)3.273 F 3.273(ef)-.18 G
-.18(re)323.808 610.603 S .772(eing the str).18 F(uctur)-.08 E .772
(e, as we cannot r)-.18 F(efer)-.18 E(ence)-.18 E(the str)129.6 622.603 Q
(uctur)-.08 E 2.5(ea)-.18 G(fter)193.16 622.603 Q F10(free)2.5 E F9 -.18(re)2.5
G(turns.).18 E(Figur)147.6 646.603 Q 3.532(e1)-.18 G 1.032
(1.41 shows our implementation of the)184.202 646.603 R F10(getnameinfo)3.532 E
F9 3.532(function. It)3.532 F(consists)3.532 E(of a)129.6 658.603 Q F10(switch)
2.5 E F9(statement with one)2.5 E F10(case)2.5 E F9(per addr)2.5 E(ess family)
-.18 E(.)-1.11 E/F11 7/Palatino-Roman@0 SF 1.75<a943>233.453 678 S
(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E(eserved)
-.126 E EP
%%Page: 326 54
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(326)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 123 129.6 123 DL 139.099 123 134.099 123 DL 144.099 123 139.099 123 DL
149.099 123 144.099 123 DL 154.099 123 149.099 123 DL 159.099 123 154.099 123
DL 164.099 123 159.099 123 DL 169.099 123 164.099 123 DL 174.099 123 169.099
123 DL 179.099 123 174.099 123 DL 184.099 123 179.099 123 DL 189.099 123
184.099 123 DL 194.099 123 189.099 123 DL 199.099 123 194.099 123 DL 204.099
123 199.099 123 DL 209.099 123 204.099 123 DL 214.099 123 209.099 123 DL
219.099 123 214.099 123 DL 224.099 123 219.099 123 DL 229.099 123 224.099 123
DL 234.099 123 229.099 123 DL 239.099 123 234.099 123 DL 244.099 123 239.099
123 DL 249.099 123 244.099 123 DL 254.099 123 249.099 123 DL 259.099 123
254.099 123 DL 264.099 123 259.099 123 DL 269.099 123 264.099 123 DL 274.099
123 269.099 123 DL 279.099 123 274.099 123 DL 284.099 123 279.099 123 DL
289.099 123 284.099 123 DL 294.099 123 289.099 123 DL 299.099 123 294.099 123
DL 304.099 123 299.099 123 DL 309.099 123 304.099 123 DL 314.099 123 309.099
123 DL 319.099 123 314.099 123 DL 324.099 123 319.099 123 DL 329.099 123
324.099 123 DL 334.099 123 329.099 123 DL 339.099 123 334.099 123 DL 344.099
123 339.099 123 DL 349.099 123 344.099 123 DL 354.099 123 349.099 123 DL
359.099 123 354.099 123 DL 364.099 123 359.099 123 DL 369.099 123 364.099 123
DL 374.099 123 369.099 123 DL 379.099 123 374.099 123 DL 384.099 123 379.099
123 DL 389.099 123 384.099 123 DL 394.099 123 389.099 123 DL 399.099 123
394.099 123 DL 404.099 123 399.099 123 DL 409.099 123 404.099 123 DL 414.099
123 409.099 123 DL 419.099 123 414.099 123 DL 424.099 123 419.099 123 DL
429.099 123 424.099 123 DL 434.099 123 429.099 123 DL 439.099 123 434.099 123
DL 444.099 123 439.099 123 DL/F2 9/Palatino-Italic@0 SF(libgai/getnameinfo.c)
446.349 125.5 Q/F3 8.15/Courier@0 SF 4.89(2i)139.38 131.801 S(nt)154.05 131.801
Q 4.89(3g)139.38 141.801 S
(etnameinfo\(const struct sockaddr *sa, socklen_t salen,)154.05 141.801 Q 63.57
(4c)139.38 151.801 S(har *host, size_t hostlen,)212.73 151.801 Q 63.57(5c)
139.38 161.801 S(har *serv, size_t servlen, int flags\))212.73 161.801 Q 4.89
(6{)139.38 171.801 S 24.45(7s)139.38 188.801 S(witch \(sa->sa_family\) {)173.61
188.801 Q 24.45(8c)139.38 198.801 S(ase AF_INET:{)173.61 198.801 Q 63.57(9s)
139.38 208.801 S(truct sockaddr_in *sain = \(struct sockaddr_in *\) sa;)212.73
208.801 Q 58.68(10 return)134.49 225.801 R
(\(gn_ipv46\(host, hostlen, serv, servlen,)4.89 E 141.81(11 &sain->sin_addr,)
134.49 235.801 R(sizeof\(struct in_addr\),)4.89 E 141.81(12 AF_INET,)134.49
245.801 R(sain->sin_port, flags\)\);)4.89 E 39.12(13 })134.49 255.801 R 19.56
(14 case)134.49 272.801 R(AF_INET6:{)4.89 E 58.68(15 struct)134.49 282.801 R
(sockaddr_in6 *sain = \(struct sockaddr_in6 *\) sa;)4.89 E 58.68(16 return)
134.49 299.801 R(\(gn_ipv46\(host, hostlen, serv, servlen,)4.89 E 141.81
(17 &sain->sin6_addr,)134.49 309.801 R(sizeof\(struct in6_addr\),)4.89 E 141.81
(18 AF_INET6,)134.49 319.801 R(sain->sin6_port, flags\)\);)4.89 E 39.12(19 })
134.49 329.801 R 19.56(20 case)134.49 346.801 R(AF_LOCAL:{)4.89 E 58.68
(21 struct)134.49 356.801 R(sockaddr_un *un = \(struct sockaddr_un *\) sa;)4.89
E 58.68(22 if)134.49 373.801 R(\(hostlen > 0\))4.89 E 78.24(23 snprintf\(host,)
134.49 383.801 R(hostlen, "%s", "/local"\);)4.89 E 58.68(24 if)134.49 393.801 R
(\(servlen > 0\))4.89 E 78.24(25 snprintf\(serv,)134.49 403.801 R
(servlen, "%s", un->sun_path\);)4.89 E 58.68(26 return)134.49 413.801 R(\(0\);)
4.89 E 39.12(27 })134.49 423.801 R 19.56(28 default:)134.49 440.801 R 39.12
(29 return)134.49 450.801 R(\(1\);)4.89 E 19.56(30 })134.49 460.801 R(31 })
134.49 470.801 Q 134.6 475.602 129.6 475.602 DL 139.099 475.602 134.099 475.602
DL 144.099 475.602 139.099 475.602 DL 149.099 475.602 144.099 475.602 DL
154.099 475.602 149.099 475.602 DL 159.099 475.602 154.099 475.602 DL 164.099
475.602 159.099 475.602 DL 169.099 475.602 164.099 475.602 DL 174.099 475.602
169.099 475.602 DL 179.099 475.602 174.099 475.602 DL 184.099 475.602 179.099
475.602 DL 189.099 475.602 184.099 475.602 DL 194.099 475.602 189.099 475.602
DL 199.099 475.602 194.099 475.602 DL 204.099 475.602 199.099 475.602 DL
209.099 475.602 204.099 475.602 DL 214.099 475.602 209.099 475.602 DL 219.099
475.602 214.099 475.602 DL 224.099 475.602 219.099 475.602 DL 229.099 475.602
224.099 475.602 DL 234.099 475.602 229.099 475.602 DL 239.099 475.602 234.099
475.602 DL 244.099 475.602 239.099 475.602 DL 249.099 475.602 244.099 475.602
DL 254.099 475.602 249.099 475.602 DL 259.099 475.602 254.099 475.602 DL
264.099 475.602 259.099 475.602 DL 269.099 475.602 264.099 475.602 DL 274.099
475.602 269.099 475.602 DL 279.099 475.602 274.099 475.602 DL 284.099 475.602
279.099 475.602 DL 289.099 475.602 284.099 475.602 DL 294.099 475.602 289.099
475.602 DL 299.099 475.602 294.099 475.602 DL 304.099 475.602 299.099 475.602
DL 309.099 475.602 304.099 475.602 DL 314.099 475.602 309.099 475.602 DL
319.099 475.602 314.099 475.602 DL 324.099 475.602 319.099 475.602 DL 329.099
475.602 324.099 475.602 DL 334.099 475.602 329.099 475.602 DL 339.099 475.602
334.099 475.602 DL 344.099 475.602 339.099 475.602 DL 349.099 475.602 344.099
475.602 DL 354.099 475.602 349.099 475.602 DL 359.099 475.602 354.099 475.602
DL 364.099 475.602 359.099 475.602 DL 369.099 475.602 364.099 475.602 DL
374.099 475.602 369.099 475.602 DL 379.099 475.602 374.099 475.602 DL 384.099
475.602 379.099 475.602 DL 389.099 475.602 384.099 475.602 DL 394.099 475.602
389.099 475.602 DL 399.099 475.602 394.099 475.602 DL 404.099 475.602 399.099
475.602 DL 409.099 475.602 404.099 475.602 DL 414.099 475.602 409.099 475.602
DL 419.099 475.602 414.099 475.602 DL 424.099 475.602 419.099 475.602 DL
429.099 475.602 424.099 475.602 DL 434.099 475.602 429.099 475.602 DL 439.099
475.602 434.099 475.602 DL 444.099 475.602 439.099 475.602 DL F2
(libgai/getnameinfo.c)446.349 478.102 Q/F4 8/Palatino-Bold@0 SF(Figure 1)256.74
491.602 Q(1.41)-.296 E/F5 8/Courier@0 SF(getnameinfo)6 E/F6 8/Palatino-Roman@0
SF(function.)2 E/F7 9/Helvetica-Bold@0 SF(Handle IPv4 and IPv6 soc)129.6
519.602 Q(ket ad)-.18 E(dress structures)-.09 E/F8 7/Courier-Oblique@0 SF
(8\21119)108.48 534.602 Q/F9 10/Palatino-Roman@0 SF 4.592 -.92(We c)147.6
534.602 T 2.752(all our).92 F/F10 10/Courier@0 SF(gn_ipv46)5.252 E F9 2.752
(function \(shown next\) to handle IPv4 and IPv6 socket)5.252 F(addr)129.6
546.602 Q(ess str)-.18 E(uctur)-.08 E(es.)-.18 E F7(Handle Unix domain soc)
129.6 562.602 Q(ket ad)-.18 E(dress structures)-.09 E F8(20\21127)104.28
577.602 Q F9 .155(For a Unix domain socket addr)147.6 577.602 R .155(ess str)
-.18 F(uctur)-.08 E 2.655(ew)-.18 G 2.655(er)351.995 577.602 S(eturn)363.21
577.602 Q F10(/local)2.656 E F9 .156(as the hostname and)2.656 F .368
(the pathname that is bound to the socket as the service name.)129.6 589.602 R
.368(If no pathname is bound)5.368 F(to the socket, then the r)129.6 601.602 Q
(eturned service name will be a null string.)-.18 E/F11 7/Palatino-Roman@0 SF
1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 327 55
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Section 1)93.6 82 Q 73.92(1.16 Implementation)-.495 F
(of)4.5 E/F1 9/Courier@0 SF(getaddrinfo)4.5 E F0(and)4.5 E F1(getnameinfo)4.5 E
F0(Functions)4.5 E/F2 9/Palatino-Bold@0 SF(327)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F3 8/Palatino-Roman@0 SF 2.203 -.736(We r)183.6 121 T
.731(eturn the hostname and service name using).592 F/F4 8/Courier@0 SF
(snprintf)2.731 E F3 .732(instead of)2.732 F F4(strncpy)2.732 E F3 4.732(.I)C
2.732(fw)484.032 121 S 2.732(eu)496.1 121 S(sed)507.488 121 Q
(the latter we could write)183.6 131 Q/F5 7.15/Courier@0 SF
(strncpy\(host, "/local", hostlen\);)201.6 144.5 Q F3 .877
(While this guarantees that we do not over\215ow the caller)183.6 159 R .877
('s buf).592 F(fer)-.144 E 2.877(,i)-.592 G(f)426.839 159 Q F4(hostlen)2.877 E
F3 .877(is less than or)2.877 F .035(equal to 6, then the caller)183.6 169 R
.035('s buf).592 F .035(fer will not be null terminated.)-.144 F .035
(But we ar)4.035 F 2.035(ew)-.144 G .036(riting a library r)451.245 169 R(ou-)
-.144 E 1.054(tine and we should always r)183.6 179 R 1.053
(eturn a null-terminated string if that is what the caller expects.)-.144 F .69
(This could cause pr)183.6 189 R .69
(oblems for the caller at a later time in the pr)-.144 F 2.691(ogram. Ther)
-.144 F(efor)-.144 E 2.691(ew)-.144 G 2.691(es)488.621 189 S(hould)498.536 189
Q(always write)183.6 199 Q F5(strncpy\(host, "/local", hostlen-1\);)201.6 212.5
Q(host[hostlen-1] = '\\0';)201.6 221.5 Q F3 .356
(which guarantees that we do not overwrite the caller)183.6 236 R .355('s buf)
.592 F .355(fer and that the r)-.144 F .355(esult is null termi-)-.144 F 2.346
(nated. W)183.6 246 R 2.346(eu)-.736 G(se)228.196 246 Q F4(snprintf)2.346 E F3
.347(instead of these two statements, since it will not over\215ow the desti-)
2.346 F .279(nation and it guarantees that the destination is null terminated.)
183.6 256 R .279(An alternate design would be)4.279 F .491
(to de\214ne our own library function that calls)183.6 266 R F4(strncpy)2.491 E
F3 .491(and null terminates the r)2.491 F .492(esult, but call-)-.144 F
(ing the existing)183.6 276 Q F4(snprintf)2 E F3(seems simpler)2 E(.)-.592 E/F6
10/Palatino-Roman@0 SF(Figur)147.6 304 Q 2.516(e1)-.18 G .016(1.42 is our)
183.186 304 R/F7 10/Courier@0 SF(gn_ipv46)2.516 E F6 .016
(function, which handles IPv4 and IPv6 socket addr)2.516 F(ess)-.18 E(str)129.6
316 Q(uctur)-.08 E(es for)-.18 E F7(getnameinfo)2.5 E F6(.)A/F8 9
/Helvetica-Bold@0 SF(Return hostname)129.6 332 Q/F9 7/Courier-Oblique@0 SF
(12\21123)104.28 347 Q F6 .537(If the)147.6 347 R F7(NI_NUMERICHOST)3.037 E F6
.537(\215ag is speci\214ed, we call)3.037 F F7(inet_ntop)3.038 E F6 .538(to r)
3.038 F .538(eturn the pr)-.18 F(esen-)-.18 E .878
(tation format of the IP addr)129.6 359 R .877(ess; otherwise)-.18 F F7
(gethostbyaddr)3.377 E F6(sear)3.377 E .877(ches for the hostname)-.18 F(corr)
129.6 371 Q .337(esponding to the IP addr)-.18 F 2.837(ess. If)-.18 F F7
(gethostbyaddr)2.837 E F6 .337(succeeds and the)2.837 F F7(NI_NOFQDN)2.838 E F6
(\(no)2.838 E 1.326(fully quali\214ed domain name\) \215ag is speci\214ed, the\
 hostname is terminated at the \214rst)129.6 383 R(period in the name.)129.6
395 Q F8(Handle failure of)129.6 411 Q/F10 9/Courier-Bold@0 SF(gethostbyaddr)
2.502 E F9(24\21129)104.28 426 Q F6(If)147.6 426 Q F7(gethostbyaddr)2.726 E F6
.226(fails \(which, unfortunately is all too common given the number)2.726 F
2.539(of miscon\214gur)129.6 438 R 2.538
(ed DNS servers on the Internet; see Section 14.8 of TCPv3\) and the)-.18 F F7
(NI_NAMEREQD)129.6 450 Q F6 1.563(\215ag was speci\214ed, an err)4.063 F 1.564
(or is r)-.18 F 4.064(eturned. Otherwise)-.18 F 1.564(the addr)4.064 F 1.564
(ess string)-.18 F(corr)129.6 462 Q(esponding to the IP addr)-.18 E
(ess is formed by)-.18 E F7(inet_ntop)2.5 E F6(.)A F8(Return ser)129.6 478 Q
(vice string).09 E F9(32\21142)104.28 493 Q F6 .44(If the)147.6 493 R F7
(NI_NUMERICSERV)2.94 E F6 .439
(\215ag is speci\214ed, just the decimal port number is r)2.939 F(eturned.)-.18
E(Otherwise)129.6 505 Q F7(getservbyport)3.685 E F6 1.186(is called.)3.685 F
1.186(The \214nal ar)6.186 F 1.186(gument is a null pointer unless the)-.18 F
F7(NI_DGRAM)129.6 517 Q F6 2.831(\215ag is speci\214ed.)5.331 F(If)7.831 E F7
(getservbyport)5.331 E F6 2.831(fails, the decimal port number is)5.331 F -.18
(re)129.6 529 S(turned instead.).18 E/F11 7/Palatino-Roman@0 SF 1.75<a943>
233.453 678 S(opyright 1998 by Pr)-1.75 E(entice Hall PTR, All rights r)-.126 E
(eserved)-.126 E EP
%%Page: 328 56
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Bold@0 SF(328)93.6 82 Q/F1 9/Palatino-Roman@0 SF 2.25
(Advanced Name)125.1 82 R 2.25(and Addr)6.75 F 4.5(ess Conversions)-.162 F
(Chapter 1)476.517 82 Q(1)-.495 E .32 LW 97.6 89.2 93.6 89.2 DL 99.6 89.2 95.6
89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL 111.6 89.2 107.6 89.2
DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL 123.6 89.2 119.6 89.2 DL
127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL 135.6 89.2 131.6 89.2 DL
139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL 147.6 89.2 143.6 89.2 DL
151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL 159.6 89.2 155.6 89.2 DL
163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL 171.6 89.2 167.6 89.2 DL
175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL 183.6 89.2 179.6 89.2 DL
187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL 195.6 89.2 191.6 89.2 DL
199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL 207.6 89.2 203.6 89.2 DL
211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL 219.6 89.2 215.6 89.2 DL
223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL 231.6 89.2 227.6 89.2 DL
235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL 243.6 89.2 239.6 89.2 DL
247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL 255.6 89.2 251.6 89.2 DL
259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL 267.6 89.2 263.6 89.2 DL
271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL 279.6 89.2 275.6 89.2 DL
283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL 291.6 89.2 287.6 89.2 DL
295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL 303.6 89.2 299.6 89.2 DL
307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL 315.6 89.2 311.6 89.2 DL
319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL 327.6 89.2 323.6 89.2 DL
331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL 339.6 89.2 335.6 89.2 DL
343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL 351.6 89.2 347.6 89.2 DL
355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL 363.6 89.2 359.6 89.2 DL
367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL 375.6 89.2 371.6 89.2 DL
379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL 387.6 89.2 383.6 89.2 DL
391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL 399.6 89.2 395.6 89.2 DL
403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL 411.6 89.2 407.6 89.2 DL
415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL 423.6 89.2 419.6 89.2 DL
427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL 435.6 89.2 431.6 89.2 DL
439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL 447.6 89.2 443.6 89.2 DL
451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL 459.6 89.2 455.6 89.2 DL
463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL 471.6 89.2 467.6 89.2 DL
475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL 483.6 89.2 479.6 89.2 DL
487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL 495.6 89.2 491.6 89.2 DL
499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL 507.6 89.2 503.6 89.2 DL
511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL 519.6 89.2 515.6 89.2 DL .4
LW 134.6 124.2 129.6 124.2 DL 139.098 124.2 134.098 124.2 DL 144.098 124.2
139.098 124.2 DL 149.098 124.2 144.098 124.2 DL 154.098 124.2 149.098 124.2 DL
159.098 124.2 154.098 124.2 DL 164.098 124.2 159.098 124.2 DL 169.098 124.2
164.098 124.2 DL 174.098 124.2 169.098 124.2 DL 179.098 124.2 174.098 124.2 DL
184.098 124.2 179.098 124.2 DL 189.098 124.2 184.098 124.2 DL 194.098 124.2
189.098 124.2 DL 199.098 124.2 194.098 124.2 DL 204.098 124.2 199.098 124.2 DL
209.098 124.2 204.098 124.2 DL 214.098 124.2 209.098 124.2 DL 219.098 124.2
214.098 124.2 DL 224.098 124.2 219.098 124.2 DL 229.098 124.2 224.098 124.2 DL
234.098 124.2 229.098 124.2 DL 239.098 124.2 234.098 124.2 DL 244.098 124.2
239.098 124.2 DL 249.098 124.2 244.098 124.2 DL 254.098 124.2 249.098 124.2 DL
259.098 124.2 254.098 124.2 DL 264.098 124.2 259.098 124.2 DL 269.098 124.2
264.098 124.2 DL 274.098 124.2 269.098 124.2 DL 279.098 124.2 274.098 124.2 DL
284.098 124.2 279.098 124.2 DL 289.098 124.2 284.098 124.2 DL 294.098 124.2
289.098 124.2 DL 299.098 124.2 294.098 124.2 DL 304.098 124.2 299.098 124.2 DL
309.098 124.2 304.098 124.2 DL 314.098 124.2 309.098 124.2 DL 319.098 124.2
314.098 124.2 DL 324.098 124.2 319.098 124.2 DL 329.098 124.2 324.098 124.2 DL
334.098 124.2 329.098 124.2 DL 339.098 124.2 334.098 124.2 DL 344.098 124.2
339.098 124.2 DL 349.098 124.2 344.098 124.2 DL 354.098 124.2 349.098 124.2 DL
359.098 124.2 354.098 124.2 DL 364.098 124.2 359.098 124.2 DL 369.098 124.2
364.098 124.2 DL 374.098 124.2 369.098 124.2 DL 379.098 124.2 374.098 124.2 DL
384.098 124.2 379.098 124.2 DL 389.098 124.2 384.098 124.2 DL 394.098 124.2
389.098 124.2 DL 399.098 124.2 394.098 124.2 DL 404.098 124.2 399.098 124.2 DL
409.098 124.2 404.098 124.2 DL 414.098 124.2 409.098 124.2 DL 419.098 124.2
414.098 124.2 DL 424.098 124.2 419.098 124.2 DL 429.098 124.2 424.098 124.2 DL
434.098 124.2 429.098 124.2 DL 439.098 124.2 434.098 124.2 DL 444.098 124.2
439.098 124.2 DL 449.098 124.2 444.098 124.2 DL 454.098 124.2 449.098 124.2 DL
/F2 9/Palatino-Italic@0 SF(libgai/gn_ipv46.c)456.348 126.7 Q/F3 8.15/Courier@0
SF 4.89(5i)139.38 133.001 S(nt)154.05 133.001 Q 4.89(6g)139.38 143.001 S
(n_ipv46\(char *host, size_t hostlen, char *serv, size_t servlen,)154.05
143.001 Q 48.9(7v)139.38 153.001 S
(oid *aptr, size_t alen, int family, int port, int flags\))198.06 153.001 Q
4.89(8{)139.38 163.001 S 24.45(9c)139.38 173.001 S 9.78(har *ptr;)173.61
173.001 R 19.56(10 struct)134.49 183.001 R(hostent *hptr;)4.89 E 19.56
(11 struct)134.49 193.001 R(servent *sptr;)4.89 E 19.56(12 if)134.49 210.001 R
(\(hostlen > 0\) {)4.89 E 39.12(13 if)134.49 220.001 R
(\(flags & NI_NUMERICHOST\) {)4.89 E 58.68(14 if)134.49 230.001 R
(\(inet_ntop\(family, aptr, host, hostlen\) == NULL\))4.89 E 78.24(15 return)
134.49 240.001 R(\(1\);)4.89 E 39.12(16 })134.49 250.001 R(else {)4.89 E 58.68
(17 hptr)134.49 260.001 R 4.89(=g)4.89 G(ethostbyaddr\(aptr, alen, family\);)
246.96 260.001 Q 58.68(18 if)134.49 270.001 R
(\(hptr != NULL && hptr->h_name != NULL\) {)4.89 E 78.24(19 if)134.49 280.001 R
(\(flags & NI_NOFQDN\) {)4.89 E 97.8(20 if)134.49 290.001 R 4.89(\(\()4.89 G
(ptr = strchr\(hptr->h_name, '.'\)\) != NULL\))276.3 290.001 Q 117.36(21 *ptr)
134.49 300.001 R 4.89(=0)4.89 G 14.67(;/)305.64 300.001 S 4.89(*o)330.09
300.001 S(verwrite first dot */)344.76 300.001 Q 78.24(22 })134.49 310.001 R
78.24(23 snprintf\(host,)134.49 320.001 R(hostlen, "%s", hptr->h_name\);)4.89 E
58.68(24 })134.49 330.001 R(else {)4.89 E 78.24(25 if)134.49 340.001 R
(\(flags & NI_NAMEREQD\))4.89 E 97.8(26 return)134.49 350.001 R(\(1\);)4.89 E
78.24(27 if)134.49 360.001 R
(\(inet_ntop\(family, aptr, host, hostlen\) == NULL\))4.89 E 97.8(28 return)
134.49 370.001 R(\(1\);)4.89 E 58.68(29 })134.49 380.001 R 39.12(30 })134.49
390.001 R 19.56(31 })134.49 400.001 R 19.56(32 if)134.49 410.001 R
(\(servlen > 0\) {)4.89 E 39.12(33 if)134.49 420.001 R
(\(flags & NI_NUMERICSERV\) {)4.89 E 58.68(34 snprintf\(serv,)134.49 430.001 R
(servlen, "%d", ntohs\(port\)\);)4.89 E 39.12(35 })134.49 440.001 R(else {)4.89
E 58.68(36 sptr)134.49 450.001 R 4.89(=g)4.89 G
(etservbyport\(port, \(flags & NI_DGRAM\) ? "udp" : NULL\);)246.96 450.001 Q
58.68(37 if)134.49 460.001 R(\(sptr != NULL && sptr->s_name != NULL\))4.89 E
78.24(38 snprintf\(serv,)134.49 470.001 R(servlen, "%s", sptr->s_name\);)4.89 E
58.68(39 else)134.49 480.001 R 78.24(40 snprintf\(serv,)134.49 490.001 R
(servlen, "%d", ntohs\(port\)\);)4.89 E 39.12(41 })134.49 500.001 R 19.56(42 })
134.49 510.001 R 19.56(43 return)134.49 520.001 R(\(0\);)4.89 E(44 })134.49
530.001 Q 134.6 534.802 129.6 534.802 DL 139.098 534.802 134.098 534.802 DL
144.098 534.802 139.098 534.802 DL 149.098 534.802 144.098 534.802 DL 154.098
534.802 149.098 534.802 DL 159.098 534.802 154.098 534.802 DL 164.098 534.802
159.098 534.802 DL 169.098 534.802 164.098 534.802 DL 174.098 534.802 169.098
534.802 DL 179.098 534.802 174.098 534.802 DL 184.098 534.802 179.098 534.802
DL 189.098 534.802 184.098 534.802 DL 194.098 534.802 189.098 534.802 DL
199.098 534.802 194.098 534.802 DL 204.098 534.802 199.098 534.802 DL 209.098
534.802 204.098 534.802 DL 214.098 534.802 209.098 534.802 DL 219.098 534.802
214.098 534.802 DL 224.098 534.802 219.098 534.802 DL 229.098 534.802 224.098
534.802 DL 234.098 534.802 229.098 534.802 DL 239.098 534.802 234.098 534.802
DL 244.098 534.802 239.098 534.802 DL 249.098 534.802 244.098 534.802 DL
254.098 534.802 249.098 534.802 DL 259.098 534.802 254.098 534.802 DL 264.098
534.802 259.098 534.802 DL 269.098 534.802 264.098 534.802 DL 274.098 534.802
269.098 534.802 DL 279.098 534.802 274.098 534.802 DL 284.098 534.802 279.098
534.802 DL 289.098 534.802 284.098 534.802 DL 294.098 534.802 289.098 534.802
DL 299.098 534.802 294.098 534.802 DL 304.098 534.802 299.098 534.802 DL
309.098 534.802 304.098 534.802 DL 314.098 534.802 309.098 534.802 DL 319.098
534.802 314.098 534.802 DL 324.098 534.802 319.098 534.802 DL 329.098 534.802
324.098 534.802 DL 334.098 534.802 329.098 534.802 DL 339.098 534.802 334.098
534.802 DL 344.098 534.802 339.098 534.802 DL 349.098 534.802 344.098 534.802
DL 354.098 534.802 349.098 534.802 DL 359.098 534.802 354.098 534.802 DL
364.098 534.802 359.098 534.802 DL 369.098 534.802 364.098 534.802 DL 374.098
534.802 369.098 534.802 DL 379.098 534.802 374.098 534.802 DL 384.098 534.802
379.098 534.802 DL 389.098 534.802 384.098 534.802 DL 394.098 534.802 389.098
534.802 DL 399.098 534.802 394.098 534.802 DL 404.098 534.802 399.098 534.802
DL 409.098 534.802 404.098 534.802 DL 414.098 534.802 409.098 534.802 DL
419.098 534.802 414.098 534.802 DL 424.098 534.802 419.098 534.802 DL 429.098
534.802 424.098 534.802 DL 434.098 534.802 429.098 534.802 DL 439.098 534.802
434.098 534.802 DL 444.098 534.802 439.098 534.802 DL 449.098 534.802 444.098
534.802 DL 454.098 534.802 449.098 534.802 DL F2(libgai/gn_ipv46.c)456.348
537.302 Q/F4 8/Palatino-Bold@0 SF(Figure 1)178.564 550.802 Q(1.42)-.296 E/F5 8
/Courier@0 SF(gn_ipv46)6 E/F6 8/Palatino-Roman@0 SF
(function: handle IPv4 and IPv6 socket addr)2 E(ess str)-.144 E(uctur)-.064 E
(es.)-.144 E/F7 12/Helvetica-Bold@0 SF 2.64(11.17 Summar)93.6 586.802 R(y).12 E
/F8 10/Courier@0 SF(getaddrinfo)129.6 610.802 Q/F9 10/Palatino-Roman@0 SF 1.487
(is a useful function that lets us write pr)3.987 F 1.488
(otocol-independent code.)-.18 F(But)6.488 E .043(calling it dir)129.6 622.802
R .043(ectly takes a few steps, and ther)-.18 F 2.542(ea)-.18 G .402 -.18(re s)
335.666 622.802 T .042(till r).18 F .042(epetitive details that must be han-)
-.18 F .632(dled for dif)129.6 634.802 R(fer)-.18 E .632(ent scenarios: go thr)
-.18 F .633(ough all the r)-.18 F .633(eturned str)-.18 F(uctur)-.08 E .633
(es, ignor)-.18 F 3.133(ee)-.18 G(rr)467.477 634.802 Q .633(or r)-.18 F(eturns)
-.18 E(fr)129.6 646.802 Q(om)-.18 E F8(socket)3.334 E F9 3.333(,s)C .833
(et the)200.397 646.802 R F8(SO_REUSEADDR)3.333 E F9 .833
(socket option for TCP servers, and the like.)3.333 F -.92(We)5.833 G 4.81
(simplify all these details with our \214ve functions)129.6 658.802 R F8
(tcp_connect)7.31 E F9(,)A F8(tcp_listen)7.31 E F9(,)A/F10 7/Palatino-Roman@0
SF 1.75<a943>233.453 678 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Page: 329 57
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Palatino-Roman@0 SF(Chapter 1)93.6 82 Q 315.012(1E)-.495 G(xer)457.194 82
Q(cises)-.162 E/F1 9/Palatino-Bold@0 SF(329)506.1 82 Q .32 LW 97.6 89.2 93.6
89.2 DL 99.6 89.2 95.6 89.2 DL 103.6 89.2 99.6 89.2 DL 107.6 89.2 103.6 89.2 DL
111.6 89.2 107.6 89.2 DL 115.6 89.2 111.6 89.2 DL 119.6 89.2 115.6 89.2 DL
123.6 89.2 119.6 89.2 DL 127.6 89.2 123.6 89.2 DL 131.6 89.2 127.6 89.2 DL
135.6 89.2 131.6 89.2 DL 139.6 89.2 135.6 89.2 DL 143.6 89.2 139.6 89.2 DL
147.6 89.2 143.6 89.2 DL 151.6 89.2 147.6 89.2 DL 155.6 89.2 151.6 89.2 DL
159.6 89.2 155.6 89.2 DL 163.6 89.2 159.6 89.2 DL 167.6 89.2 163.6 89.2 DL
171.6 89.2 167.6 89.2 DL 175.6 89.2 171.6 89.2 DL 179.6 89.2 175.6 89.2 DL
183.6 89.2 179.6 89.2 DL 187.6 89.2 183.6 89.2 DL 191.6 89.2 187.6 89.2 DL
195.6 89.2 191.6 89.2 DL 199.6 89.2 195.6 89.2 DL 203.6 89.2 199.6 89.2 DL
207.6 89.2 203.6 89.2 DL 211.6 89.2 207.6 89.2 DL 215.6 89.2 211.6 89.2 DL
219.6 89.2 215.6 89.2 DL 223.6 89.2 219.6 89.2 DL 227.6 89.2 223.6 89.2 DL
231.6 89.2 227.6 89.2 DL 235.6 89.2 231.6 89.2 DL 239.6 89.2 235.6 89.2 DL
243.6 89.2 239.6 89.2 DL 247.6 89.2 243.6 89.2 DL 251.6 89.2 247.6 89.2 DL
255.6 89.2 251.6 89.2 DL 259.6 89.2 255.6 89.2 DL 263.6 89.2 259.6 89.2 DL
267.6 89.2 263.6 89.2 DL 271.6 89.2 267.6 89.2 DL 275.6 89.2 271.6 89.2 DL
279.6 89.2 275.6 89.2 DL 283.6 89.2 279.6 89.2 DL 287.6 89.2 283.6 89.2 DL
291.6 89.2 287.6 89.2 DL 295.6 89.2 291.6 89.2 DL 299.6 89.2 295.6 89.2 DL
303.6 89.2 299.6 89.2 DL 307.6 89.2 303.6 89.2 DL 311.6 89.2 307.6 89.2 DL
315.6 89.2 311.6 89.2 DL 319.6 89.2 315.6 89.2 DL 323.6 89.2 319.6 89.2 DL
327.6 89.2 323.6 89.2 DL 331.6 89.2 327.6 89.2 DL 335.6 89.2 331.6 89.2 DL
339.6 89.2 335.6 89.2 DL 343.6 89.2 339.6 89.2 DL 347.6 89.2 343.6 89.2 DL
351.6 89.2 347.6 89.2 DL 355.6 89.2 351.6 89.2 DL 359.6 89.2 355.6 89.2 DL
363.6 89.2 359.6 89.2 DL 367.6 89.2 363.6 89.2 DL 371.6 89.2 367.6 89.2 DL
375.6 89.2 371.6 89.2 DL 379.6 89.2 375.6 89.2 DL 383.6 89.2 379.6 89.2 DL
387.6 89.2 383.6 89.2 DL 391.6 89.2 387.6 89.2 DL 395.6 89.2 391.6 89.2 DL
399.6 89.2 395.6 89.2 DL 403.6 89.2 399.6 89.2 DL 407.6 89.2 403.6 89.2 DL
411.6 89.2 407.6 89.2 DL 415.6 89.2 411.6 89.2 DL 419.6 89.2 415.6 89.2 DL
423.6 89.2 419.6 89.2 DL 427.6 89.2 423.6 89.2 DL 431.6 89.2 427.6 89.2 DL
435.6 89.2 431.6 89.2 DL 439.6 89.2 435.6 89.2 DL 443.6 89.2 439.6 89.2 DL
447.6 89.2 443.6 89.2 DL 451.6 89.2 447.6 89.2 DL 455.6 89.2 451.6 89.2 DL
459.6 89.2 455.6 89.2 DL 463.6 89.2 459.6 89.2 DL 467.6 89.2 463.6 89.2 DL
471.6 89.2 467.6 89.2 DL 475.6 89.2 471.6 89.2 DL 479.6 89.2 475.6 89.2 DL
483.6 89.2 479.6 89.2 DL 487.6 89.2 483.6 89.2 DL 491.6 89.2 487.6 89.2 DL
495.6 89.2 491.6 89.2 DL 499.6 89.2 495.6 89.2 DL 503.6 89.2 499.6 89.2 DL
507.6 89.2 503.6 89.2 DL 511.6 89.2 507.6 89.2 DL 515.6 89.2 511.6 89.2 DL
519.6 89.2 515.6 89.2 DL/F2 10/Courier@0 SF(udp_client)129.6 123 Q/F3 10
/Palatino-Roman@0 SF(,)A F2(udp_connect)2.651 E F3 2.651(,a)C(nd)270.902 123 Q
F2(udp_server)2.651 E F3 5.151(.W)C 2.651(es)362.214 123 S .151
(howed the use of these functions)373.895 123 R .115(in writing pr)129.6 135 R
.116(otocol-independent versions of our TCP and UDP daytime clients and day-)
-.18 F(time servers.)129.6 147 Q F2(gethostbyname)147.6 159 Q F3(and)3.063 E F2
(gethostbyaddr)3.063 E F3(ar)3.063 E 3.063(ea)-.18 G .563
(lso examples of functions that ar)351.342 159 R 3.063(en)-.18 G(ot)510.88 159
Q 2.204(normally r)129.6 171 R 4.704(eentrant. The)-.18 F 2.204
(two functions shar)4.704 F 4.704(eas)-.18 G 2.204(tatic r)356.398 171 R 2.204
(esult str)-.18 F(uctur)-.08 E 4.704(et)-.18 G 4.705(ow)457.33 171 S 2.205
(hich both)475.835 171 R -.18(re)129.6 183 S .545(turn a pointer).18 F 5.545
(.W)-.74 G 3.045(ee)216.895 183 S .545(ncounter this pr)229.52 183 R .545
(oblem of r)-.18 F .544(eentrancy again with thr)-.18 F .544(eads in Chap-)-.18
F .08(ter 23 and discuss ways ar)129.6 195 R .08(ound the pr)-.18 F 2.58
(oblem. W)-.18 F 2.58(ed)-.92 G .08(iscussed the)355.44 195 R F2(_r)2.58 E F3
.08(versions of these two)2.58 F .616(functions that some vendors pr)129.6 207
R .616(ovide, which is one solution, but it r)-.18 F(equir)-.18 E .615
(es a change in)-.18 F(all the applications that call the functions.)129.6 219
Q/F4 12/Helvetica-Bold@0 SF(Ex)129.6 261 Q(er)-.12 E(cises)-.24 E F1 -.333(11)
129.6 282 S(.1).333 E F0 .422(In Figur)157.185 282 R 2.672(e1)-.162 G .422
(1.8 the caller must pass a pointer to an integer to obtain the size of the pr)
200.563 282 R(otocol)-.162 E(addr)157.185 293 Q 2.255(ess. If)-.162 F .005
(the caller does not do this \(i.e., passes a null pointer as the \214nal ar)
2.255 F .004(gument\), how)-.162 F
(can the caller still obtain the actual size of the pr)157.185 304 Q
(otocol's addr)-.162 E(esses?)-.162 E F1 -.333(11)129.6 319 S(.2).333 E F0 .51
(Modify Figur)157.185 319 R 2.76(e1)-.162 G .51(1.10 to call)222.015 319 R/F5 9
/Courier@0 SF(getnameinfo)2.76 E F0 .51(instead of)2.76 F F5(sock_ntop)2.76 E
F0 5.01(.W)C .511(hat \215ags should you)436.995 319 R(pass to)157.185 330 Q F5
(getnameinfo)2.25 E F0(?)A F1 -.333(11)129.6 345 S(.3).333 E F0 1.024
(In Section 7.5 we discussed port stealing with the)157.185 345 R F5
(SO_REUSEADDR)3.274 E F0 1.024(socket option.)3.274 F 2.68 -.828(To s)5.524 H
(ee).828 E .201(how this works, build the pr)157.185 356 R .201
(otocol-independent UDP daytime server in Figur)-.162 F 2.452(e1)-.162 G 2.452
(1.15. Start)478.25 356 R .561(one instance of the server in one window)157.185
367 R 2.811(,b)-.828 G .561(inding the wildcar)333.816 367 R 2.81(da)-.162 G
(ddr)421.078 367 Q .56(ess and some port of)-.162 F .287(your choosing.)157.185
378 R .287
(Start a client in another window and verify that this server is handling the)
4.787 F .283(client \(note the)157.185 389 R F5(printf)2.533 E F0 .283
(in the server\).)2.533 F .283
(Then start another instance of the server in another)4.783 F(window)157.185
400 Q 2.304(,t)-.828 G .055(his time binding one of the host's unicast addr)
197.127 400 R .055(esses and the same port as the \214rst)-.162 F(server)
157.185 411 Q 5.645(.W)-.666 G 1.145(hat pr)198.047 411 R 1.145
(oblem do you immediately encounter?)-.162 F 1.145(Fix this pr)5.645 F 1.144
(oblem and r)-.162 F 1.144(estart this)-.162 F .304(second server)157.185 422 R
4.804(.S)-.666 G .304
(tart a client, send a datagram, and verify that the second server has stolen)
223.259 422 R 1.202(the port fr)157.185 433 R 1.202(om the \214rst server)-.162
F 5.702(.I)-.666 G 3.452(fp)286.176 433 S 1.202
(ossible, start the second server again, fr)298.034 433 R 1.202(om a dif)-.162
F(fer)-.162 E(ent)-.162 E .81(login account fr)157.185 444 R .81
(om the \214rst server)-.162 F 3.06(,t)-.666 G 3.06(os)303.579 444 S .81
(ee if the stealing still succeeds, because some ven-)315.369 444 R .925(dors \
will not allow the second bind unless the user ID is the same as that of the p\
r)157.185 455 R(ocess)-.162 E(that has alr)157.185 466 Q(eady bound the port.)
-.162 E F1 -.333(11)129.6 481 S(.4).333 E F0 .194(When discussing Figur)157.185
481 R 2.444(e1)-.162 G .194(1.34 we noted that the addr)259.917 481 R .194
(ess of)-.162 F F5(aipnext)2.444 E F0 .194(is an ar)2.444 F .194(gument to the)
-.162 F F5(ga_aistruct)157.185 492 Q F0 1.406
(function, necessitating an extra level of indir)3.657 F 1.406(ection when r)
-.162 F(efer)-.162 E 1.406(encing the)-.162 F 2.903(variable. Why)157.185 503 R
.653(do we not make)2.903 F F5(aipnext)2.903 E F0 2.903(ag)2.903 G .654
(lobal variable, instead of passing its addr)340.699 503 R(ess)-.162 E
(as an ar)157.185 514 Q(gument?)-.162 E F1 -.333(11)129.6 529 S(.5).333 E F0
.277(In our discussion of Unix domain at the end of Section 1)157.185 529 R
.277(1.5 we mentioned that none of the)-.495 F
(IANA service names begin with a slash.)157.185 540 Q
(Do any of these service names contain a slash?)4.5 E F1 -.333(11)129.6 555 S
(.6).333 E F0 .002(At the end of Section 2.10 we showed two)157.185 555 R F5
(telnet)2.252 E F0 .003(examples: to the)2.253 F F5(daytime)2.253 E F0 .003
(server and to)2.253 F(the)157.185 566 Q F5(echo)2.613 E F0 .362(server .)2.613
F .362(Knowing that a client goes thr)4.862 F .362(ough the two steps)-.162 F
F5(gethostbyname)2.612 E F0(and)2.612 E F5(connect)157.185 577 Q F0 2.25(,w)C
(hich lines output by the client indicate which steps?)206.991 577 Q F1 -.333
(11)129.6 592 S(.7).333 E F5(gethostbyaddr)157.185 592 Q F0 .574
(can take a long time \(up to 80 seconds\) to r)2.824 F .575(eturn an err)-.162
F .575(or if a hostname)-.162 F 1.189(cannot be found for an IP addr)157.185
603 R 3.438(ess. W)-.162 F 1.188(rite a new function named)-.666 F F5
(getnameinfo_timeo)3.438 E F0 .709(that takes an additional integer ar)157.185
614 R .709(gument specifying the maximum number of seconds to)-.162 F .812
(wait for a r)157.185 625 R(eply)-.162 E 5.312(.I)-.999 G 3.062(ft)230.228 625
S .811(he timer expir)239.221 625 R .811(es and the)-.162 F F5(NI_NAMEREQD)
3.061 E F0 .811(\215ag is not speci\214ed, just call)3.061 F F5(inet_ntop)
157.185 636 Q F0(and r)2.25 E(eturn an addr)-.162 E(ess string.)-.162 E/F6 7
/Palatino-Roman@0 SF 1.75<a943>233.453 677 S(opyright 1998 by Pr)-1.75 E
(entice Hall PTR, All rights r)-.126 E(eserved)-.126 E EP
%%Trailer
end
%%EOF
